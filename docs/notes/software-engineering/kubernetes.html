<!doctype html>
<html lang="en-US" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-notes/software-engineering/kubernetes" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Kubernetes | {m19v}</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://m19v.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://m19v.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://m19v.github.io/docs/notes/software-engineering/kubernetes"><meta data-rh="true" property="og:locale" content="en_US"><meta data-rh="true" property="og:locale:alternate" content="tj_TJ"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="google-site-verification" content="-5zh_8T7Z6ZPupTzJH9LcYznhfRid8I7y2TRsaHcrsE"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Kubernetes | {m19v}"><meta data-rh="true" name="description" content="- 1. Table of Content"><meta data-rh="true" property="og:description" content="- 1. Table of Content"><link data-rh="true" rel="icon" href="/img/m19v.ico"><link data-rh="true" rel="canonical" href="https://m19v.github.io/docs/notes/software-engineering/kubernetes"><link data-rh="true" rel="alternate" href="https://m19v.github.io/docs/notes/software-engineering/kubernetes" hreflang="en-US"><link data-rh="true" rel="alternate" href="https://m19v.github.io/tg/docs/notes/software-engineering/kubernetes" hreflang="tj-TJ"><link data-rh="true" rel="alternate" href="https://m19v.github.io/docs/notes/software-engineering/kubernetes" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Notes","item":"https://m19v.github.io/docs/category/notes"},{"@type":"ListItem","position":2,"name":"Software Engineering","item":"https://m19v.github.io/docs/category/software-engineering"},{"@type":"ListItem","position":3,"name":"Kubernetes","item":"https://m19v.github.io/docs/notes/software-engineering/kubernetes"}]}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="{m19v} RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="{m19v} Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-LVEVW4JNSB"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-LVEVW4JNSB",{anonymize_ip:!0})</script><link rel="stylesheet" href="/assets/css/styles.0d0fcfae.css">
<script src="/assets/js/runtime~main.e4aee2e7.js" defer="defer"></script>
<script src="/assets/js/main.105dba41.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/{m19v}_black_without_bg.png"><link rel="preload" as="image" href="/img/{m19v}_white_without_bg.png"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/{m19v}_black_without_bg.png" alt="My Site Logo" class="header-m19v-logo themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/{m19v}_white_without_bg.png" alt="My Site Logo" class="header-m19v-logo themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate"></b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs">Docs</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/m19v" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><a href="https://youtube.com/@m19v" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-youtube-link" aria-label="YouTube channel"></a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English</a><ul class="dropdown__menu"><li><a href="/docs/notes/software-engineering/kubernetes" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en-US">English</a></li><li><a href="/tg/docs/notes/software-engineering/kubernetes" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="tj-TJ">Тоҷикӣ</a></li></ul></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex="-1" class="sidebarLogo_isFc" href="/"><img src="/img/{m19v}_black_without_bg.png" alt="My Site Logo" class="header-m19v-logo themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/{m19v}_white_without_bg.png" alt="My Site Logo" class="header-m19v-logo themedComponent_mlkZ themedComponent--dark_xIcU"><b></b></a><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs"><span title="Welcome" class="linkLabel_WmDU">Welcome</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/reading-list"><span title="Reading List" class="linkLabel_WmDU">Reading List</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/docs/category/book-summaries"><span title="Book Summaries" class="categoryLinkLabel_W154">Book Summaries</span></a><button aria-label="Expand sidebar category &#x27;Book Summaries&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" href="/docs/category/notes"><span title="Notes" class="categoryLinkLabel_W154">Notes</span></a><button aria-label="Collapse sidebar category &#x27;Notes&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/docs/category/computer-science"><span title="Computer Science" class="categoryLinkLabel_W154">Computer Science</span></a><button aria-label="Expand sidebar category &#x27;Computer Science&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/docs/category/electrical-engineering"><span title="Electrical Engineering" class="categoryLinkLabel_W154">Electrical Engineering</span></a><button aria-label="Expand sidebar category &#x27;Electrical Engineering&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/docs/category/engineering-mathematics"><span title="Engineering Mathematics" class="categoryLinkLabel_W154">Engineering Mathematics</span></a><button aria-label="Expand sidebar category &#x27;Engineering Mathematics&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" tabindex="0" href="/docs/category/software-engineering"><span title="Software Engineering" class="categoryLinkLabel_W154">Software Engineering</span></a><button aria-label="Collapse sidebar category &#x27;Software Engineering&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/notes/software-engineering/ansible"><span title="Ansible" class="linkLabel_WmDU">Ansible</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/notes/software-engineering/argocd"><span title="ArgoCD" class="linkLabel_WmDU">ArgoCD</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/notes/software-engineering/bash"><span title="Bash" class="linkLabel_WmDU">Bash</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/notes/software-engineering/java"><span title="Java" class="linkLabel_WmDU">Java</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/notes/software-engineering/kafka"><span title="Apache Kafka" class="linkLabel_WmDU">Apache Kafka</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/notes/software-engineering/kubernetes"><span title="Kubernetes" class="linkLabel_WmDU">Kubernetes</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/notes/software-engineering/managing-security-in-gc"><span title="Managing Security in Google Cloud" class="linkLabel_WmDU">Managing Security in Google Cloud</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/notes/software-engineering/python"><span title="Python" class="linkLabel_WmDU">Python</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/notes/software-engineering/quarkus"><span title="Quarkus" class="linkLabel_WmDU">Quarkus</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/notes/software-engineering/terraform"><span title="Terraform" class="linkLabel_WmDU">Terraform</span></a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/docs/category/references"><span title="References" class="categoryLinkLabel_W154">References</span></a><button aria-label="Expand sidebar category &#x27;References&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/docs/category/literature"><span title="Literature" class="categoryLinkLabel_W154">Literature</span></a><button aria-label="Expand sidebar category &#x27;Literature&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/tools"><span title="Tools" class="linkLabel_WmDU">Tools</span></a></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/docs/category/notes"><span>Notes</span></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/docs/category/software-engineering"><span>Software Engineering</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Kubernetes</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>1. Table of Content</h1></header>
<ul>
<li class=""><a href="#1-table-of-content" class="">1. Table of Content</a></li>
<li class=""><a href="#2-intro" class="">2. Intro</a></li>
<li class=""><a href="#3-certification" class="">3. Certification</a></li>
<li class=""><a href="#4-cka-lecture-and-lab-notes" class="">4. CKA Lecture and Lab Notes</a></li>
<li class=""><a href="#5-core-concepts" class="">5. Core Concepts</a>
<ul>
<li class=""><a href="#51-kubernetes-architecture" class="">5.1. Kubernetes Architecture</a></li>
<li class=""><a href="#52-open-container-initiative-oci" class="">5.2. Open Container Initiative (OCI)</a></li>
<li class=""><a href="#53-container-runtime-interface-cri" class="">5.3. Container Runtime Interface (CRI)</a></li>
<li class=""><a href="#54-docker-vs-containerd" class="">5.4. Docker vs ContainerD</a>
<ul>
<li class=""><a href="#541-docker" class="">5.4.1. Docker</a></li>
<li class=""><a href="#542-containerd" class="">5.4.2. ContainerD</a></li>
</ul>
</li>
<li class=""><a href="#55-etcd" class="">5.5. ETCD</a>
<ul>
<li class=""><a href="#551-get-started-quickly-with-etcd" class="">5.5.1. Get started quickly with ETCD</a></li>
<li class=""><a href="#552-etcd-in-kubernetes" class="">5.5.2. ETCD in Kubernetes</a></li>
<li class=""><a href="#553-etcd-setup---manual-vs-kubeadm" class="">5.5.3. ETCD Setup - Manual vs kubeadm</a></li>
</ul>
</li>
<li class=""><a href="#56-kube-api-server" class="">5.6. Kube-API Server</a></li>
<li class=""><a href="#57-kube-controller-manager" class="">5.7. Kube Controller Manager</a>
<ul>
<li class=""><a href="#571-installation-of-kube-controller-manager" class="">5.7.1. Installation of Kube-Controller-Manager</a></li>
</ul>
</li>
<li class=""><a href="#58-kube-scheduler" class="">5.8. Kube Scheduler</a></li>
<li class=""><a href="#59-kubelet" class="">5.9. Kubelet</a></li>
<li class=""><a href="#510-kube-proxy" class="">5.10. Kube Proxy</a></li>
<li class=""><a href="#511-pods" class="">5.11. Pods</a></li>
<li class=""><a href="#512-replicasets" class="">5.12. ReplicaSets</a></li>
<li class=""><a href="#513-labels-and-selectors" class="">5.13. Labels and Selectors</a></li>
<li class=""><a href="#514-annotations" class="">5.14. Annotations</a></li>
<li class=""><a href="#515-deployments" class="">5.15. Deployments</a></li>
<li class=""><a href="#516-services" class="">5.16. Services</a>
<ul>
<li class=""><a href="#5161-clusterip" class="">5.16.1. ClusterIP</a></li>
<li class=""><a href="#5162-nodeport" class="">5.16.2. NodePort</a></li>
<li class=""><a href="#5163-loadbalancer" class="">5.16.3. LoadBalancer</a></li>
<li class=""><a href="#5164-externalname" class="">5.16.4. ExternalName</a></li>
</ul>
</li>
<li class=""><a href="#517-namespaces" class="">5.17. Namespaces</a>
<ul>
<li class=""><a href="#5171-resource-quota" class="">5.17.1. Resource Quota</a></li>
</ul>
</li>
<li class=""><a href="#518-imperative-vs-declarative" class="">5.18. Imperative vs. Declarative</a></li>
</ul>
</li>
<li class=""><a href="#6-scheduling" class="">6. Scheduling</a>
<ul>
<li class=""><a href="#61-manual-scheduling" class="">6.1. Manual Scheduling</a>
<ul>
<li class=""><a href="#611-binding-object" class="">6.1.1. Binding Object</a></li>
</ul>
</li>
<li class=""><a href="#62-taints-and-tolerations" class="">6.2. Taints and Tolerations</a></li>
<li class=""><a href="#63-node-selectors" class="">6.3. Node Selectors</a></li>
<li class=""><a href="#64-node-affinity" class="">6.4. Node Affinity</a>
<ul>
<li class=""><a href="#641-node-affinity-types" class="">6.4.1. Node Affinity Types</a></li>
</ul>
</li>
<li class=""><a href="#65-taints-and-tolerations-vs-node-affinity" class="">6.5. Taints and Tolerations vs Node Affinity</a></li>
<li class=""><a href="#66-resource-requirements-and-limits" class="">6.6. Resource Requirements and Limits</a>
<ul>
<li class=""><a href="#661-default-behaviour" class="">6.6.1. Default Behaviour</a></li>
<li class=""><a href="#662-resource-requests" class="">6.6.2. Resource Requests</a></li>
<li class=""><a href="#663-resource-limits" class="">6.6.3. Resource Limits</a></li>
<li class=""><a href="#664-limitrange" class="">6.6.4. LimitRange</a></li>
<li class=""><a href="#665-resourcequota" class="">6.6.5. ResourceQuota</a></li>
</ul>
</li>
<li class=""><a href="#67-deamonsets" class="">6.7. DeamonSets</a></li>
<li class=""><a href="#68-static-pods" class="">6.8. Static Pods</a>
<ul>
<li class=""><a href="#681-what-is-static-pods" class="">6.8.1. What is Static Pods</a></li>
<li class=""><a href="#682-static-pods-in-cluster" class="">6.8.2. Static Pods in Cluster</a></li>
<li class=""><a href="#683-static-pods-use-case" class="">6.8.3. Static Pods Use Case</a></li>
<li class=""><a href="#684-static-pods-vs-daemonsets" class="">6.8.4. Static Pods vs. DaemonSets</a></li>
</ul>
</li>
<li class=""><a href="#69-multiple-schedulers" class="">6.9. Multiple Schedulers</a></li>
<li class=""><a href="#610-configuring-scheduler-profiles" class="">6.10. Configuring Scheduler Profiles</a></li>
<li class=""><a href="#611-admission-controllers" class="">6.11. Admission Controllers</a></li>
<li class=""><a href="#612-validating-and-mutating-admission-controllers" class="">6.12. Validating and Mutating Admission Controllers</a>
<ul>
<li class=""><a href="#6121-validating-admission-controllers" class="">6.12.1. Validating Admission Controllers</a></li>
<li class=""><a href="#6122-mutating-admission-controller" class="">6.12.2. Mutating Admission Controller</a></li>
<li class=""><a href="#6123-custom-validatingmutating-admission-controllers" class="">6.12.3. Custom Validating/Mutating Admission Controllers</a></li>
</ul>
</li>
</ul>
</li>
<li class=""><a href="#7-logging-and-monitoring" class="">7. Logging and Monitoring</a>
<ul>
<li class=""><a href="#71-monitor-cluster-components" class="">7.1. Monitor Cluster Components</a>
<ul>
<li class=""><a href="#711-tools" class="">7.1.1. Tools</a></li>
</ul>
</li>
<li class=""><a href="#72-managing-application-logs" class="">7.2. Managing Application Logs</a></li>
</ul>
</li>
<li class=""><a href="#8-application-lifecycle-management" class="">8. Application Lifecycle Management</a>
<ul>
<li class=""><a href="#81-rolling-updates-and-rollbacks" class="">8.1. Rolling Updates and Rollbacks</a>
<ul>
<li class=""><a href="#811-deployment-strategy" class="">8.1.1. Deployment Strategy</a></li>
</ul>
</li>
<li class=""><a href="#82-configure-applications" class="">8.2. Configure Applications</a>
<ul>
<li class=""><a href="#821-commands-and-arguments-in-docker-and-k8s" class="">8.2.1. Commands and Arguments in Docker and K8s</a></li>
<li class=""><a href="#822-configuring-environment-variables-in-applications" class="">8.2.2. Configuring Environment Variables in Applications</a></li>
<li class=""><a href="#823-configuring-configmaps-in-applications" class="">8.2.3. Configuring ConfigMaps in Applications</a></li>
<li class=""><a href="#824-configure-secrets-an-applications" class="">8.2.4. Configure Secrets an Applications</a>
<ul>
<li class=""><a href="#8241-create-secrets" class="">8.2.4.1. Create Secrets</a></li>
<li class=""><a href="#8242-encrypting-secret-data-at-rest" class="">8.2.4.2. Encrypting Secret Data at Rest</a></li>
<li class=""><a href="#8243-secret-store-providers" class="">8.2.4.3. Secret Store Providers</a></li>
</ul>
</li>
</ul>
</li>
<li class=""><a href="#83-scale-applications" class="">8.3. Scale Applications</a></li>
<li class=""><a href="#84-multi-container-pods" class="">8.4. Multi Container Pods</a>
<ul>
<li class=""><a href="#841-multi-container-pods-design-patterns" class="">8.4.1. Multi-container Pods Design Patterns</a></li>
</ul>
</li>
<li class=""><a href="#85-initcontainers" class="">8.5. InitContainers</a></li>
<li class=""><a href="#86-self-healing-applications" class="">8.6. Self Healing Applications</a></li>
<li class=""><a href="#87-intro-to-autoscaling" class="">8.7. Intro to Autoscaling</a>
<ul>
<li class=""><a href="#871-scaling-cluster-infra-vs-scaling-workloads" class="">8.7.1. Scaling Cluster Infra vs Scaling Workloads</a></li>
<li class=""><a href="#872-manual-vs-automated-scaling" class="">8.7.2. Manual vs Automated Scaling</a></li>
<li class=""><a href="#873-horizontal-pod-autoscaler-hpa" class="">8.7.3. Horizontal Pod Autoscaler (HPA)</a>
<ul>
<li class=""><a href="#8731-scaling-a-workload-manually" class="">8.7.3.1. Scaling a workload manually</a></li>
<li class=""><a href="#8732-hpa" class="">8.7.3.2. HPA</a></li>
</ul>
</li>
<li class=""><a href="#874-vertical-pod-autoscaling-vpa" class="">8.7.4. Vertical Pod Autoscaling (VPA)</a>
<ul>
<li class=""><a href="#8741-deployment-of-vpa-components" class="">8.7.4.1. Deployment of VPA Components</a></li>
</ul>
</li>
<li class=""><a href="#875-in-place-resize-pods" class="">8.7.5. In-place resize Pods</a>
<ul>
<li class=""><a href="#8751-limitations" class="">8.7.5.1. Limitations</a></li>
</ul>
</li>
<li class=""><a href="#876-vpa-vs-hpa" class="">8.7.6. VPA vs. HPA</a></li>
</ul>
</li>
</ul>
</li>
<li class=""><a href="#9-cluster-maintenance" class="">9. Cluster Maintenance</a>
<ul>
<li class=""><a href="#91-os-upgrade" class="">9.1. OS Upgrade</a></li>
<li class=""><a href="#92-kubernetes-software-versions" class="">9.2. Kubernetes Software Versions</a></li>
<li class=""><a href="#93-cluster-upgrade-process" class="">9.3. Cluster Upgrade Process</a>
<ul>
<li class=""><a href="#931-kubeadm-upgrade" class="">9.3.1. <code>kubeadm upgrade</code></a></li>
<li class=""><a href="#932-cluster-upgrade---demo" class="">9.3.2. Cluster Upgrade - Demo</a></li>
<li class=""><a href="#933-backup-and-restore-methods" class="">9.3.3. Backup and Restore Methods</a>
<ul>
<li class=""><a href="#9331-backup-candidates" class="">9.3.3.1. Backup Candidates</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class=""><a href="#10-security" class="">10. Security</a>
<ul>
<li class=""><a href="#101-kubernetes-security-primitives" class="">10.1. Kubernetes Security Primitives</a>
<ul>
<li class=""><a href="#1011-cluster-hosts-security" class="">10.1.1. Cluster Hosts Security</a></li>
<li class=""><a href="#1012-kubernetes-security" class="">10.1.2. Kubernetes Security</a></li>
<li class=""><a href="#1013-tls-certificates" class="">10.1.3. TLS Certificates</a></li>
<li class=""><a href="#1014-application-communication-within-cluster" class="">10.1.4. Application Communication within Cluster</a></li>
</ul>
</li>
<li class=""><a href="#102-authentication" class="">10.2. Authentication</a>
<ul>
<li class=""><a href="#1021-users" class="">10.2.1. Users</a>
<ul>
<li class=""><a href="#10211-basic-authentication-mechanism---static-password-file" class="">10.2.1.1. Basic Authentication Mechanism - Static Password File</a></li>
<li class=""><a href="#10212-basic-authentication-mechanism---static-token-file" class="">10.2.1.2. Basic Authentication Mechanism - Static Token File</a></li>
</ul>
</li>
<li class=""><a href="#1022-service-accounts" class="">10.2.2. Service Accounts</a></li>
</ul>
</li>
<li class=""><a href="#103-tls-certificates-in-k8s" class="">10.3. TLS Certificates in K8s</a>
<ul>
<li class=""><a href="#1031-tls-basics" class="">10.3.1. TLS Basics</a>
<ul>
<li class=""><a href="#10311-private-vs-public-key" class="">10.3.1.1. Private vs Public Key</a></li>
<li class=""><a href="#10312-symmetric-encryption" class="">10.3.1.2. Symmetric Encryption</a></li>
<li class=""><a href="#10313-asymmetric-encryption" class="">10.3.1.3. Asymmetric Encryption</a></li>
<li class=""><a href="#10314-asymmetric-encryption---ssh" class="">10.3.1.4. Asymmetric Encryption - SSH</a></li>
<li class=""><a href="#10315-asymmetric-encryption---https" class="">10.3.1.5. Asymmetric Encryption - HTTPS</a></li>
<li class=""><a href="#10316-certificate-authority-ca" class="">10.3.1.6. Certificate Authority (CA)</a></li>
<li class=""><a href="#10317-naming-convention-of-public-and-private-keys" class="">10.3.1.7. Naming Convention of Public and Private Keys</a></li>
<li class=""><a href="#10318-tls-use-cases" class="">10.3.1.8. TLS Use Cases</a></li>
</ul>
</li>
<li class=""><a href="#1032-tls-in-kubernetes" class="">10.3.2. TLS in Kubernetes</a></li>
<li class=""><a href="#1033-tls-in-kubernetes---certificate-creation" class="">10.3.3. TLS in Kubernetes - Certificate Creation</a></li>
<li class=""><a href="#1034-view-certificate-details" class="">10.3.4. View Certificate Details</a></li>
</ul>
</li>
<li class=""><a href="#104-certificate-api" class="">10.4. Certificate API</a>
<ul>
<li class=""><a href="#1041-steps-to-generate-certificate-for-a-new-user" class="">10.4.1. Steps to generate certificate for a new User</a></li>
</ul>
</li>
<li class=""><a href="#105-kubeconfig" class="">10.5. KubeConfig</a></li>
<li class=""><a href="#106-persistent-keyvalue-store" class="">10.6. Persistent Key/Value Store</a></li>
<li class=""><a href="#107-api-group" class="">10.7. API Group</a></li>
<li class=""><a href="#108-authorization" class="">10.8. Authorization</a>
<ul>
<li class=""><a href="#1081-authorization-modes" class="">10.8.1. Authorization Modes</a></li>
<li class=""><a href="#1082-authorization-mechanisms" class="">10.8.2. Authorization Mechanisms</a>
<ul>
<li class=""><a href="#10821-node-authorizer" class="">10.8.2.1. <strong>Node Authorizer</strong></a></li>
<li class=""><a href="#10822-abac" class="">10.8.2.2. <strong>ABAC</strong></a></li>
<li class=""><a href="#10823-rbac" class="">10.8.2.3. <strong>RBAC</strong></a></li>
<li class=""><a href="#10824-webhook" class="">10.8.2.4. Webhook</a></li>
</ul>
</li>
<li class=""><a href="#1083-rbac" class="">10.8.3. RBAC</a></li>
<li class=""><a href="#1084-cluster-roles-and-role-bindings" class="">10.8.4. Cluster Roles and Role Bindings</a></li>
</ul>
</li>
<li class=""><a href="#109-service-accounts" class="">10.9. Service Accounts</a></li>
<li class=""><a href="#1010-image-security" class="">10.10. Image Security</a></li>
<li class=""><a href="#1011-docker-security" class="">10.11. Docker Security</a></li>
<li class=""><a href="#1012-security-context" class="">10.12. Security Context</a></li>
<li class=""><a href="#1013-network-policies" class="">10.13. Network Policies</a></li>
<li class=""><a href="#1014-kubectx-and-kubens" class="">10.14. Kubectx and Kubens</a></li>
<li class=""><a href="#1015-custorm-resource-definition-crd" class="">10.15. Custorm Resource Definition (CRD)</a></li>
<li class=""><a href="#1016-custom-controllers" class="">10.16. Custom Controllers</a></li>
<li class=""><a href="#1017-operator-framework" class="">10.17. Operator Framework</a></li>
</ul>
</li>
<li class=""><a href="#11-storage" class="">11. Storage</a>
<ul>
<li class=""><a href="#111-docker-storage" class="">11.1. Docker Storage</a>
<ul>
<li class=""><a href="#1111-docker-storage-drivers-and-file-systems" class="">11.1.1. Docker Storage Drivers and File Systems</a></li>
<li class=""><a href="#1112-volume-driver-plugins-in-docker" class="">11.1.2. Volume Driver Plugins in Docker</a></li>
</ul>
</li>
<li class=""><a href="#112-container-interfaces" class="">11.2. Container Interfaces</a>
<ul>
<li class=""><a href="#1121-container-storage-interface-csi" class="">11.2.1. Container Storage Interface (CSI)</a></li>
</ul>
</li>
<li class=""><a href="#113-volumes" class="">11.3. Volumes</a>
<ul>
<li class=""><a href="#1131-volumes-and-mounts" class="">11.3.1. Volumes and Mounts</a></li>
<li class=""><a href="#1132-volume-types" class="">11.3.2. Volume Types</a></li>
</ul>
</li>
<li class=""><a href="#114-persistent-volumes-pv" class="">11.4. Persistent Volumes (PV)</a></li>
<li class=""><a href="#115-persistent-volume-claims-pvc" class="">11.5. Persistent Volume Claims (PVC)</a></li>
<li class=""><a href="#116-storage-class" class="">11.6. Storage Class</a>
<ul>
<li class=""><a href="#1161-static-provisioning-of-volume" class="">11.6.1. Static Provisioning of Volume</a></li>
<li class=""><a href="#1162-dynamic-provisioning-of-volume" class="">11.6.2. Dynamic Provisioning of Volume</a></li>
</ul>
</li>
</ul>
</li>
<li class=""><a href="#12-networking" class="">12. Networking</a>
<ul>
<li class=""><a href="#121-coredns" class="">12.1. CoreDNS</a></li>
</ul>
</li>
<li class=""><a href="#13-design-and-install-a-kubernetes-cluster" class="">13. Design and Install a Kubernetes Cluster</a></li>
<li class=""><a href="#14-install-k8s-the-kubeadm-way" class="">14. Install &quot;K8s the kubeadm way&quot;</a></li>
<li class=""><a href="#15-helm-basics" class="">15. Helm Basics</a>
<ul>
<li class=""><a href="#151-what-is-helm" class="">15.1. What is Helm</a></li>
<li class=""><a href="#152-helm-components" class="">15.2. Helm Components</a></li>
</ul>
</li>
<li class=""><a href="#16-kustomize-basics" class="">16. Kustomize Basics</a></li>
<li class=""><a href="#17-end-to-end-tests-on-a-k8s-cluster" class="">17. End to End tests on a K8s Cluster</a></li>
<li class=""><a href="#18-troubleshooting" class="">18. Troubleshooting</a></li>
<li class=""><a href="#19-other-topics" class="">19. Other Topics</a></li>
<li class=""><a href="#20-ligtning-labs" class="">20. Ligtning Labs</a></li>
<li class=""><a href="#21-mock-exams" class="">21. Mock Exams</a></li>
<li class=""><a href="#22-course-conclusion" class="">22. Course Conclusion</a></li>
<li class=""><a href="#23-commands" class="">23. Commands</a>
<ul>
<li class=""><a href="#231-kubernetes" class="">23.1. Kubernetes</a></li>
<li class=""><a href="#232-helm" class="">23.2. Helm</a></li>
</ul>
</li>
<li class=""><a href="#24-references" class="">24. References</a></li>
</ul>
<h1>2. Intro</h1>
<p>This document contains my notes on preparation course of Certified Kubernetes Administrators (CKA) Certification by Mumshad Mannambeth.</p>
<h1>3. Certification</h1>
<ul>
<li class=""><a href="https://www.cncf.io/certification/cka/" target="_blank" rel="noopener noreferrer" class="">Certified Kubernetes Administrator</a></li>
<li class=""><a href="https://github.com/cncf/curriculum" target="_blank" rel="noopener noreferrer" class="">Exam Curriculum (Topics)</a></li>
<li class=""><a href="https://www.cncf.io/certification/candidate-handbook" target="_blank" rel="noopener noreferrer" class="">Candidate Handbook</a></li>
<li class=""><a href="http://training.linuxfoundation.org/go//Important-Tips-CKA-CKAD" target="_blank" rel="noopener noreferrer" class="">Exam Tips</a></li>
</ul>
<h1>4. CKA Lecture and Lab Notes</h1>
<ul>
<li class=""><a href="https://github.com/kodekloudhub/certified-kubernetes-administrator-course" target="_blank" rel="noopener noreferrer" class="">Certified Kubernetes Administrator (CKA) Course</a></li>
</ul>
<h1>5. Core Concepts</h1>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="51-kubernetes-architecture">5.1. Kubernetes Architecture<a href="#51-kubernetes-architecture" class="hash-link" aria-label="Direct link to 5.1. Kubernetes Architecture" title="Direct link to 5.1. Kubernetes Architecture" translate="no">​</a></h2>
<ul>
<li class="">Worker Nodes: hosts application as containers<!-- -->
<ul>
<li class="">Worker Nodes Components:<!-- -->
<ul>
<li class="">kubelet: is an agent which runs on Worker Nodes</li>
<li class="">kube-proxy: is a service responsible for networking on Worker Nodes</li>
</ul>
</li>
</ul>
</li>
<li class="">Master Node: manage, plan schedule, monitor etc. nodes using Control Plane Components<!-- -->
<ul>
<li class="">Control Plane Components:<!-- -->
<ul>
<li class="">kube-apiserver: is responsible for orchestration of all operations within k8s cluster Control Plane Components</li>
<li class="">ETCD Cluster: is a database which stores information in a key-value format</li>
<li class="">kube-scheduler: identifies right node based on containers resource requirements</li>
<li class="">Controller-Manager<!-- -->
<ul>
<li class="">Node-Controller</li>
<li class="">Replication-Controller</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="52-open-container-initiative-oci">5.2. Open Container Initiative (OCI)<a href="#52-open-container-initiative-oci" class="hash-link" aria-label="Direct link to 5.2. Open Container Initiative (OCI)" title="Direct link to 5.2. Open Container Initiative (OCI)" translate="no">​</a></h2>
<ul>
<li class=""><strong>imagespec</strong>: specifications how container image must be built</li>
<li class=""><strong>runtimespec</strong>: specifications how conainer runtime should be developed</li>
</ul>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="53-container-runtime-interface-cri">5.3. Container Runtime Interface (CRI)<a href="#53-container-runtime-interface-cri" class="hash-link" aria-label="Direct link to 5.3. Container Runtime Interface (CRI)" title="Direct link to 5.3. Container Runtime Interface (CRI)" translate="no">​</a></h2>
<ul>
<li class="">Kubernetes introduced <strong>Container Runtime Interface (CRI)</strong> which allows any vendor to work as container runtime as long as it adheres to <strong>OCI</strong> specification and not only Docker which used initially <strong>dockershim</strong>.</li>
<li class="">Starting from version <strong>v1.24</strong> Kubernetes deleted <strong>dockershim</strong> and Docker support</li>
</ul>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="54-docker-vs-containerd">5.4. Docker vs ContainerD<a href="#54-docker-vs-containerd" class="hash-link" aria-label="Direct link to 5.4. Docker vs ContainerD" title="Direct link to 5.4. Docker vs ContainerD" translate="no">​</a></h2>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="541-docker">5.4.1. Docker<a href="#541-docker" class="hash-link" aria-label="Direct link to 5.4.1. Docker" title="Direct link to 5.4.1. Docker" translate="no">​</a></h3>
<ul>
<li class="">Docker is not only container runtime, but also consist of multiple tools<!-- -->
<ul>
<li class="">CLI</li>
<li class="">API</li>
<li class="">BUILD</li>
<li class="">Volumes</li>
<li class="">AUTH</li>
<li class="">SECURITY</li>
<li class="">ContainerD</li>
</ul>
</li>
<li class="">Docker uses container runtime ContainerD</li>
</ul>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="542-containerd">5.4.2. ContainerD<a href="#542-containerd" class="hash-link" aria-label="Direct link to 5.4.2. ContainerD" title="Direct link to 5.4.2. ContainerD" translate="no">​</a></h3>
<ul>
<li class="">ContainerD is part of Cloud Native Computing Foundation (CNCF)</li>
<li class="">ContainerD is a higher-level tool that manages the entire lifecycle of containers.</li>
<li class="">ContainerD is a deamon which manages runc and compatable with Container Runtime Interface (CRI)</li>
<li class=""><strong>runc</strong> is a container runtime</li>
<li class="">ContainerD works as container runtime on its own separate from Docker</li>
<li class="">ContainerD comes with <code>crt</code> CLI tool mainly made for debugging container. <code>nerdctl</code> (similar to docker CLI) provides stable and humand-friendly user experience</li>
<li class=""><code>crictl</code> is another CLI tool from k8s community compatable with CRI which works accross different container runtime. Mainly used for debugging</li>
<li class="">Read <a href="https://github.com/containerd/containerd/blob/main/docs/getting-started.md" target="_blank" rel="noopener noreferrer" class="">more</a></li>
</ul>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="55-etcd">5.5. ETCD<a href="#55-etcd" class="hash-link" aria-label="Direct link to 5.5. ETCD" title="Direct link to 5.5. ETCD" translate="no">​</a></h2>
<ul>
<li class=""><strong>ETCD</strong> is a distributed reliable key-value store that is simple, secure and fast</li>
<li class=""><strong>Key-Value Store</strong> stores information if form of documents, pages (i.e. files) which can be in any format and structure</li>
</ul>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="551-get-started-quickly-with-etcd">5.5.1. Get started quickly with ETCD<a href="#551-get-started-quickly-with-etcd" class="hash-link" aria-label="Direct link to 5.5.1. Get started quickly with ETCD" title="Direct link to 5.5.1. Get started quickly with ETCD" translate="no">​</a></h3>
<ul>
<li class="">
<p>Download the relevant binary for your operating system from github releases page (<a href="https://github.com/etcd-io/etcd/releases" target="_blank" rel="noopener noreferrer" class="">https://github.com/etcd-io/etcd/releases</a>)</p>
<p>For Example: To download ETCD v3.5.6, run the below curl command</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ curl -LO https://github.com/etcd-io/etcd/releases/download/v3.5.6/etcd-v3.5.6-linux-amd64.tar.gz</span><br></span></code></pre></div></div>
</li>
<li class="">
<p>Extract it.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ tar xvzf etcd-v3.5.6-linux-amd64.tar.gz</span><br></span></code></pre></div></div>
</li>
<li class="">
<p>Run the ETCD Service</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ ./etcd</span><br></span></code></pre></div></div>
</li>
<li class="">
<p>When you start <strong><code>ETCD</code></strong> it will by default listen on port <strong><code>2379</code></strong></p>
</li>
<li class="">
<p>The default client that comes with <strong><code>ETCD</code></strong> is the <a href="https://github.com/etcd-io/etcd/tree/main/etcdctl" target="_blank" rel="noopener noreferrer" class=""><strong><code>etcdctl</code></strong></a> client. You can use it to store and retrieve key-value pairs.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Syntax: To Store a Key-Value pair</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ ./etcdctl put key1 value1</span><br></span></code></pre></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Syntax: To retrieve the stored data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ ./etcdctl get key1</span><br></span></code></pre></div></div>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Syntax: To view </span><span class="token function" style="color:#d73a49">more</span><span class="token plain"> commands. Run etcdctl without any arguments</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ ./etcdctl</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># etcdctl command in API 3 version</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">etcdctl snapshot save </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">etcdctl endpoint health</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">etcdctl get</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">etcdctl put</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">ETCDCTL_API</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">3</span><span class="token plain">           </span><span class="token comment" style="color:#999988;font-style:italic"># set the environment variable ETCDCTL_API for desired API version</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Certs for ETCDCTL to authenticate to the ETCD API Server</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token parameter variable" style="color:#36acaa">--cacert</span><span class="token plain"> /etc/kubernetes/pki/etcd/ca.crt     </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token parameter variable" style="color:#36acaa">--cert</span><span class="token plain"> /etc/kubernetes/pki/etcd/server.crt     </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token parameter variable" style="color:#36acaa">--key</span><span class="token plain"> /etc/kubernetes/pki/etcd/server.key</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Example: </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl </span><span class="token builtin class-name">exec</span><span class="token plain"> etcd-master </span><span class="token parameter variable" style="color:#36acaa">-n</span><span class="token plain"> kube-system -- </span><span class="token function" style="color:#d73a49">sh</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-c</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;ETCDCTL_API=3 etcdctl get / --prefix --keys-only --limit=10 --cacert /etc/kubernetes/pki/etcd/ca.crt --cert /etc/kubernetes/pki/etcd/server.crt  --key /etc/kubernetes/pki/etcd/server.key&quot;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
</li>
</ul>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="552-etcd-in-kubernetes">5.5.2. ETCD in Kubernetes<a href="#552-etcd-in-kubernetes" class="hash-link" aria-label="Direct link to 5.5.2. ETCD in Kubernetes" title="Direct link to 5.5.2. ETCD in Kubernetes" translate="no">​</a></h3>
<ul>
<li class="">
<p>The <strong>ETCD Datastore</strong> stores following cluster information:</p>
<ul>
<li class="">Nodes</li>
<li class="">PODS</li>
<li class="">Configs</li>
<li class="">Secrets</li>
<li class="">Accounts</li>
<li class="">Roles</li>
<li class="">Bindings</li>
<li class="">Others</li>
</ul>
</li>
<li class="">
<p><code>kubectl get</code> command retrieves all information from the <strong>ETCD Server</strong></p>
</li>
</ul>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="553-etcd-setup---manual-vs-kubeadm">5.5.3. ETCD Setup - Manual vs kubeadm<a href="#553-etcd-setup---manual-vs-kubeadm" class="hash-link" aria-label="Direct link to 5.5.3. ETCD Setup - Manual vs kubeadm" title="Direct link to 5.5.3. ETCD Setup - Manual vs kubeadm" translate="no">​</a></h3>
<ul>
<li class="">Read <a href="https://github.com/kodekloudhub/certified-kubernetes-administrator-course/blob/master/docs/02-Core-Concepts/05-ETCD-in-Kubernetes.md" target="_blank" rel="noopener noreferrer" class="">more</a></li>
</ul>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="56-kube-api-server">5.6. Kube-API Server<a href="#56-kube-api-server" class="hash-link" aria-label="Direct link to 5.6. Kube-API Server" title="Direct link to 5.6. Kube-API Server" translate="no">​</a></h2>
<ul>
<li class=""><strong>Kube-API Server</strong> is a primary management component in K8s</li>
<li class="">kube-api server performs following actions when  <code>kubectl</code> command is executed:<!-- -->
<ul>
<li class="">Authenticate User</li>
<li class="">Validate Request</li>
<li class="">Retrieve dataf</li>
</ul>
</li>
<li class="">Read <a href="https://github.com/kodekloudhub/certified-kubernetes-administrator-course/blob/master/docs/02-Core-Concepts/06-Kube-API-Server.md" target="_blank" rel="noopener noreferrer" class="">more</a></li>
</ul>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="57-kube-controller-manager">5.7. Kube Controller Manager<a href="#57-kube-controller-manager" class="hash-link" aria-label="Direct link to 5.7. Kube Controller Manager" title="Direct link to 5.7. Kube Controller Manager" translate="no">​</a></h2>
<ul>
<li class=""><strong>Kube Controller Manager</strong> manages various controllers in kubernetes</li>
<li class=""><strong>Controller</strong> is a process that continuously monitors the state of the components within the system and ensures the whole system to have the desired functioning state</li>
<li class="">Controllers:<!-- -->
<ul>
<li class=""><strong>Node Controller</strong> - monitors health of Nodes every <code>5s</code>
<ul>
<li class=""><code>Node Monitor Period = 5s</code></li>
<li class=""><code>Node Monitor Grace Period = 40s</code> (i.e. waits 40s before marking it as unreachable)</li>
<li class=""><code>POD Eviction Timeout = 5m</code> (i.e. waits 5m to come back up if unreachable before removing pods and provisioning resources to the healthy nodes if it is part of replica set)</li>
</ul>
</li>
<li class=""><strong>Replication Controller</strong> - monitors state of replica sets</li>
<li class=""><strong>Deployment Controller</strong></li>
<li class=""><strong>Namespace Controller</strong></li>
<li class=""><strong>Endpoint-Controller</strong></li>
<li class=""><strong>CronJob</strong></li>
<li class=""><strong>Job Controller</strong></li>
<li class=""><strong>PV Protection Controller</strong></li>
<li class=""><strong>Service Account Controller</strong></li>
<li class=""><strong>Stateful Set</strong></li>
<li class=""><strong>Replica Set</strong></li>
<li class=""><strong>PV Binder Controller</strong></li>
</ul>
</li>
</ul>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="571-installation-of-kube-controller-manager">5.7.1. Installation of Kube-Controller-Manager<a href="#571-installation-of-kube-controller-manager" class="hash-link" aria-label="Direct link to 5.7.1. Installation of Kube-Controller-Manager" title="Direct link to 5.7.1. Installation of Kube-Controller-Manager" translate="no">​</a></h3>
<ul>
<li class="">Read <a href="https://github.com/kodekloudhub/certified-kubernetes-administrator-course/blob/master/docs/02-Core-Concepts/07-Kube-Controller-Manager.md" target="_blank" rel="noopener noreferrer" class="">more</a></li>
</ul>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="58-kube-scheduler">5.8. Kube Scheduler<a href="#58-kube-scheduler" class="hash-link" aria-label="Direct link to 5.8. Kube Scheduler" title="Direct link to 5.8. Kube Scheduler" translate="no">​</a></h2>
<ul>
<li class=""><strong>kube-scheduler</strong> is responsible for scheduling pods on nodes. The kube-scheduler is only responsible for deciding which pod goes on which node depending on certain criteria (e.g. <strong>Filter Nodes</strong>, <strong>Rank Nodes</strong>). It doesn&#x27;t actually place the pod on the nodes, that&#x27;s the job of the <code>kubelet</code>.</li>
<li class="">Read <a href="https://github.com/kodekloudhub/certified-kubernetes-administrator-course/blob/master/docs/02-Core-Concepts/08-Kube-Scheduler.md" target="_blank" rel="noopener noreferrer" class="">more</a></li>
</ul>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="59-kubelet">5.9. Kubelet<a href="#59-kubelet" class="hash-link" aria-label="Direct link to 5.9. Kubelet" title="Direct link to 5.9. Kubelet" translate="no">​</a></h2>
<ul>
<li class=""><strong>kubelet</strong> is a node agent which is responsible for creating the pods on the nodes and the sole point of contact for the kubernetes cluster</li>
<li class="">kubelet also collects reports and sends regularly to master node</li>
</ul>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="510-kube-proxy">5.10. Kube Proxy<a href="#510-kube-proxy" class="hash-link" aria-label="Direct link to 5.10. Kube Proxy" title="Direct link to 5.10. Kube Proxy" translate="no">​</a></h2>
<ul>
<li class=""><strong>POD Network</strong> is an internal virtual network that spans across all nodes in the cluster to which all pods are connected. Within k8s cluster every pod can reach every other pod which is accomplished by deploying networking solution, i.e. POD Network.</li>
<li class=""><strong>kube-proxy</strong> is a network component in Kubernetes that helps manage network communication to and from the Pods in a k8s cluster. Key function of kube-proxy:<!-- -->
<ul>
<li class="">Traffic Routing</li>
<li class="">Load Balancing</li>
<li class="">Service Discovery</li>
<li class="">Protocol Support</li>
</ul>
</li>
</ul>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="511-pods">5.11. Pods<a href="#511-pods" class="hash-link" aria-label="Direct link to 5.11. Pods" title="Direct link to 5.11. Pods" translate="no">​</a></h2>
<ul>
<li class=""><strong>Pod</strong> is a logical host for one or more containers that are deployed together on the same host</li>
</ul>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Example of Pod definition with YAML</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Pod               </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">                       </span><span class="token comment" style="color:#999988;font-style:italic"># dictionary</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> myapp</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">pod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">namespace</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> dev</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">labels</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">                     </span><span class="token comment" style="color:#999988;font-style:italic"># under labels custom key:value allowed</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">app</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> myapp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> front</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">                           </span><span class="token comment" style="color:#999988;font-style:italic"># dictionary</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">containers</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">                 </span><span class="token comment" style="color:#999988;font-style:italic"># list/array</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> nginx</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">controller</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> nginx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="512-replicasets">5.12. ReplicaSets<a href="#512-replicasets" class="hash-link" aria-label="Direct link to 5.12. ReplicaSets" title="Direct link to 5.12. ReplicaSets" translate="no">​</a></h2>
<ul>
<li class=""><strong>ReplicaSet</strong> and <strong>ReplicationController</strong> (deprecated in favor of ReplicaSet) are both Kubernetes resources for managing pod replication to ensure a specified number of pod replicas running at any given time</li>
</ul>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Example of ReplicationController definition with YAML</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ReplicationController</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">                       </span><span class="token comment" style="color:#999988;font-style:italic"># dictionary</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> myapp</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">rc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">namespace</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> dev</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">labels</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">                     </span><span class="token comment" style="color:#999988;font-style:italic"># under labels custom key:value allowed</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">app</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> myapp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> front</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">                           </span><span class="token comment" style="color:#999988;font-style:italic"># dictionary</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">template</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">                   </span><span class="token comment" style="color:#999988;font-style:italic"># Pod template for replication</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">                       </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> myapp</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">pod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">labels</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">                     </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token key atrule" style="color:#00a4db">app</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> myapp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> front</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">                           </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">containers</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">                 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> nginx</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">controller</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> nginx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">replicas</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><br></span></code></pre></div></div>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Example of ReplicaSet definition with YAML</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> apps/v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ReplicaSet</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">                       </span><span class="token comment" style="color:#999988;font-style:italic"># dictionary</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> myapp</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">rs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">namespace</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> dev</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">labels</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">                     </span><span class="token comment" style="color:#999988;font-style:italic"># under labels custom key:value allowed</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">app</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> myapp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> front</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">                           </span><span class="token comment" style="color:#999988;font-style:italic"># dictionary</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">template</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">                   </span><span class="token comment" style="color:#999988;font-style:italic"># Pod template for replication</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">                       </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> myapp</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">pod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">labels</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">                     </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token key atrule" style="color:#00a4db">app</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> myapp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> front</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">                           </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">containers</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">                 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> nginx</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">controller</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> nginx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">replicas</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">selector</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">                   </span><span class="token comment" style="color:#999988;font-style:italic"># Major difference from ReplicationController</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">matchLabels</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> front</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">end     </span><span class="token comment" style="color:#999988;font-style:italic"># To select all existing Pods matching defined label</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="513-labels-and-selectors">5.13. Labels and Selectors<a href="#513-labels-and-selectors" class="hash-link" aria-label="Direct link to 5.13. Labels and Selectors" title="Direct link to 5.13. Labels and Selectors" translate="no">​</a></h2>
<ul>
<li class=""><strong>Labels</strong> are <em>key/value</em> pairs that are attached to objects such as Pods for categorizing resources.</li>
<li class=""><strong>Selectors</strong> are <em>queries</em> to filter resources based on <em>labels</em>.</li>
</ul>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="514-annotations">5.14. Annotations<a href="#514-annotations" class="hash-link" aria-label="Direct link to 5.14. Annotations" title="Direct link to 5.14. Annotations" translate="no">​</a></h2>
<ul>
<li class=""><strong>Annotations</strong> are key-value pairs that can be attached to various Kubernetes objects (e.g. pods, services, deployments etc.) to store arbitrary metadata that is not used for identification or selection.</li>
<li class="">Usage of Annotations:<!-- -->
<ul>
<li class="">Storing build or version information</li>
<li class="">Providing links to documentation or related resources</li>
<li class="">Specifying configuration options for tools that interact with the resource (e.g., deployment tools, monitoring systems)</li>
</ul>
</li>
</ul>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="515-deployments">5.15. Deployments<a href="#515-deployments" class="hash-link" aria-label="Direct link to 5.15. Deployments" title="Direct link to 5.15. Deployments" translate="no">​</a></h2>
<ul>
<li class=""><strong>Deployment</strong> is a higher-level abstraction that manages a ReplicaSet, which in turn manages the Pods.</li>
</ul>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Example of Deployment definition with YAML</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> apps/v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Deployment</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">                       </span><span class="token comment" style="color:#999988;font-style:italic"># dictionary</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> myapp</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">rs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">namespace</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> dev</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">labels</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">                     </span><span class="token comment" style="color:#999988;font-style:italic"># under labels custom key:value allowed</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">app</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> myapp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> front</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">                           </span><span class="token comment" style="color:#999988;font-style:italic"># dictionary</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">template</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">                   </span><span class="token comment" style="color:#999988;font-style:italic"># Pod template for replication</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">                       </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> myapp</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">pod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">labels</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">                     </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token key atrule" style="color:#00a4db">app</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> myapp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> front</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">                           </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">containers</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">                 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> nginx</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">controller</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> nginx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">replicas</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">selector</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">                   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">matchLabels</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> front</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">end     </span><span class="token comment" style="color:#999988;font-style:italic"># To select all existing Pods matching defined label</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="516-services">5.16. Services<a href="#516-services" class="hash-link" aria-label="Direct link to 5.16. Services" title="Direct link to 5.16. Services" translate="no">​</a></h2>
<ul>
<li class=""><strong>Service</strong> is used to expose a set of Pods and enable communication between them</li>
<li class="">Services enable communication between different components of an application, allowing Pods to discover and interact with each other reliably</li>
<li class="">There are different types of Services, each serving a specific purpose</li>
<li class="">Service acts as built-in <em>load balancer</em> to distribute load across different Pods (<code>Algorithm: Random, SessionAffinity: Yes</code>)</li>
</ul>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="5161-clusterip">5.16.1. ClusterIP<a href="#5161-clusterip" class="hash-link" aria-label="Direct link to 5.16.1. ClusterIP" title="Direct link to 5.16.1. ClusterIP" translate="no">​</a></h3>
<ul>
<li class="">This is the default service type</li>
<li class="">It exposes the service on a cluster-internal IP</li>
<li class="">Only accessible from within the cluste</li>
<li class="">Useful for internal communication between services</li>
</ul>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Example of Service of type ClusterIP definition with YAML</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Service               </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">                       </span><span class="token comment" style="color:#999988;font-style:italic"># dictionary</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> back</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">namespace</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> dev</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ClusterIP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">ports</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">port</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">80</span><span class="token plain">                </span><span class="token comment" style="color:#999988;font-style:italic"># The port that the service will expose</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">targetPort</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">8080</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># The port on the pod that the service should forward to</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">selector</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">app</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> myapp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> back</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="5162-nodeport">5.16.2. NodePort<a href="#5162-nodeport" class="hash-link" aria-label="Direct link to 5.16.2. NodePort" title="Direct link to 5.16.2. NodePort" translate="no">​</a></h3>
<ul>
<li class="">Service of type NodePort listens on the static port of each node&#x27;s IP address in cluster and forward request to the Pods</li>
<li class="">Node&#x27;s port range <code>30 000 to 32 767</code></li>
</ul>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Example of Service of type NodePort definition with YAML</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Service               </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">                       </span><span class="token comment" style="color:#999988;font-style:italic"># dictionary</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> myapp</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">service</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">namespace</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> dev</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> NodePort</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">ports</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">port</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">80</span><span class="token plain">                </span><span class="token comment" style="color:#999988;font-style:italic"># The port that the service will expose</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">targetPort</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">8080</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># The port on the pod that the service should forward to</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">nodePort</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">30008</span><span class="token plain">         </span><span class="token comment" style="color:#999988;font-style:italic"># The port on each node that will forward to the service</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">selector</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">app</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> myapp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> front</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">end</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="5163-loadbalancer">5.16.3. LoadBalancer<a href="#5163-loadbalancer" class="hash-link" aria-label="Direct link to 5.16.3. LoadBalancer" title="Direct link to 5.16.3. LoadBalancer" translate="no">​</a></h3>
<ul>
<li class="">Creates an external load balancer (if supported by the cloud provider)</li>
<li class="">Automatically assigns a public IP address to the service</li>
<li class="">Distributes incoming traffic across multiple nodes</li>
<li class="">Ideal for production environments where you need to handle large amounts of traffic</li>
</ul>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Example of Service of type LoadBalancer definition with YAML</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Service               </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">                       </span><span class="token comment" style="color:#999988;font-style:italic"># dictionary</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> myapp</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">service</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">namespace</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> dev</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> LoadBalancer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">ports</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">port</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">80</span><span class="token plain">                </span><span class="token comment" style="color:#999988;font-style:italic"># The port that the service will expose</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">targetPort</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">8080</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># The port on the pod that the service should forward to</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">nodePort</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">30008</span><span class="token plain">         </span><span class="token comment" style="color:#999988;font-style:italic"># The port on each node that will forward to the service</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="5164-externalname">5.16.4. ExternalName<a href="#5164-externalname" class="hash-link" aria-label="Direct link to 5.16.4. ExternalName" title="Direct link to 5.16.4. ExternalName" translate="no">​</a></h3>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="517-namespaces">5.17. Namespaces<a href="#517-namespaces" class="hash-link" aria-label="Direct link to 5.17. Namespaces" title="Direct link to 5.17. Namespaces" translate="no">​</a></h2>
<ul>
<li class=""><strong>Namespace</strong> is a way to organize and manage resources within a cluster which provides a mechanism for isolating groups of resources</li>
<li class="">Key Points of Namespaces:<!-- -->
<ul>
<li class="">Isolation</li>
<li class="">Resource Management</li>
<li class="">Access Control</li>
<li class="">Resource Quotas</li>
<li class="">Network Policies</li>
<li class="">Scoped Resources</li>
</ul>
</li>
</ul>
<blockquote>
<p><strong>Info:</strong> A pattern to access a service in a different namespace using DNS:</p>
<p><code>&lt;service-name&gt;.&lt;namespace&gt;.svc.cluster.local</code></p>
<ul>
<li class=""><code>&lt;service-name&gt;</code>: name of the service to access</li>
<li class=""><code>&lt;namespace&gt;</code>: namespace where the service is located</li>
<li class=""><code>svc</code>: indicates that a service being accessed</li>
<li class=""><code>cluster.local</code>: default domain name for services in the k8s cluster (can be customized)</li>
</ul>
</blockquote>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Example of Namespace definition with YAML</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Namespace</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> dev</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="5171-resource-quota">5.17.1. Resource Quota<a href="#5171-resource-quota" class="hash-link" aria-label="Direct link to 5.17.1. Resource Quota" title="Direct link to 5.17.1. Resource Quota" translate="no">​</a></h3>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Example of ResourceQuota definition with YAML</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ResourceQuota</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> compute</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">quota</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">namespace</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> dev</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">hard</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">pods</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;10&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">requests.cpu</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;4&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">requests.memory</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;5Gi&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">limits.cpu</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;10&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">limits.memory</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;10Gi&quot;</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="518-imperative-vs-declarative">5.18. Imperative vs. Declarative<a href="#518-imperative-vs-declarative" class="hash-link" aria-label="Direct link to 5.18. Imperative vs. Declarative" title="Direct link to 5.18. Imperative vs. Declarative" translate="no">​</a></h2>
<p>In the context of Infrastructure as Code (IaC), imperative and declarative are two different approaches to defining and managing infrastructure.</p>
<ul>
<li class="">In an <strong>imperative</strong> approach, you specify how to achieve a desired state by providing a sequence of commands or instructions.</li>
<li class="">In a <strong>declarative</strong> approach, you specify what the desired state of the infrastructure should be, without detailing the steps to achieve that state.</li>
</ul>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># IMPERAIVE APPROACH</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># create objects</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl run </span><span class="token parameter variable" style="color:#36acaa">--image</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">nginx nginx </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl create deployment </span><span class="token parameter variable" style="color:#36acaa">--image</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">nginx nginx </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl expose deployment nginx </span><span class="token parameter variable" style="color:#36acaa">--port</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># update objects</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl edit deployment nginx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl scale deployment nginx </span><span class="token parameter variable" style="color:#36acaa">--replicas</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">5</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl </span><span class="token builtin class-name">set</span><span class="token plain"> image deployment nginx </span><span class="token assign-left variable" style="color:#36acaa">nginx</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">nginx:1.18</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl create </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> nginx.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl replace </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> nginx.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl delete </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> nginx.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># DECLARATIVE APPROACH</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> object-definition-file.yaml</span><br></span></code></pre></div></div>
<h1>6. Scheduling</h1>
<ul>
<li class=""><strong>Scheduling</strong> is a process of assigning pods (the smallest deployable units in Kubernetes) to nodes (the machines or virtual machines in the cluster) based on resource availability and other constraints.</li>
</ul>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="61-manual-scheduling">6.1. Manual Scheduling<a href="#61-manual-scheduling" class="hash-link" aria-label="Direct link to 6.1. Manual Scheduling" title="Direct link to 6.1. Manual Scheduling" translate="no">​</a></h2>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Pod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> nginx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">labels</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> nginx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">containers</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> nginx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> nginx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token key atrule" style="color:#00a4db">ports</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">containerPort</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">8080</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">nodeName</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> node02                            </span><span class="token comment" style="color:#999988;font-style:italic"># Specifies the name of Node, by default is not set</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="611-binding-object">6.1.1. Binding Object<a href="#611-binding-object" class="hash-link" aria-label="Direct link to 6.1.1. Binding Object" title="Direct link to 6.1.1. Binding Object" translate="no">​</a></h3>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Binding</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> my</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">pod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">namespace</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">target</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Node</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> my</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">node</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="62-taints-and-tolerations">6.2. Taints and Tolerations<a href="#62-taints-and-tolerations" class="hash-link" aria-label="Direct link to 6.2. Taints and Tolerations" title="Direct link to 6.2. Taints and Tolerations" translate="no">​</a></h2>
<ul>
<li class=""><strong>Taints</strong> are applied to nodes to prevent certain pods from being scheduled on them</li>
<li class=""><strong>Tolerations</strong> are applied to pods to allow them to be scheduled on nodes with specific taints</li>
</ul>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl taint nodes </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">NODE-NAME</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">KEY</span><span class="token operator" style="color:#393A34">&gt;=</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">VALUE</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">:</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">TAINT-EFFECT</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># TAINT-EFFECT defines what happens to Pods that do not TOLERATE this taint.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># TAINT-EFFECTs: NoSchedule, PreferNoSchedule, NoExecute</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># TAINTING NODE EXAMPLE</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl taint nodes node1 </span><span class="token assign-left variable" style="color:#36acaa">app</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">blue:NoSchedule</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># TOLERATION DEFINITION OF POD EXAMPLE</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: Pod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> name: nginx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> labels:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name: nginx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> containers:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> - name: nginx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   image: nginx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   ports:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   - containerPort: </span><span class="token number" style="color:#36acaa">8080</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> tolerations:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> - key: </span><span class="token string" style="color:#e3116c">&quot;app&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   operator: </span><span class="token string" style="color:#e3116c">&quot;Equal&quot;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   value: </span><span class="token string" style="color:#e3116c">&quot;blue&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   effect: </span><span class="token string" style="color:#e3116c">&quot;NoSchedule&quot;</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="63-node-selectors">6.3. Node Selectors<a href="#63-node-selectors" class="hash-link" aria-label="Direct link to 6.3. Node Selectors" title="Direct link to 6.3. Node Selectors" translate="no">​</a></h2>
<ul>
<li class="">Label a node:</li>
</ul>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl label nodes node01 </span><span class="token assign-left variable" style="color:#36acaa">size</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">Large</span><br></span></code></pre></div></div>
<ul>
<li class="">Assign a Pod to the Node</li>
</ul>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Pod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> myapp</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">pod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">containers</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> nginx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> nginx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">nodeSelector</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">size</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Large</span><br></span></code></pre></div></div>
<ul>
<li class="">Node Selector&#x27;s Limitations:<!-- -->
<ul>
<li class="">Advanced expressions, e.g. Large OR Medium, NOT Small etc.</li>
</ul>
</li>
</ul>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="64-node-affinity">6.4. Node Affinity<a href="#64-node-affinity" class="hash-link" aria-label="Direct link to 6.4. Node Affinity" title="Direct link to 6.4. Node Affinity" translate="no">​</a></h2>
<p>Node affinity is conceptually similar to <code>nodeSelector</code>, allowing you to constrain which nodes your Pod can be scheduled on based on node labels.</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Pod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> with</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">node</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">affinity</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">containers</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> nginx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> nginx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">affinity</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">nodeAffinity</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">requiredDuringSchedulingIgnoredDuringExecution</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">nodeSelectorTerms</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">matchExpressions</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">key</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> size</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">operator</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> In                                        </span><span class="token comment" style="color:#999988;font-style:italic"># operators: In, NotIn, Exists, DoesNotExist</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">values</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> Large</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> Medium</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="641-node-affinity-types">6.4.1. Node Affinity Types<a href="#641-node-affinity-types" class="hash-link" aria-label="Direct link to 6.4.1. Node Affinity Types" title="Direct link to 6.4.1. Node Affinity Types" translate="no">​</a></h3>
<ul>
<li class="">Available:<!-- -->
<ul>
<li class=""><code>requiredDuringSchedulingIgnoredDuringExecution</code></li>
<li class=""><code>preferredDuringSchedulingIgnoredDuringExecution</code></li>
</ul>
</li>
<li class="">Planned:<!-- -->
<ul>
<li class=""><code>requiredDuringSchedulingRequiredDuringExecution</code></li>
</ul>
</li>
</ul>
<p>Two states in the lifecycle of the Pod considering Node Affinity:</p>
<ul>
<li class=""><strong>DuringScheduling</strong> is a state when Pod does not exists and is created for the first time. If <em>reqired</em> then a node with specified lable must exist in order the Pod to be scheduled.</li>
<li class=""><strong>DuringExecution</strong> is a state where the Pod is running and the change made in environment which affects Node Affinity, e.g. change in the label of the Node. If <em>ignored</em>, the Pod will continue running if node label is changed or removed.</li>
</ul>
<p>Read <a href="https://kubernetes.io/docs/concepts/scheduling-eviction/assign-pod-node/#node-affinity" target="_blank" rel="noopener noreferrer" class="">more.</a></p>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="65-taints-and-tolerations-vs-node-affinity">6.5. Taints and Tolerations vs Node Affinity<a href="#65-taints-and-tolerations-vs-node-affinity" class="hash-link" aria-label="Direct link to 6.5. Taints and Tolerations vs Node Affinity" title="Direct link to 6.5. Taints and Tolerations vs Node Affinity" translate="no">​</a></h2>
<p><strong>Taints and Tolerations</strong>: Taints are applied to nodes to repel certain pods unless those pods have matching tolerations. This mechanism is useful for reserving nodes for specific workloads.
<strong>Node Affinity</strong>: Node affinity allows you to specify rules based on node labels that determine which nodes a pod can be scheduled on. It helps ensure that pods are placed on nodes with specific characteristics.</p>
<ul>
<li class="">Taints and Tolerations do not guarantee that the pods will only prefer these nodes.</li>
<li class="">As such, a combination of taints and tolerations and node affinity rules can be used together to completely dedicate nodes for specific parts.</li>
</ul>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="66-resource-requirements-and-limits">6.6. Resource Requirements and Limits<a href="#66-resource-requirements-and-limits" class="hash-link" aria-label="Direct link to 6.6. Resource Requirements and Limits" title="Direct link to 6.6. Resource Requirements and Limits" translate="no">​</a></h2>
<blockquote>
<p><strong>Note</strong>: Requests and Limits for resources are set per container in the pod.</p>
</blockquote>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="661-default-behaviour">6.6.1. Default Behaviour<a href="#661-default-behaviour" class="hash-link" aria-label="Direct link to 6.6.1. Default Behaviour" title="Direct link to 6.6.1. Default Behaviour" translate="no">​</a></h3>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="662-resource-requests">6.6.2. Resource Requests<a href="#662-resource-requests" class="hash-link" aria-label="Direct link to 6.6.2. Resource Requests" title="Direct link to 6.6.2. Resource Requests" translate="no">​</a></h3>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: Pod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> name: nginx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> labels:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name: nginx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> containers:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> - name: nginx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   image: nginx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   ports:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   - containerPort: </span><span class="token number" style="color:#36acaa">8080</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   resources:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     requests:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       memory: </span><span class="token string" style="color:#e3116c">&quot;4Gi&quot;</span><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       cpu: </span><span class="token number" style="color:#36acaa">2</span><span class="token plain">                           </span><span class="token comment" style="color:#999988;font-style:italic"># 1 CPU Count: 1 AWS vCPU, 1 GCP Core, 1 Azure Core, 1 Hyperthread</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="663-resource-limits">6.6.3. Resource Limits<a href="#663-resource-limits" class="hash-link" aria-label="Direct link to 6.6.3. Resource Limits" title="Direct link to 6.6.3. Resource Limits" translate="no">​</a></h3>
<ul>
<li class=""><strong>Limit = Requests</strong> if <code>Request</code> is not defined</li>
</ul>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: Pod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> name: nginx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> labels:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name: nginx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> containers:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> - name: nginx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   image: nginx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   ports:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   - containerPort: </span><span class="token number" style="color:#36acaa">8080</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   resources:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     requests:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       memory: </span><span class="token string" style="color:#e3116c">&quot;4Gi&quot;</span><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       cpu: </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">                           </span><span class="token comment" style="color:#999988;font-style:italic"># 1 CPU Count: 1 AWS vCPU, 1 GCP Core, 1 Azure Core, 1 Hyperthread</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    limits:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       memory: </span><span class="token string" style="color:#e3116c">&quot;8Gi&quot;</span><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       cpu: </span><span class="token number" style="color:#36acaa">2</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="664-limitrange">6.6.4. LimitRange<a href="#664-limitrange" class="hash-link" aria-label="Direct link to 6.6.4. LimitRange" title="Direct link to 6.6.4. LimitRange" translate="no">​</a></h3>
<ul>
<li class="">Applies in Namespace level (Namespace level object)</li>
<li class=""></li>
</ul>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># LimitRange CPU</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: LimitRange</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name: cpu-resource-constraint</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  limits:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - default: </span><span class="token comment" style="color:#999988;font-style:italic"># this section defines default limits</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      cpu: 500m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    defaultRequest: </span><span class="token comment" style="color:#999988;font-style:italic"># this section defines default requests</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      cpu: 500m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    max: </span><span class="token comment" style="color:#999988;font-style:italic"># max and min define the limit range</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      cpu: </span><span class="token string" style="color:#e3116c">&quot;1&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    min:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      cpu: 100m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    type: Container</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># LimitRange Memory</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: LimitRange</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name: memory-resource-constraint</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  limits:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - default:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      memory: 1Gi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    defaultRequest:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      memory: 1Gi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    max: </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      memory: 1Gi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    min:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      memory: 500Mi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    type: Container</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="665-resourcequota">6.6.5. ResourceQuota<a href="#665-resourcequota" class="hash-link" aria-label="Direct link to 6.6.5. ResourceQuota" title="Direct link to 6.6.5. ResourceQuota" translate="no">​</a></h3>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: ResourceQuota</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name: my-resource-quota</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  hard:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    requests.cpu: </span><span class="token number" style="color:#36acaa">4</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    requests.memory: 4Gi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    limit.cpu: </span><span class="token number" style="color:#36acaa">10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    limit.memory: 10Gi</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="67-deamonsets">6.7. DeamonSets<a href="#67-deamonsets" class="hash-link" aria-label="Direct link to 6.7. DeamonSets" title="Direct link to 6.7. DeamonSets" translate="no">​</a></h2>
<ul>
<li class="">DeamonSet ensures that one copy of pod is present in all nodes of cluster</li>
<li class="">Similar to <code>ReplicaSet</code> but deployes a pod on each nodes</li>
<li class="">A pod is deployed on new node and removed when node is removed</li>
<li class="">Use cases<!-- -->
<ul>
<li class="">Monitoring solution</li>
<li class="">Logs Viewer</li>
<li class="">Examples:<!-- -->
<ul>
<li class="">kube-proxy</li>
<li class="">weave-net (networking solution)</li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># deamon-set-definition.yaml</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> apps/v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> DeamonSet</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> monitoring</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">deamon</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">selector</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">matchLabels</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">app</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> monitoring</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">agent</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">template</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">labels</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">app</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> monitoring</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">agent</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">containers</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> monitoring</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">agent</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> monitoring</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">agent</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="68-static-pods">6.8. Static Pods<a href="#68-static-pods" class="hash-link" aria-label="Direct link to 6.8. Static Pods" title="Direct link to 6.8. Static Pods" translate="no">​</a></h2>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="681-what-is-static-pods">6.8.1. What is Static Pods<a href="#681-what-is-static-pods" class="hash-link" aria-label="Direct link to 6.8.1. What is Static Pods" title="Direct link to 6.8.1. What is Static Pods" translate="no">​</a></h3>
<ul>
<li class=""><code>Static Pods</code> are pods with <code>kubelet</code> without <code>kube-apiserver</code> or other k8s control plain components</li>
<li class=""><code>kubelet</code> can manage pod independently from <code>kube-apiserver</code></li>
<li class="">Pod definition files must be provided to <code>kubelet</code> manually by putting them into <code>/etc/kubernetes/manifests</code> directory designated to store information about pods</li>
<li class=""><code>kubelet</code> periodically checks <code>/etc/kubernetes/manifests</code></li>
<li class=""><code>kubelet</code> creates a pod and makes sure it stays alive and removes pods if definition file is removed from manifests directory</li>
<li class="">On <code>Static Pods</code> <code>kubelet</code> works in pod level and it is not possible to create <code>ReplicaSets</code>, <code>Deployments</code> or <code>Services</code> by copying definition files into manifest directory as it requires other control plane components, such as <code>replication</code>, <code>deployment-controller</code> etc.</li>
<li class=""><code>--pod-manifest-path=/etc/kubernetes/manifests</code> flag or <code>--config=kubeconfig.yaml with content: staticPodPath: /etc/kubernetes/manifests</code> is used to set a designated directory to be scanned by <code>kubelet</code></li>
<li class="">Check running containers with: (i: no <code>kubectrl</code> util as <code>kube-apiserver</code> not available)<!-- -->
<ul>
<li class=""><code>docker ps</code> for <code>Docker</code></li>
<li class=""><code>crictl ps</code> for <code>cri-o</code></li>
<li class=""><code>nerdctl ps</code> for <code>containerd</code></li>
</ul>
</li>
</ul>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="682-static-pods-in-cluster">6.8.2. Static Pods in Cluster<a href="#682-static-pods-in-cluster" class="hash-link" aria-label="Direct link to 6.8.2. Static Pods in Cluster" title="Direct link to 6.8.2. Static Pods in Cluster" translate="no">​</a></h3>
<ul>
<li class=""><code>kubelet</code> takes requests to create pod from different inputs:<!-- -->
<ul>
<li class="">from definition file from static pod folder</li>
<li class="">from http api endpoint (i.e. from <code>kube-apiserver</code>)</li>
</ul>
</li>
<li class=""><code>kubectl get pods</code> will also list pods created statically but they can NOT be edited, deleted etc. from <code>kube-apiserver</code></li>
<li class="">Static pods can be recognized by their name where node name is appended to it</li>
</ul>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="683-static-pods-use-case">6.8.3. Static Pods Use Case<a href="#683-static-pods-use-case" class="hash-link" aria-label="Direct link to 6.8.3. Static Pods Use Case" title="Direct link to 6.8.3. Static Pods Use Case" translate="no">​</a></h3>
<ul>
<li class="">To deploy Control Plane components as Static Pods. E.g. <code>kubeadm</code> tool uses a mechanist of Static Pods to create a k8s cluster. E.g. by just putting <code>controller-manager.yaml</code>, <code>apiserver.yaml</code>, <code>etcd.yaml</code> into static pod folder and the k8s control plane components will be started as pods</li>
</ul>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="684-static-pods-vs-daemonsets">6.8.4. Static Pods vs. DaemonSets<a href="#684-static-pods-vs-daemonsets" class="hash-link" aria-label="Direct link to 6.8.4. Static Pods vs. DaemonSets" title="Direct link to 6.8.4. Static Pods vs. DaemonSets" translate="no">​</a></h3>
<table><thead><tr><th>Static Pods</th><th>DaemonSets</th></tr></thead><tbody><tr><td>Created by kubelet</td><td>Created kube-apiserver (DaemonSet Controller)</td></tr><tr><td>Deploy Control Plane components as Static Pods</td><td>Deploy Monitoring Agents, Logging Agents on nodes</td></tr><tr><td>Ignored by kube-scheduler</td><td>Ignored by kube-scheduler</td></tr></tbody></table>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="69-multiple-schedulers">6.9. Multiple Schedulers<a href="#69-multiple-schedulers" class="hash-link" aria-label="Direct link to 6.9. Multiple Schedulers" title="Direct link to 6.9. Multiple Schedulers" translate="no">​</a></h2>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="610-configuring-scheduler-profiles">6.10. Configuring Scheduler Profiles<a href="#610-configuring-scheduler-profiles" class="hash-link" aria-label="Direct link to 6.10. Configuring Scheduler Profiles" title="Direct link to 6.10. Configuring Scheduler Profiles" translate="no">​</a></h2>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="611-admission-controllers">6.11. Admission Controllers<a href="#611-admission-controllers" class="hash-link" aria-label="Direct link to 6.11. Admission Controllers" title="Direct link to 6.11. Admission Controllers" translate="no">​</a></h2>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="612-validating-and-mutating-admission-controllers">6.12. Validating and Mutating Admission Controllers<a href="#612-validating-and-mutating-admission-controllers" class="hash-link" aria-label="Direct link to 6.12. Validating and Mutating Admission Controllers" title="Direct link to 6.12. Validating and Mutating Admission Controllers" translate="no">​</a></h2>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="6121-validating-admission-controllers">6.12.1. Validating Admission Controllers<a href="#6121-validating-admission-controllers" class="hash-link" aria-label="Direct link to 6.12.1. Validating Admission Controllers" title="Direct link to 6.12.1. Validating Admission Controllers" translate="no">​</a></h3>
<ul>
<li class="">Validates the request and allow/deny it</li>
</ul>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="6122-mutating-admission-controller">6.12.2. Mutating Admission Controller<a href="#6122-mutating-admission-controller" class="hash-link" aria-label="Direct link to 6.12.2. Mutating Admission Controller" title="Direct link to 6.12.2. Mutating Admission Controller" translate="no">​</a></h3>
<ul>
<li class="">Mutates/Changes object before it is created (e.g. <code>DefaultStorageClass</code>)</li>
</ul>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="6123-custom-validatingmutating-admission-controllers">6.12.3. Custom Validating/Mutating Admission Controllers<a href="#6123-custom-validatingmutating-admission-controllers" class="hash-link" aria-label="Direct link to 6.12.3. Custom Validating/Mutating Admission Controllers" title="Direct link to 6.12.3. Custom Validating/Mutating Admission Controllers" translate="no">​</a></h3>
<ul>
<li class="">
<p><code>MutatingAdmissionWebhook</code></p>
</li>
<li class="">
<p><code>ValidatingAdmissionWebhook</code></p>
</li>
<li class="">
<p>Webhooks above will reference <code>Admission Webhook Server</code> with custom logic</p>
</li>
</ul>
<h1>7. Logging and Monitoring</h1>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="71-monitor-cluster-components">7.1. Monitor Cluster Components<a href="#71-monitor-cluster-components" class="hash-link" aria-label="Direct link to 7.1. Monitor Cluster Components" title="Direct link to 7.1. Monitor Cluster Components" translate="no">​</a></h2>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="711-tools">7.1.1. Tools<a href="#711-tools" class="hash-link" aria-label="Direct link to 7.1.1. Tools" title="Direct link to 7.1.1. Tools" translate="no">​</a></h3>
<ul>
<li class="">Prometheus</li>
<li class="">DataDog</li>
<li class="">Elastic Stack</li>
<li class="">Dynatrace</li>
<li class="">Mentics Server: in-memory solution without storing data option.<!-- -->
<ul>
<li class=""><code>kubelet</code> contains sub-component called <code>cAdvisor</code> (i.e. container advisor) responsible for retrieving performance metrics and exposing them through <code>kubelet</code> API for Metrics Server.</li>
<li class="">Enable Metrics Service:<!-- -->
<ul>
<li class=""><code>git clone https://github.com/kubernetes-incubator/metrics-server.git &amp; kubectl create -f deploy/1.8+</code></li>
</ul>
</li>
<li class="">Cluster Performance view:<!-- -->
<ul>
<li class=""><code>kubectl top node</code></li>
<li class=""><code>kubectl top pod</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="72-managing-application-logs">7.2. Managing Application Logs<a href="#72-managing-application-logs" class="hash-link" aria-label="Direct link to 7.2. Managing Application Logs" title="Direct link to 7.2. Managing Application Logs" translate="no">​</a></h2>
<h1>8. Application Lifecycle Management</h1>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="81-rolling-updates-and-rollbacks">8.1. Rolling Updates and Rollbacks<a href="#81-rolling-updates-and-rollbacks" class="hash-link" aria-label="Direct link to 8.1. Rolling Updates and Rollbacks" title="Direct link to 8.1. Rolling Updates and Rollbacks" translate="no">​</a></h2>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="811-deployment-strategy">8.1.1. Deployment Strategy<a href="#811-deployment-strategy" class="hash-link" aria-label="Direct link to 8.1.1. Deployment Strategy" title="Direct link to 8.1.1. Deployment Strategy" translate="no">​</a></h3>
<ul>
<li class="">Recreate: destroy all and create all</li>
<li class="">Rolling Update: destroy and create one-by-one (DEFAULT Deployment Strategy)</li>
</ul>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="82-configure-applications">8.2. Configure Applications<a href="#82-configure-applications" class="hash-link" aria-label="Direct link to 8.2. Configure Applications" title="Direct link to 8.2. Configure Applications" translate="no">​</a></h2>
<ul>
<li class="">Configuring Command and Arguments on applications</li>
<li class="">Configure Environment Variables</li>
<li class="">Configure Secrets</li>
</ul>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="821-commands-and-arguments-in-docker-and-k8s">8.2.1. Commands and Arguments in Docker and K8s<a href="#821-commands-and-arguments-in-docker-and-k8s" class="hash-link" aria-label="Direct link to 8.2.1. Commands and Arguments in Docker and K8s" title="Direct link to 8.2.1. Commands and Arguments in Docker and K8s" translate="no">​</a></h3>
<ul>
<li class="">Read <a href="https://docs.docker.com/reference/dockerfile/#cmd" target="_blank" rel="noopener noreferrer" class="">more</a></li>
<li class="">Containers (unlike VMs) are not meant to host OS, but run specific process.</li>
</ul>
<div class="language-Dockerfile language-dockerfile codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dockerfile codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">FROM nginx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ENTRYPOINT [&quot;sleep&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CMD [&quot;5&quot;]</span><br></span></code></pre></div></div>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Pod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> nginx</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">sleeper</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">pod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">containers</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> nginx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> nginx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token key atrule" style="color:#00a4db">command</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;sleep&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">                    </span><span class="token comment" style="color:#999988;font-style:italic"># Overrides executables ENTRYPOINT in Dockerfile</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token key atrule" style="color:#00a4db">args</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;10&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">                          </span><span class="token comment" style="color:#999988;font-style:italic"># Overrides CMD defined after ENTRYPOINT as arguments in Dockerfile</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="822-configuring-environment-variables-in-applications">8.2.2. Configuring Environment Variables in Applications<a href="#822-configuring-environment-variables-in-applications" class="hash-link" aria-label="Direct link to 8.2.2. Configuring Environment Variables in Applications" title="Direct link to 8.2.2. Configuring Environment Variables in Applications" translate="no">​</a></h3>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Pod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> envar</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">containers</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> envar</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">demo</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">container</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> nginx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">env</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> MY_VAR</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">value</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;My Value&quot;</span><br></span></code></pre></div></div>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># ENV Value Types</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 1. Plain Key Value</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">env</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> MY_VAR</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">value</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;My Value&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 2. ConfigMap</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">env</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> MY_VAR</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">valueFrom</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">configMapKeyRef</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 3. Secrets</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">env</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> MY_VAR</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">valueFrom</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">secretKeyRef</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">...</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="823-configuring-configmaps-in-applications">8.2.3. Configuring ConfigMaps in Applications<a href="#823-configuring-configmaps-in-applications" class="hash-link" aria-label="Direct link to 8.2.3. Configuring ConfigMaps in Applications" title="Direct link to 8.2.3. Configuring ConfigMaps in Applications" translate="no">​</a></h3>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ConfigMap</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> configmap</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">data</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># property-like keys; each key maps to a simple value</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">player_initial_lives</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;3&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">ui_properties_file_name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;user-interface.properties&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># file-like keys</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">game.properties</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">|</span><span class="token scalar string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">    enemy.types=aliens,monsters</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">    player.maximum-lives=5    </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">user-interface.properties</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">|</span><span class="token scalar string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">    color.good=purple</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">    color.bad=yellow</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">    allow.textmode=true  </span><br></span></code></pre></div></div>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Pod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> env</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">configmap</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">containers</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> app</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">command</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;/bin/sh&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;-c&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;printenv&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> busybox</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">envFrom</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">configMapRef</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> configmap</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">demo</span><br></span></code></pre></div></div>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># ConfigMaps in Pods</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 1. ENV</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">envFrom</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">configMapRef</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> app</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">config</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 2. SINGLE ENV</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">env</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> APP_COLOR</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">valueFrom</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">configMapKeyRef</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> app</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">config</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">key</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> APP_COLOR</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 3. VOLUME</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">volumes</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> app</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">config</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">value</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">configMap</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> app</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">config</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="824-configure-secrets-an-applications">8.2.4. Configure Secrets an Applications<a href="#824-configure-secrets-an-applications" class="hash-link" aria-label="Direct link to 8.2.4. Configure Secrets an Applications" title="Direct link to 8.2.4. Configure Secrets an Applications" translate="no">​</a></h3>
<h4 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="8241-create-secrets">8.2.4.1. Create Secrets<a href="#8241-create-secrets" class="hash-link" aria-label="Direct link to 8.2.4.1. Create Secrets" title="Direct link to 8.2.4.1. Create Secrets" translate="no">​</a></h4>
<ul>
<li class="">Imperative approach - see <a href="#9-commands" class="">Commands</a></li>
<li class="">Declarative approach</li>
</ul>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># kubectl create -f secret-data.yaml</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Secrets are only encoded, NOT Encryped</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># echo -n &#x27;password&#x27; | base64</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># echo -n &#x27;cGFzc3dvcmQ=&#x27; | base64 --decode</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># secret-data.yaml</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Secret</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> app</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">secret</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">data</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">DB_User</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> root</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">DB_Password</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> dmFsdWUtMg0KDQo=</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">---</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Pod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> sapmple</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">secret</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">pod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">containers</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> test</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">container</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> registry.k8s.io/busybox</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">envFrom</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">secretRef</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> app</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">secret                           </span><span class="token comment" style="color:#999988;font-style:italic"># ref to secret name</span><br></span></code></pre></div></div>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Secrets in Pods</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 1. ENV</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">envFrom</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">secretRef</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> app</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">config</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 2. SINGLE ENV</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">env</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> DB_password</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">valueFrom</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">secretKeyRef</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> app</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">secret</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">key</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> DB_password</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 3. VOLUME</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">volumes</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> app</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">secret</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">volume</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">secret</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">secretName</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> app</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">secret</span><br></span></code></pre></div></div>
<h4 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="8242-encrypting-secret-data-at-rest">8.2.4.2. Encrypting Secret Data at Rest<a href="#8242-encrypting-secret-data-at-rest" class="hash-link" aria-label="Direct link to 8.2.4.2. Encrypting Secret Data at Rest" title="Direct link to 8.2.4.2. Encrypting Secret Data at Rest" translate="no">​</a></h4>
<p>Secrets are not encrypted, so it is not safer in that sense. However, some best practices around using secrets make it safer. As in best practices like:</p>
<ul>
<li class="">Not checking-in secret object definition files to source code repositories.</li>
<li class="">Enabling Encryption at Rest for Secrets so they are stored encrypted in ETCD.<!-- -->
<ul>
<li class="">Read more about <a href="https://kubernetes.io/docs/tasks/administer-cluster/encrypt-data/" target="_blank" rel="noopener noreferrer" class="">Encrypting Confidential Data at Rest</a></li>
<li class="">Or <a href="https://www.youtube.com/watch?v=MTnQW9MxnRI" target="_blank" rel="noopener noreferrer" class="">here</a></li>
</ul>
</li>
</ul>
<h4 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="8243-secret-store-providers">8.2.4.3. Secret Store Providers<a href="#8243-secret-store-providers" class="hash-link" aria-label="Direct link to 8.2.4.3. Secret Store Providers" title="Direct link to 8.2.4.3. Secret Store Providers" translate="no">​</a></h4>
<ul>
<li class="">Third-party secrets store providers: AWS Provider, Azure Provider, GCP Provider, Vault Provider (HashiCorp Vault)</li>
<li class="">Helm Secrets plugin</li>
</ul>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="83-scale-applications">8.3. Scale Applications<a href="#83-scale-applications" class="hash-link" aria-label="Direct link to 8.3. Scale Applications" title="Direct link to 8.3. Scale Applications" translate="no">​</a></h2>
<ul>
<li class="">See <a href="#81-rolling-updates-and-rollbacks" class="">Deployments, Rolling updates and Rollback section</a></li>
</ul>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="84-multi-container-pods">8.4. Multi Container Pods<a href="#84-multi-container-pods" class="hash-link" aria-label="Direct link to 8.4. Multi Container Pods" title="Direct link to 8.4. Multi Container Pods" translate="no">​</a></h2>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># pod-definition.yaml</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Pod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> nginx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">containers</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> nginx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> nginx</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">1.14.2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">ports</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">containerPort</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> nginx</span><span class="token punctuation" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> nginx</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">1.14.2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">ports</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">containerPort</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">81</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="841-multi-container-pods-design-patterns">8.4.1. Multi-container Pods Design Patterns<a href="#841-multi-container-pods-design-patterns" class="hash-link" aria-label="Direct link to 8.4.1. Multi-container Pods Design Patterns" title="Direct link to 8.4.1. Multi-container Pods Design Patterns" translate="no">​</a></h3>
<ul>
<li class="">Sidecar (e.g. service and logging containers)</li>
<li class="">Adapter</li>
<li class="">Ambassador</li>
</ul>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="85-initcontainers">8.5. InitContainers<a href="#85-initcontainers" class="hash-link" aria-label="Direct link to 8.5. InitContainers" title="Direct link to 8.5. InitContainers" translate="no">​</a></h2>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># pod-definition.yaml</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># initContainer must run to a completion before the real container hosting the application starts. </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Pod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> myapp</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">pod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">labels</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">app</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> myapp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">containers</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> myapp</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">container</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> busybox</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">1.28</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">command</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;sh&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;-c&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;echo The app is running! &amp;&amp; sleep 3600&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">initContainers</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> init</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">myservice</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> busybox</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">command</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;sh&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;-c&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;git clone &lt;some-repository-that-will-be-used-by-application&gt; ; done;&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="86-self-healing-applications">8.6. Self Healing Applications<a href="#86-self-healing-applications" class="hash-link" aria-label="Direct link to 8.6. Self Healing Applications" title="Direct link to 8.6. Self Healing Applications" translate="no">​</a></h2>
<p>Kubernetes supports self-healing applications through ReplicaSets and Replication Controllers. The replication controller helps in ensuring that a POD is re-created automatically when the application within the POD crashes.</p>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="87-intro-to-autoscaling">8.7. Intro to Autoscaling<a href="#87-intro-to-autoscaling" class="hash-link" aria-label="Direct link to 8.7. Intro to Autoscaling" title="Direct link to 8.7. Intro to Autoscaling" translate="no">​</a></h2>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="871-scaling-cluster-infra-vs-scaling-workloads">8.7.1. Scaling Cluster Infra vs Scaling Workloads<a href="#871-scaling-cluster-infra-vs-scaling-workloads" class="hash-link" aria-label="Direct link to 8.7.1. Scaling Cluster Infra vs Scaling Workloads" title="Direct link to 8.7.1. Scaling Cluster Infra vs Scaling Workloads" translate="no">​</a></h3>
<ul>
<li class=""><strong>Scaling Cluster Infra</strong> by increasing number of nodes horizontally or increasing size of resources (CPU, RAM) on existing node</li>
<li class=""><strong>Scaling Workloads</strong> by increasing the number of pods horizontally or increase resources allocated to existing pods</li>
</ul>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="872-manual-vs-automated-scaling">8.7.2. Manual vs Automated Scaling<a href="#872-manual-vs-automated-scaling" class="hash-link" aria-label="Direct link to 8.7.2. Manual vs Automated Scaling" title="Direct link to 8.7.2. Manual vs Automated Scaling" translate="no">​</a></h3>
<ul>
<li class=""><strong>Manual Scaling</strong> of<!-- -->
<ul>
<li class="">Cluster Infra:<!-- -->
<ul>
<li class="">Horizontally: <code>kubeadm join ...</code></li>
<li class="">Vertically: rare</li>
</ul>
</li>
<li class="">Workloads:<!-- -->
<ul>
<li class="">Horizontally: <code>kubectl scale ...</code></li>
<li class="">Vertically: <code>kubectl edit ...</code></li>
</ul>
</li>
</ul>
</li>
<li class=""><strong>Automatied Scaling</strong> of<!-- -->
<ul>
<li class="">Cluster Infra:<!-- -->
<ul>
<li class=""><strong>Cluster Autoscaler</strong></li>
</ul>
</li>
<li class="">Workloads:<!-- -->
<ul>
<li class=""><a href="#88-horizontal-pod-autoscaler-hpa" class="">Horizontal Pod Autoscaler (HPA)</a></li>
<li class=""><a href="#89-vertical-pod-autoscaling-vpa" class="">Vertical Pod Autoscaler (VPA)</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="873-horizontal-pod-autoscaler-hpa">8.7.3. Horizontal Pod Autoscaler (HPA)<a href="#873-horizontal-pod-autoscaler-hpa" class="hash-link" aria-label="Direct link to 8.7.3. Horizontal Pod Autoscaler (HPA)" title="Direct link to 8.7.3. Horizontal Pod Autoscaler (HPA)" translate="no">​</a></h3>
<ul>
<li class="">Increate the running instances of application horizontally</li>
<li class="">HPA relies on<!-- -->
<ul>
<li class=""><strong>Metrics Server</strong> or <strong>Custom Metrics Adapter</strong> for <em>internal sources</em></li>
<li class=""><strong>External Adapter</strong> for e.g. DataDog, Dynatrace etc.</li>
</ul>
</li>
</ul>
<h4 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="8731-scaling-a-workload-manually">8.7.3.1. Scaling a workload manually<a href="#8731-scaling-a-workload-manually" class="hash-link" aria-label="Direct link to 8.7.3.1. Scaling a workload manually" title="Direct link to 8.7.3.1. Scaling a workload manually" translate="no">​</a></h4>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Manually check the load and increase replicas</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl </span><span class="token function" style="color:#d73a49">top</span><span class="token plain"> pod my-app-pod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl scale deployment my-app </span><span class="token parameter variable" style="color:#36acaa">--replicas</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">3</span><br></span></code></pre></div></div>
<h4 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="8732-hpa">8.7.3.2. HPA<a href="#8732-hpa" class="hash-link" aria-label="Direct link to 8.7.3.2. HPA" title="Direct link to 8.7.3.2. HPA" translate="no">​</a></h4>
<p>HPA:</p>
<ul>
<li class="">Observes metrics</li>
<li class="">Adds pods</li>
<li class="">Balances thresholds</li>
<li class="">Tracks multiple metrics</li>
</ul>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># IMPERATIVE: Create HPA for specific deployment</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl autoscale deployment my-app </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          --cpu-percent</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">50</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">--min</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">--max</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">10</span><span class="token plain">                       </span><span class="token comment" style="color:#999988;font-style:italic"># CPU thresholds of 50% and min 1 pod and max 10 pods</span><br></span></code></pre></div></div>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># DECLARATIVE: Create HPA for specific deployment</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> autoscaling/v2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> HorizontalPodAutoscaler</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> php</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">apache</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">scaleTargetRef</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> apps/v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Deployment</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> my</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">app</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">minReplicas</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">maxReplicas</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">metrics</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Resource</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">resource</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> cpu</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">target</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Utilization</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">averageUtilization</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">50</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="874-vertical-pod-autoscaling-vpa">8.7.4. Vertical Pod Autoscaling (VPA)<a href="#874-vertical-pod-autoscaling-vpa" class="hash-link" aria-label="Direct link to 8.7.4. Vertical Pod Autoscaling (VPA)" title="Direct link to 8.7.4. Vertical Pod Autoscaling (VPA)" translate="no">​</a></h3>
<ul>
<li class="">Manual:<!-- -->
<ul>
<li class=""><code>kubectl edit deployment my-app</code> and manually change resources</li>
</ul>
</li>
<li class="">VPA:<!-- -->
<ul>
<li class="">Observe metrics</li>
<li class="">Adjust pod resources: e.g. increase the size of resources vertically, such as CPU, RAM</li>
<li class="">Balances threshold</li>
</ul>
</li>
</ul>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;autoscaling.k8s.io/v1&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> VerticalPodAutoscaler</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> stress</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">vpa</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">targetRef</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;apps/v1&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Deployment</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> high</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">cpu</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">utilization</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">deployment</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">updatePolicy</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">updateMode</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Auto                </span><span class="token comment" style="color:#999988;font-style:italic"># Modes: Off, Initial, Recreate and Auto         </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">resourcePolicy</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">containerPolicies</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">containerName</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;*&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">minAllowed</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">cpu</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 100m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">memory</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 50Mi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">maxAllowed</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">cpu</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 200m                 </span><span class="token comment" style="color:#999988;font-style:italic"># maximum vpa will be allocating this many cpus even if demand is higher.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">memory</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 500Mi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">controlledResources</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;cpu&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;memory&quot;</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre></div></div>
<h4 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="8741-deployment-of-vpa-components">8.7.4.1. Deployment of VPA Components<a href="#8741-deployment-of-vpa-components" class="hash-link" aria-label="Direct link to 8.7.4.1. Deployment of VPA Components" title="Direct link to 8.7.4.1. Deployment of VPA Components" translate="no">​</a></h4>
<ul>
<li class="">VPA does NOT come built-in with K8s, but must be deployed<!-- -->
<ul>
<li class=""><code>kubectl apply -f https://github.com/kubernetes/autoscaler/releases/latest/download/vertical-pod-autoscaler.yaml</code></li>
</ul>
</li>
<li class="">VPA includes following pods:<!-- -->
<ul>
<li class=""><code>vpa recommender</code> - continuously monitoring resource usage from Metrics Server and provides recommendation for optimal cpu, ram values</li>
<li class=""><code>vpa updater</code> - get an information from recommender and evicts pods needed to be updated with recommended resources</li>
<li class=""><code>vpa admission controller</code> - controller then creates new pod with new resources values recommended</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="875-in-place-resize-pods">8.7.5. In-place resize Pods<a href="#875-in-place-resize-pods" class="hash-link" aria-label="Direct link to 8.7.5. In-place resize Pods" title="Direct link to 8.7.5. In-place resize Pods" translate="no">​</a></h3>
<ul>
<li class="">As of kubernetes version 1.32, if the resource definition parameter is changed, the default behaviour is delete running instance of pod and spin up a new pod with changes</li>
<li class=""><strong>InPlacePodVerticalScaling:</strong> Resize CPU and Memory Resources assigned to Containers without restart<!-- -->
<ul>
<li class="">FEATURE STATE: K8s v1.27 [alpha][enabled by default<!-- -->:false<!-- -->]</li>
<li class="">Enable feature: <code>FEaTURE_GATES:InPlacePodVerticalScaling=true</code></li>
</ul>
</li>
</ul>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Pod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> resize</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">containers</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> pause</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> registry.k8s.io/pause</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">3.8</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">resizePolicy</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">resourceName</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> cpu</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">restartPolicy</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> NotRequired                   </span><span class="token comment" style="color:#999988;font-style:italic"># Default, but explicit here</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">resourceName</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> memory</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">restartPolicy</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> RestartContainer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">resources</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">limits</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">memory</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;200Mi&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">cpu</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;700m&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">requests</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">memory</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;200Mi&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">cpu</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;700m&quot;</span><br></span></code></pre></div></div>
<h4 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="8751-limitations">8.7.5.1. Limitations<a href="#8751-limitations" class="hash-link" aria-label="Direct link to 8.7.5.1. Limitations" title="Direct link to 8.7.5.1. Limitations" translate="no">​</a></h4>
<ul>
<li class="">Only CPU and Memory resources can be changed</li>
<li class="">Pod QoS Class cannot change</li>
<li class="">InitContainers and Ephemeral COntainers cannot be resized</li>
<li class="">Resource requests and limits cannot be removed once set</li>
<li class="">A container&#x27;s memor limit may not be reduced below its usage. If a request pts a container in this state, the resize status will remain in InProgress until the resired memory limit becomes feasible.</li>
</ul>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="876-vpa-vs-hpa">8.7.6. VPA vs. HPA<a href="#876-vpa-vs-hpa" class="hash-link" aria-label="Direct link to 8.7.6. VPA vs. HPA" title="Direct link to 8.7.6. VPA vs. HPA" translate="no">​</a></h3>
<table><thead><tr><th>Feature</th><th>VPA (Vertical Scaling)</th><th>HPA (Horizontal Scaling)</th></tr></thead><tbody><tr><td>Scaling Method</td><td>Increase CPU &amp; memory of existing Pods</td><td>Adds/Removes Pods based on load</td></tr><tr><td>Pods Behavior</td><td>Restarts Pods to apply new resource values</td><td>Keeps existing Pods running</td></tr><tr><td>Handles Traffic Spikes?</td><td>NO, because scaling requires a Pod restart</td><td>YES, instantly adds more Pods</td></tr><tr><td>Optimizes Costs?</td><td>Prevents over-provisioning of CPU/RAM</td><td>Avoids unnecessary idle Pods</td></tr><tr><td>Best for</td><td>Stateful workloads, CPU/RAM-heavy apps</td><td>Stateless services, web apps, microservices</td></tr><tr><td>Use cases</td><td>DBs, JVM-baseds apps, AI/ML workloads</td><td>Web servers (Nginx, API services), message queues, microservices</td></tr></tbody></table>
<h1>9. Cluster Maintenance</h1>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="91-os-upgrade">9.1. OS Upgrade<a href="#91-os-upgrade" class="hash-link" aria-label="Direct link to 9.1. OS Upgrade" title="Direct link to 9.1. OS Upgrade" translate="no">​</a></h2>
<ul>
<li class="">Drain and cordon nodes (see Command section)</li>
<li class="">Uncordon nodes (see Command section)</li>
</ul>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="92-kubernetes-software-versions">9.2. Kubernetes Software Versions<a href="#92-kubernetes-software-versions" class="hash-link" aria-label="Direct link to 9.2. Kubernetes Software Versions" title="Direct link to 9.2. Kubernetes Software Versions" translate="no">​</a></h2>
<p>Kubernetes version 1.27</p>
<ul>
<li class="">kube-apiserver: v1.27.0</li>
<li class="">kube-scheduler: v1.27.0</li>
<li class="">kube-controller-manager: v1.27.0</li>
<li class="">kubelet: v1.27.0</li>
<li class="">kube-proxy: v1.27.0</li>
<li class="">etcd: v3.5.7 (or similar, depending on the Kubernetes version)</li>
<li class="">coredns: v1.10.1 (or similar, depending on the Kubernetes version)</li>
<li class="">container runtime: Versions can vary (e.g., containerd v1.6.0 or Docker v20.10.0)</li>
</ul>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="93-cluster-upgrade-process">9.3. Cluster Upgrade Process<a href="#93-cluster-upgrade-process" class="hash-link" aria-label="Direct link to 9.3. Cluster Upgrade Process" title="Direct link to 9.3. Cluster Upgrade Process" translate="no">​</a></h2>
<ul>
<li class="">
<p>Kubenrnetes Supports only 3 last versions</p>
</li>
<li class="">
<p>It is recommended to upgrade one MINOR version at a time.</p>
</li>
<li class="">
<p>Upgrade possibilies of different versions.</p>
<ul>
<li class="">kube-apiserver: vX</li>
</ul>
<hr>
<ul>
<li class="">kube-controller-manager: vX-1</li>
<li class="">kube-scheduler: vX-1</li>
</ul>
<hr>
<ul>
<li class="">kubelet: vX-2</li>
<li class="">kube-proxy: vX-2</li>
</ul>
<hr>
<ul>
<li class="">kubectl: vX+1, vX, vX-1</li>
</ul>
</li>
<li class="">
<p>Upgrade using <code>kubeadm</code></p>
<ul>
<li class=""><code>kubeadm upgrade plan</code></li>
<li class=""><code>kubeadm upgrade apply</code></li>
</ul>
</li>
<li class="">
<p>Upgrade Sequence:</p>
<ul>
<li class="">First Master Node</li>
<li class="">Then Worker Nodes</li>
</ul>
</li>
<li class="">
<p>Upgrade Strategies of Worker Nodes</p>
<ul>
<li class="">Upgrade ALL of Worker Nodes at once</li>
<li class="">Upgrade ONE node as a time</li>
<li class="">Add NEW node with new k8s version. I.e. provision new nodes and decomission old one.</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="931-kubeadm-upgrade">9.3.1. <code>kubeadm upgrade</code><a href="#931-kubeadm-upgrade" class="hash-link" aria-label="Direct link to 931-kubeadm-upgrade" title="Direct link to 931-kubeadm-upgrade" translate="no">​</a></h3>
<p>Upgrade Master Node:</p>
<ul>
<li class=""><code>kubeadm upgrade plan</code>     # <code>kubeadm</code> does not upgrade <code>kubelet</code></li>
<li class=""><code>apt-get upgrade -y kubeadm=1.12.0-00</code></li>
<li class=""><code>kubeadm upgrade apply v1.12.0</code></li>
<li class=""><code>apt-get upgrade -y kubelet=1.12.0-00</code></li>
<li class=""><code>systemctl restart kubelet</code></li>
</ul>
<p>Upgrade Worker Nodes:</p>
<ul>
<li class=""><code>kubectl drain node-1</code></li>
<li class=""><code>apt-get upgrade -y kubeadm=1.12.0-00</code></li>
<li class=""><code>apt-get upgrade -y kubelet=1.12.0-00</code></li>
<li class=""><code>kubeadm upgrade node config --kubelet-version 1.12.0</code></li>
<li class=""><code>systemctl restart kubelet</code></li>
<li class=""><code>kubectl get nodes</code></li>
<li class=""><code>kubectl uncordon node-1</code></li>
</ul>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="932-cluster-upgrade---demo">9.3.2. Cluster Upgrade - Demo<a href="#932-cluster-upgrade---demo" class="hash-link" aria-label="Direct link to 9.3.2. Cluster Upgrade - Demo" title="Direct link to 9.3.2. Cluster Upgrade - Demo" translate="no">​</a></h3>
<ul>
<li class="">Read <a href="https://kubernetes.io/docs/tasks/administer-cluster/kubeadm/kubeadm-upgrade/" target="_blank" rel="noopener noreferrer" class="">more</a></li>
</ul>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="933-backup-and-restore-methods">9.3.3. Backup and Restore Methods<a href="#933-backup-and-restore-methods" class="hash-link" aria-label="Direct link to 9.3.3. Backup and Restore Methods" title="Direct link to 9.3.3. Backup and Restore Methods" translate="no">​</a></h3>
<h4 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="9331-backup-candidates">9.3.3.1. Backup Candidates<a href="#9331-backup-candidates" class="hash-link" aria-label="Direct link to 9.3.3.1. Backup Candidates" title="Direct link to 9.3.3.1. Backup Candidates" translate="no">​</a></h4>
<ul>
<li class="">Resource Configurations (namespace, configmap, secrets etc.)<!-- -->
<ul>
<li class=""><code>kubectl get all --all-namespaces -o yaml &gt; all-resources.yaml</code></li>
</ul>
</li>
<li class="">ETCD Cluster (Stores information about the state of k8s cluster)<!-- -->
<ul>
<li class="">ETCD Cluster is hosted on Master Nodes</li>
<li class="">ETCD Cluster data dir to backup <code>--data-dir=/var/lib/etcd</code></li>
<li class="">Create a Snapshot of ETCD with<br>
<code>ETCDCTL_API=3 etcdctl snapshot save etcd_snapshot.db</code></li>
<li class="">Restore ETCD from Backup<!-- -->
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">service</span><span class="token plain"> kube-apiserver stop</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">ETCDCTL_API</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">3</span><span class="token plain"> etcdctl snapshot restore etcd_snapshot.db --data-dir /var/lib/etcd-from-backup</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">systemctl daemon-reload</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">service</span><span class="token plain"> etcd restart</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">service</span><span class="token plain"> kube-apiserver start</span><br></span></code></pre></div></div>
</li>
<li class="">Read more about <a href="https://velero.io/docs/v1.15/" target="_blank" rel="noopener noreferrer" class="">backup tools</a></li>
</ul>
</li>
<li class="">Persistence Volumes</li>
</ul>
<h1>10. Security</h1>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="101-kubernetes-security-primitives">10.1. Kubernetes Security Primitives<a href="#101-kubernetes-security-primitives" class="hash-link" aria-label="Direct link to 10.1. Kubernetes Security Primitives" title="Direct link to 10.1. Kubernetes Security Primitives" translate="no">​</a></h2>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="1011-cluster-hosts-security">10.1.1. Cluster Hosts Security<a href="#1011-cluster-hosts-security" class="hash-link" aria-label="Direct link to 10.1.1. Cluster Hosts Security" title="Direct link to 10.1.1. Cluster Hosts Security" translate="no">​</a></h3>
<ul>
<li class="">All access to cluster host must be secured</li>
<li class=""><code>root</code> access disabled</li>
<li class="">Password based authentication disabled</li>
<li class="">SSH Key based authentication enabled</li>
</ul>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="1012-kubernetes-security">10.1.2. Kubernetes Security<a href="#1012-kubernetes-security" class="hash-link" aria-label="Direct link to 10.1.2. Kubernetes Security" title="Direct link to 10.1.2. Kubernetes Security" translate="no">​</a></h3>
<ul>
<li class="">Securing the access to <code>kube-apiserver</code> is the first line of diffence<!-- -->
<ul>
<li class=""><strong>Authentication</strong>, i.e. who can access it?<!-- -->
<ul>
<li class="">Files - Username and Passwords</li>
<li class="">Files - Username and Tokens</li>
<li class="">Certificates</li>
<li class="">External Authentication providers - LDAP</li>
<li class="">Service Accounts</li>
</ul>
</li>
<li class=""><strong>Authorization</strong>, i.e. what can they do?<!-- -->
<ul>
<li class="">RBAC Authorization</li>
<li class="">ABAC Authorization</li>
<li class="">Node Authorization</li>
<li class="">Webhook Mode</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="1013-tls-certificates">10.1.3. TLS Certificates<a href="#1013-tls-certificates" class="hash-link" aria-label="Direct link to 10.1.3. TLS Certificates" title="Direct link to 10.1.3. TLS Certificates" translate="no">​</a></h3>
<ul>
<li class="">All communication between <code>kube-apiserver</code> and</li>
<li class="">ETCD Cluster</li>
<li class="">Kubelet</li>
<li class="">Kube Proxy</li>
<li class="">Kube Scheduler</li>
<li class="">Kube Controller Manager is secured TLS Encryption.</li>
</ul>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="1014-application-communication-within-cluster">10.1.4. Application Communication within Cluster<a href="#1014-application-communication-within-cluster" class="hash-link" aria-label="Direct link to 10.1.4. Application Communication within Cluster" title="Direct link to 10.1.4. Application Communication within Cluster" translate="no">​</a></h3>
<ul>
<li class="">By default all Pods can access other Pods within the Cluster</li>
<li class="">The Pods access by another Pods can be restricted by <a href="#" class="">Network Policies</a></li>
</ul>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="102-authentication">10.2. Authentication<a href="#102-authentication" class="hash-link" aria-label="Direct link to 10.2. Authentication" title="Direct link to 10.2. Authentication" translate="no">​</a></h2>
<ul>
<li class="">Users who may access K8s Cluster<!-- -->
<ul>
<li class="">Users<!-- -->
<ul>
<li class="">Admins</li>
<li class="">Developers</li>
</ul>
</li>
<li class="">Service Accounts<!-- -->
<ul>
<li class="">Bots (CI/CD etc.)</li>
</ul>
</li>
<li class="">Application End Users (Usually managed by Application Authentication Management)</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="1021-users">10.2.1. Users<a href="#1021-users" class="hash-link" aria-label="Direct link to 10.2.1. Users" title="Direct link to 10.2.1. Users" translate="no">​</a></h3>
<p>All user access are managed by <code>kube-apiserver</code> whether access with <code>kubectl</code> or <code>curl https://kube-server-ip:6443/</code> by</p>
<ul>
<li class="">First <strong>Authenticate Users</strong></li>
<li class="">Then <strong>Process Requests</strong></li>
</ul>
<p><code>kube-apiserver</code> Authentication Mechanisms:</p>
<ul>
<li class="">Static Password File (not recommended)</li>
<li class="">Static Token File (not recommended)</li>
<li class="">Certificates</li>
<li class="">Identity Services (e.g. third Party Auth protocol LDAP, Cerberus etc.)</li>
</ul>
<h4 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="10211-basic-authentication-mechanism---static-password-file">10.2.1.1. Basic Authentication Mechanism - Static Password File<a href="#10211-basic-authentication-mechanism---static-password-file" class="hash-link" aria-label="Direct link to 10.2.1.1. Basic Authentication Mechanism - Static Password File" title="Direct link to 10.2.1.1. Basic Authentication Mechanism - Static Password File" translate="no">​</a></h4>
<div class="language-csv codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-csv codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># basic-auth.csv</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">password123,user1,u001,group1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">password123,user2,u002,group2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">password123,user3,u003,group3</span><br></span></code></pre></div></div>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kube-apiserver --basic-auth-file</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">/path/to/basic-auth.csv</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">systemctl restart kube-apiserver</span><br></span></code></pre></div></div>
<p>Then <code>kube-apiserver</code> can be access with</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-v</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-k</span><span class="token plain"> https://master-node-ip:6443/api/v1/pods </span><span class="token parameter variable" style="color:#36acaa">-u</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;user1:password123&quot;</span><br></span></code></pre></div></div>
<h4 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="10212-basic-authentication-mechanism---static-token-file">10.2.1.2. Basic Authentication Mechanism - Static Token File<a href="#10212-basic-authentication-mechanism---static-token-file" class="hash-link" aria-label="Direct link to 10.2.1.2. Basic Authentication Mechanism - Static Token File" title="Direct link to 10.2.1.2. Basic Authentication Mechanism - Static Token File" translate="no">​</a></h4>
<div class="language-csv codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-csv codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># basic-token-auth.csv</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">a3f5c8e1d2b4a6e7,user1,u001,group1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">9b1e2c3d4f5a6b7c,user2,u002,group2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">7e8f9a0b1c2d3e4f,user3,u003,group3</span><br></span></code></pre></div></div>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kube-apiserver --token-auth-file</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">/path/to/basic-token-auth.csv</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">systemctl restart kube-apiserver</span><br></span></code></pre></div></div>
<p>Then <code>kube-apiserver</code> can be access with</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-v</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-k</span><span class="token plain"> https://master-node-ip:6443/api/v1/pods </span><span class="token parameter variable" style="color:#36acaa">--header</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Authorization: Bearer a3f5c8e1d2b4a6e7&quot;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="1022-service-accounts">10.2.2. Service Accounts<a href="#1022-service-accounts" class="hash-link" aria-label="Direct link to 10.2.2. Service Accounts" title="Direct link to 10.2.2. Service Accounts" translate="no">​</a></h3>
<ul>
<li class=""><code>kubectl create serviceaccount sa1</code></li>
</ul>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="103-tls-certificates-in-k8s">10.3. TLS Certificates in K8s<a href="#103-tls-certificates-in-k8s" class="hash-link" aria-label="Direct link to 10.3. TLS Certificates in K8s" title="Direct link to 10.3. TLS Certificates in K8s" translate="no">​</a></h2>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="1031-tls-basics">10.3.1. TLS Basics<a href="#1031-tls-basics" class="hash-link" aria-label="Direct link to 10.3.1. TLS Basics" title="Direct link to 10.3.1. TLS Basics" translate="no">​</a></h3>
<p><strong>Transport Layer Security (TLS)</strong> is primarily associated with securing communications over the internet and it is used in various applications and protocols, like: SSH, HTTPS, Email Protocols(SMTP, IMAP), FPN, FTPS, APIs(RESTful APIs), WebSocket Secure (WSS), DB Connections etc.</p>
<ul>
<li class=""><strong>TLS</strong> certificates are digital certificates that authenticate the identity of a website or server and enable encrypted communication between clients and servers over the internet, ensuring data privacy and integrity during transmission.</li>
<li class=""><strong>Key Pair Generation</strong>: When you create a key pair, a cryptographic algorithm (like RSA or ECC) generates two keys: a private key and a public key. These keys are mathematically linked.</li>
<li class=""><strong>Private Key</strong>: is used to <em>decrypt information</em> or <em>sign data</em> and is kept secret.</li>
<li class=""><strong>Public Key</strong>: is used to <em>encrypt information</em> or <em>verify signatures</em> and can be shared with anyone.</li>
<li class=""><strong>Certificate Signing Request (CSR)</strong>: includes the public key along with information about the entity requesting a certificate (e.g. organization’s name, domain). When you generate a CSR, you create it using your public key.</li>
<li class=""><strong>Certificate (CRT or Digital Certificate)</strong>: contains the public key along with information about the certificate holder (e.g. their identity, domain). It is issued by a Certificate Authority (CA) after verifying the information in the CSR. The CRT allows others to trust that the public key belongs to the entity it claims to represent. I.e. Certificate is so called Validated User ID and Key is Password.</li>
<li class=""><strong>Digital Signature</strong>: When you sign data with your private key, others can use your public key to verify that the signature is valid. This ensures that the data hasn’t been tampered with and confirms the identity of the sender.</li>
<li class=""><strong>Root Certificate</strong> is a special type of digital certificate that belongs to a trusted organization called a Certificate Authority (CA).</li>
<li class=""><strong>Certificate Authority (CA)</strong>: An entity that issues digital certificates, verifying the identity of the certificate holder and ensuring the integrity of the public key.</li>
</ul>
<h4 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="10311-private-vs-public-key">10.3.1.1. Private vs Public Key<a href="#10311-private-vs-public-key" class="hash-link" aria-label="Direct link to 10.3.1.1. Private vs Public Key" title="Direct link to 10.3.1.1. Private vs Public Key" translate="no">​</a></h4>
<ul>
<li class="">Key Pair</li>
<li class="">Data can be encrytped with ANY of them and ONLY decrypted with other</li>
<li class="">Data can NOT be encrypted with one and descrypted with the same key</li>
<li class="">If data is encrypted with Private Key, anyone who has Public Key can decrypt data!</li>
<li class=""><strong>Signing</strong> is done with a private key and <strong>Verification</strong> is done with a public key</li>
<li class=""><strong>Encryption</strong> is done with a public key and <strong>Decryption</strong> is done with a private key</li>
</ul>
<h4 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="10312-symmetric-encryption">10.3.1.2. Symmetric Encryption<a href="#10312-symmetric-encryption" class="hash-link" aria-label="Direct link to 10.3.1.2. Symmetric Encryption" title="Direct link to 10.3.1.2. Symmetric Encryption" translate="no">​</a></h4>
<p>Symmetric encryption is a cryptographic method where the same key is used for both encrypting and decrypting data, ensuring that only parties with the shared key can access the original information.</p>
<h4 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="10313-asymmetric-encryption">10.3.1.3. Asymmetric Encryption<a href="#10313-asymmetric-encryption" class="hash-link" aria-label="Direct link to 10.3.1.3. Asymmetric Encryption" title="Direct link to 10.3.1.3. Asymmetric Encryption" translate="no">​</a></h4>
<p>Asymmetric encryption is a cryptographic method that uses a pair of keys—a public key for encryption and a private key for decryption-allowing secure communication where the public key can be shared openly while the private key remains confidential.</p>
<h4 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="10314-asymmetric-encryption---ssh">10.3.1.4. Asymmetric Encryption - SSH<a href="#10314-asymmetric-encryption---ssh" class="hash-link" aria-label="Direct link to 10.3.1.4. Asymmetric Encryption - SSH" title="Direct link to 10.3.1.4. Asymmetric Encryption - SSH" translate="no">​</a></h4>
<p>Asymmetric encryption in SSH (Secure Shell) uses a pair of keys—a public key and a private key—to secure communications between a client and a server. The public key is shared with the server, while the private key remains confidential on the client.</p>
<h4 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="10315-asymmetric-encryption---https">10.3.1.5. Asymmetric Encryption - HTTPS<a href="#10315-asymmetric-encryption---https" class="hash-link" aria-label="Direct link to 10.3.1.5. Asymmetric Encryption - HTTPS" title="Direct link to 10.3.1.5. Asymmetric Encryption - HTTPS" translate="no">​</a></h4>
<p>In <strong>HTTPS</strong> (Hypertext Transfer Protocol Secure), <strong>both symmetric and asymmetric encryption are used</strong> to secure communications between a web browser and a server:</p>
<ul>
<li class=""><strong>Asymmetric Encryption</strong>: Initially used during the SSL/TLS handshake process to establish a secure connection. The server presents its public key to the client, allowing the client to encrypt a shared secret (session key) that only the server can decrypt with its private key. This ensures that the client is communicating with the legitimate server.</li>
<li class=""><strong>Symmetric Encryption</strong>: Once the secure connection is established and the session key is shared, symmetric encryption is used for the actual data transmission. This is because symmetric encryption is faster and more efficient for encrypting large amounts of data compared to asymmetric encryption.</li>
</ul>
<h4 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="10316-certificate-authority-ca">10.3.1.6. Certificate Authority (CA)<a href="#10316-certificate-authority-ca" class="hash-link" aria-label="Direct link to 10.3.1.6. Certificate Authority (CA)" title="Direct link to 10.3.1.6. Certificate Authority (CA)" translate="no">​</a></h4>
<ul>
<li class="">Public CAs have also Private and Public Keys<!-- -->
<ul>
<li class="">Private CA Service can be hosted within ones infrastructure</li>
</ul>
</li>
<li class="">CA uses Private Key to <strong>sign</strong> Certificates</li>
<li class="">Public Keys of CAs are available in e.g. Browsers (Trusted Root Certification Authorities)</li>
<li class="">Browser uses Public Key of CA to <strong>verify</strong> that a specific Certificate was signed with Private Key of Official CA</li>
</ul>
<p>Public CAs:</p>
<ul>
<li class="">Symantec</li>
<li class="">Comodo</li>
<li class="">GlobalSign</li>
<li class="">Digicert</li>
</ul>
<h4 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="10317-naming-convention-of-public-and-private-keys">10.3.1.7. Naming Convention of Public and Private Keys<a href="#10317-naming-convention-of-public-and-private-keys" class="hash-link" aria-label="Direct link to 10.3.1.7. Naming Convention of Public and Private Keys" title="Direct link to 10.3.1.7. Naming Convention of Public and Private Keys" translate="no">​</a></h4>
<ul>
<li class="">Certificate (Public Key)<!-- -->
<ul>
<li class="">*.crt, *.pem:<!-- -->
<ul>
<li class="">server.crt</li>
<li class="">server.pem</li>
<li class="">client.crt</li>
<li class="">client.pem</li>
</ul>
</li>
</ul>
</li>
<li class="">Private Key<!-- -->
<ul>
<li class="">*.key, *-key.pem:<!-- -->
<ul>
<li class="">server.key</li>
<li class="">server-key.pem</li>
<li class="">client.key</li>
<li class="">client-key.pem</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="10318-tls-use-cases">10.3.1.8. TLS Use Cases<a href="#10318-tls-use-cases" class="hash-link" aria-label="Direct link to 10.3.1.8. TLS Use Cases" title="Direct link to 10.3.1.8. TLS Use Cases" translate="no">​</a></h4>
<ul>
<li class="">Admins generate Key Pairs to secure SSH</li>
<li class="">Web Server has Key Pairs to secure Website with HTTPS</li>
<li class="">CA Generates its own Key Pairs to sign/verify Certificates</li>
<li class="">End Users/Browser only generates single Symetric Key</li>
</ul>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="1032-tls-in-kubernetes">10.3.2. TLS in Kubernetes<a href="#1032-tls-in-kubernetes" class="hash-link" aria-label="Direct link to 10.3.2. TLS in Kubernetes" title="Direct link to 10.3.2. TLS in Kubernetes" translate="no">​</a></h3>
<ul>
<li class="">Root Certificates (on CA Servers)</li>
<li class="">Server Certificates signed by CA (on Servers)</li>
<li class="">Client Certificates signed by CA (on Clients)</li>
</ul>
<p><strong>Certificate Authority</strong></p>
<ul>
<li class="">CA<!-- -->
<ul>
<li class="">ca.crt, ca.key</li>
</ul>
</li>
</ul>
<p><strong>Server Certificates for Servers</strong></p>
<ul>
<li class="">kube-apiserver (server)<!-- -->
<ul>
<li class="">kube-apiserver.crt, kube-apiserver.key</li>
</ul>
</li>
<li class="">etcd (server)<!-- -->
<ul>
<li class="">etcd.crt, etcd.key</li>
</ul>
</li>
<li class="">kubelet (server)<!-- -->
<ul>
<li class="">kubelet.crt, kubelet.key</li>
</ul>
</li>
</ul>
<p><strong>Client Certificates for Clients</strong></p>
<ul>
<li class="">kube-apiserver (client)<!-- -->
<ul>
<li class="">etcd (server)<!-- -->
<ul>
<li class="">kube-apiserver-etcd.crt, kube-apiserver-etcd.key</li>
</ul>
</li>
<li class="">kubelet (server)<!-- -->
<ul>
<li class="">kube-apiserver-kubelet.crt, kube-apiserver-kubelet.key</li>
</ul>
</li>
</ul>
</li>
<li class="">kubelet (client)<!-- -->
<ul>
<li class="">kube-apiserver (server)<!-- -->
<ul>
<li class="">kubelet-kube-apiserver.crt, kubelet-kube-apiserver.key</li>
</ul>
</li>
</ul>
</li>
<li class="">admin (client)<!-- -->
<ul>
<li class="">kube-apiserver (server)<!-- -->
<ul>
<li class="">admin-kube-apiserver.crt, admin-kube-apiserver.key</li>
</ul>
</li>
</ul>
</li>
<li class="">kube-scheduler (client)<!-- -->
<ul>
<li class="">kube-apiserver (server)<!-- -->
<ul>
<li class="">kube-scheduler-kube-apiserver.crt, kube-scheduler-kube-apiserver.key</li>
</ul>
</li>
</ul>
</li>
<li class="">kube-controller-manager (client)<!-- -->
<ul>
<li class="">kube-apiserve (server)<!-- -->
<ul>
<li class="">kube-controller-manager-kube-apiserver.crt, kube-controller-manager-kube-apiserver.key</li>
</ul>
</li>
</ul>
</li>
<li class="">kube-proxy (client)<!-- -->
<ul>
<li class="">kube-apiserve (server)<!-- -->
<ul>
<li class="">kube-proxy-kube-apiserver.crt, kube-proxy-kube-apiserver.key</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="1033-tls-in-kubernetes---certificate-creation">10.3.3. TLS in Kubernetes - Certificate Creation<a href="#1033-tls-in-kubernetes---certificate-creation" class="hash-link" aria-label="Direct link to 10.3.3. TLS in Kubernetes - Certificate Creation" title="Direct link to 10.3.3. TLS in Kubernetes - Certificate Creation" translate="no">​</a></h3>
<p>Tools to create certificates</p>
<ul>
<li class="">EASYRSA</li>
<li class="">OPENSSL</li>
<li class="">CFSSL</li>
</ul>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># CA --------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Generate Private Key ca.key for CA</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">openssl genrsa </span><span class="token parameter variable" style="color:#36acaa">-out</span><span class="token plain"> ca.key </span><span class="token number" style="color:#36acaa">2048</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Generate Certificate Signing Request (CSR) ca.crs using ca.key for CA. CSR is a certificate with all your details but without signature</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">openssl req </span><span class="token parameter variable" style="color:#36acaa">-new</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-key</span><span class="token plain"> ca.key </span><span class="token parameter variable" style="color:#36acaa">-subj</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/CN=KUBERNETES-CA&quot;</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-out</span><span class="token plain"> ca.csr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Sign (ROOT) Certificate ca.crt using ca.csr and ca.key for CA (self-signed). CA ca.crt must be in ALL k8s hosts (servers/clients)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">openssl x509 </span><span class="token parameter variable" style="color:#36acaa">-req</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-in</span><span class="token plain"> ca.csr </span><span class="token parameter variable" style="color:#36acaa">-signkey</span><span class="token plain"> ca.key </span><span class="token parameter variable" style="color:#36acaa">-out</span><span class="token plain"> ca.crt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># CLIENT Certificates ---------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Generate Private Key admin.key for Admin</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">openssl genrsa </span><span class="token parameter variable" style="color:#36acaa">-out</span><span class="token plain"> admin.key </span><span class="token number" style="color:#36acaa">2048</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Generate Certificate Signing Request (CSR) admin.crs using admin.key for Admin. CSR is a certificate with all your details but without signature. Certificate is so called Validated User ID and Key is Password</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># &quot;/CN=kube-admin&quot; is admin name which e.g. appears in audit logs</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># &quot;/O=system:masters&quot; is a Group Detail added to Certificate to differentiat admin user from simple user. </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Groups named &quot;system:masters&quot;, &quot;system:kube-scheduler&quot;, &quot;system:kube-controller-manager&quot;, &quot;system:kube-proxy&quot;, &quot;system:nodes&quot; exists in k8s with admin/relevant priviledges</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">openssl req </span><span class="token parameter variable" style="color:#36acaa">-new</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-key</span><span class="token plain"> admin.key </span><span class="token parameter variable" style="color:#36acaa">-subj</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/CN=kube-admin/O=system:masters&quot;</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-out</span><span class="token plain"> admin.csr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Sign Admin admin.crt using ca.csr and ca.key. CA Key Pair is used to sign all server and client certificates</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">openssl x509 </span><span class="token parameter variable" style="color:#36acaa">-req</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-in</span><span class="token plain"> ca.csr </span><span class="token parameter variable" style="color:#36acaa">-signkey</span><span class="token plain"> ca.key </span><span class="token parameter variable" style="color:#36acaa">-out</span><span class="token plain"> admin.crt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># SERVER Certificates ---------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Generate Private Key kube-apiserver.key for kube-apiserver</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">openssl genrsa </span><span class="token parameter variable" style="color:#36acaa">-out</span><span class="token plain"> kube-apiserver.key </span><span class="token number" style="color:#36acaa">2048</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Generate Certificate Signing Request (CSR) kube-apiserver.crs using kube-apiserver.key for kube-apiserver. CSR is a certificate with all your details but without signature</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">openssl req </span><span class="token parameter variable" style="color:#36acaa">-new</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-key</span><span class="token plain"> kube-apiserver.key </span><span class="token parameter variable" style="color:#36acaa">-subj</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/CN=kube-apiserver&quot;</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-out</span><span class="token plain"> kube-apiserver.csr </span><span class="token parameter variable" style="color:#36acaa">-config</span><span class="token plain"> openssl.cnf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># openssl.cnf</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">req</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">req_extensions </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> v3_req</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">distinguished_name </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> req_distinguished_name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> v3_req </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">basicConstraints </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> CA:FALSE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">keyUsage </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> nonRepudiation,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">subjectAltName </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> @alt_names</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">alt_names</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">                        </span><span class="token comment" style="color:#999988;font-style:italic"># Only clients refering to kube-apiserver by defined names can establish valid connection</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DNS.1 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> kubernetes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DNS.2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> kubernetes.default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DNS.3 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> kubernetes.default.svc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DNS.4 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> kubernetes.deafult.svc.cluster.local</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IP.1 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10.96</span><span class="token plain">.0.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IP.2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">172.17</span><span class="token plain">.0.87</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Sign kube-apiserver kube-apiserver.crt using ca.csr and ca.key. CA Key Pair is used to sign all server and client certificates</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">openssl x509 </span><span class="token parameter variable" style="color:#36acaa">-req</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-in</span><span class="token plain"> kube-apiserver.csr </span><span class="token parameter variable" style="color:#36acaa">-signkey</span><span class="token plain"> ca.key </span><span class="token parameter variable" style="color:#36acaa">-out</span><span class="token plain"> kube-apiserver.crt</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="1034-view-certificate-details">10.3.4. View Certificate Details<a href="#1034-view-certificate-details" class="hash-link" aria-label="Direct link to 10.3.4. View Certificate Details" title="Direct link to 10.3.4. View Certificate Details" translate="no">​</a></h3>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># View Certificate Details and Perform a healthcheck of Certificates ----------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Check Details:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#   - Common Name (e.g. kube-apiserver)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#   - Subject Alternative Name (kubernetes, kubernetes.default etc.)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#   - Validity (e.g. expirity date)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#   - Issuer (e.g. CA)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#   - See https://kubernetes.io/docs/setup/best-practices/certificates/ or https://github.com/mmumshad/kubernetes-the-hard-way/tree/master/tools</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">openssl x509 </span><span class="token parameter variable" style="color:#36acaa">-in</span><span class="token plain"> /etc/kubernetes/pki/apiserver.crt </span><span class="token parameter variable" style="color:#36acaa">-text</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-noout</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Show certificate of server --------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">openssl s_client </span><span class="token parameter variable" style="color:#36acaa">-connect</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">ip-of-host</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Inspect Service Logs --------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">journalctl </span><span class="token parameter variable" style="color:#36acaa">-u</span><span class="token plain"> etcd.service </span><span class="token parameter variable" style="color:#36acaa">-l</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl logs etcd-master</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="104-certificate-api">10.4. Certificate API<a href="#104-certificate-api" class="hash-link" aria-label="Direct link to 10.4. Certificate API" title="Direct link to 10.4. Certificate API" translate="no">​</a></h2>
<ul>
<li class="">In a Kubernetes cluster, a <strong>Certificate Authority (CA) server</strong> is responsible for managing and issuing digital certificates</li>
<li class="">If a new developer needs to access k8s cluster, he/she must create Private Key and provide CSR which then will be signed with CA private key on CA server by k8s admins</li>
<li class="">The built-in <strong>Certificate API</strong> in Kubernetes is a set of resources and functionalities that facilitate the management of TLS certificates within a Kubernetes cluster (e.g. sign and rotate certificates etc.)<!-- -->
<ul>
<li class="">Admin creates <code>CertificateSigningRequest</code> object (e.g. Instead of signing to CA server and signing certificate manually)</li>
<li class="">Request then can be reviewed</li>
<li class="">And approved using <code>kubectl get csr &amp;&amp; kubectl certificate approve &lt;name-of-csr&gt;</code> commands</li>
<li class="">Certificates then can be extracted and shared with users with <code>kubectl get csr &lt;name-of-csr&gt; -o yaml &amp;&amp; echo &quot;certificate-encoded-in-base64&quot; | base64 --decode</code></li>
<li class=""><strong>Kube Controller Manager</strong> is responsible for operations with certificates (components: CSR-APPROVING, CSR-SIGNING)</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="1041-steps-to-generate-certificate-for-a-new-user">10.4.1. Steps to generate certificate for a new User<a href="#1041-steps-to-generate-certificate-for-a-new-user" class="hash-link" aria-label="Direct link to 10.4.1. Steps to generate certificate for a new User" title="Direct link to 10.4.1. Steps to generate certificate for a new User" translate="no">​</a></h3>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># USER creates Private Key and CSR</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">openssh genrsa </span><span class="token parameter variable" style="color:#36acaa">-out</span><span class="token plain"> jane.key </span><span class="token number" style="color:#36acaa">2048</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">openssl req </span><span class="token parameter variable" style="color:#36acaa">-new</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-key</span><span class="token plain"> jane.key </span><span class="token parameter variable" style="color:#36acaa">-subj</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/CN=jane&quot;</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-out</span><span class="token plain"> jane.csr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># ADMIN encodes in with base64, creates CertificateSigningRequest object, approve and share certificate with user</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> jane.csr </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> base64 </span><span class="token parameter variable" style="color:#36acaa">-w</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: certificates.k8s.io/v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: CertificateSigningRequest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name: jane</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  request: </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">base64-encoded-csr</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  expirationSeconds: </span><span class="token number" style="color:#36acaa">600</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  usages:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - digital signature</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - key encipherment</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - server auth</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubect get csr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubect certificate approve jane</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get csr </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">name-of-csr</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-o</span><span class="token plain"> yaml </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;certificate-encoded-in-base64&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> base64 </span><span class="token parameter variable" style="color:#36acaa">--decode</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="105-kubeconfig">10.5. KubeConfig<a href="#105-kubeconfig" class="hash-link" aria-label="Direct link to 10.5. KubeConfig" title="Direct link to 10.5. KubeConfig" translate="no">​</a></h2>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># View KubeConfig</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl config view </span><span class="token parameter variable" style="color:#36acaa">--kubeconfig</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">/custom/path/to/config</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl config use-context prod-user@production</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl config </span><span class="token parameter variable" style="color:#36acaa">-h</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Authenticate using Certificates with curl,kubectl or define all values in $HOME/.kube/config</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> https://kube-apiserver:6443/api/v1/pods </span><span class="token parameter variable" style="color:#36acaa">--key</span><span class="token plain"> admin.key </span><span class="token parameter variable" style="color:#36acaa">--cert</span><span class="token plain"> admin.crt </span><span class="token parameter variable" style="color:#36acaa">--cacert</span><span class="token plain"> ca.crt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubect get pods </span><span class="token parameter variable" style="color:#36acaa">--server</span><span class="token plain"> kube-apiserver:6443 --client-key admin.key --client-certificate admin.crt --certificate-authority ca.crt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># $HOME/.kube/config</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: Config</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">current-context: kubernetes-admin@kubernetes-cluster</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">clusters:                                     </span><span class="token comment" style="color:#999988;font-style:italic"># Clusters (e.g. dev, prod, google)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- name: kubernetes-cluster</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  cluster:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    certificate-authority: ca.crt             </span><span class="token comment" style="color:#999988;font-style:italic"># alternatively use &quot;certificate-authority-data: &lt;base64-encoded-certificate&gt;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    server: https://kube-apiserver:6443</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: Config</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">users:                                        </span><span class="token comment" style="color:#999988;font-style:italic"># Users (e.g. admin, devuser, produser)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- name: kubernetes-admin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  user:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    client-certificate: admin.crt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    client-key: admin.key</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">contexts:                                     </span><span class="token comment" style="color:#999988;font-style:italic"># Contexts (&lt;user&gt;@&lt;cluster&gt; e.g. admin@dev, devuser@prod)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- name: kubernetes-admin@kubernetes-cluster</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  context:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cluster: kubernetes-cluster</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    user: kubernetes-admin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    namespace: kubernetes-namespace</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="106-persistent-keyvalue-store">10.6. Persistent Key/Value Store<a href="#106-persistent-keyvalue-store" class="hash-link" aria-label="Direct link to 10.6. Persistent Key/Value Store" title="Direct link to 10.6. Persistent Key/Value Store" translate="no">​</a></h2>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="107-api-group">10.7. API Group<a href="#107-api-group" class="hash-link" aria-label="Direct link to 10.7. API Group" title="Direct link to 10.7. API Group" translate="no">​</a></h2>
<p><strong>API groups</strong> make it easier to extend the Kubernetes API. The API group is specified in a <em>REST path</em> and in the <em>apiVersion field</em> of a serialized object.</p>
<ul>
<li class="">/metrics</li>
<li class="">/healthz</li>
<li class="">/version</li>
<li class="">/logs</li>
<li class="">/api (responsible for cluster functionality)</li>
<li class="">/apis (responsible for cluster functionality)</li>
</ul>
<p>API groups in Kubernetes:</p>
<ul>
<li class="">The <strong>core</strong> (also called legacy) group is found at REST path <code>/api/v1</code>. The core group is not specified as part of the apiVersion field, for example, apiVersion: v1.</li>
<li class="">The <strong>named groups</strong> are at REST path <code>/apis/$GROUP_NAME/$VERSION</code>, more organized and use apiVersion: $GROUP_NAME/$VERSION (for example, apiVersion: batch/v1).</li>
</ul>
<p><strong>Core groups:</strong></p>
<ul>
<li class="">/api<!-- -->
<ul>
<li class="">/v1<!-- -->
<ul>
<li class="">namespaces</li>
<li class="">pods</li>
<li class="">rc</li>
<li class="">events</li>
<li class="">endpoints</li>
<li class="">nodes</li>
<li class="">bindings</li>
<li class="">PV</li>
<li class="">PVC</li>
<li class="">configmaps</li>
<li class="">secrets</li>
<li class="">services</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>Named groups:</strong></p>
<ul>
<li class="">/apis<!-- -->
<ul>
<li class="">/apps (API Groups)<!-- -->
<ul>
<li class="">/v1 (aka apiVersion)<!-- -->
<ul>
<li class="">/deployments (aka RESOURCES)<!-- -->
<ul>
<li class="">list, get, create, delete, update, watch (aka VERBS)</li>
</ul>
</li>
<li class="">/replicasets</li>
<li class="">/statefulsets</li>
</ul>
</li>
</ul>
</li>
<li class="">/extensions</li>
<li class="">/networking.k8s.io<!-- -->
<ul>
<li class="">/v1<!-- -->
<ul>
<li class="">/networkpolicies</li>
</ul>
</li>
</ul>
</li>
<li class="">/storage.k8s.io</li>
<li class="">/authentication.k8s.io</li>
<li class="">/certificates.k8s.io<!-- -->
<ul>
<li class="">/v1<!-- -->
<ul>
<li class="">/certificatesigningrequests</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Start Kubectl Proxy (i.e. http proxy service) locally which uses credentials from KubeConfig and provides access to Kube ApiServer</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl proxy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># List available API Groups in K8s Cluster/Kube ApiServer</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> https://localhost:6443 </span><span class="token parameter variable" style="color:#36acaa">-k</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="108-authorization">10.8. Authorization<a href="#108-authorization" class="hash-link" aria-label="Direct link to 10.8. Authorization" title="Direct link to 10.8. Authorization" translate="no">​</a></h2>
<ul>
<li class="">Admins</li>
<li class="">Developers</li>
<li class="">Bots</li>
</ul>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="1081-authorization-modes">10.8.1. Authorization Modes<a href="#1081-authorization-modes" class="hash-link" aria-label="Direct link to 10.8.1. Authorization Modes" title="Direct link to 10.8.1. Authorization Modes" translate="no">​</a></h3>
<p><strong>Authorization modes</strong> refer to the specific configurations or settings that determine which <a href="#1082-authorization-mechanisms" class="">authorization mechanisms</a> are active:</p>
<ul>
<li class="">AlwaysAllow</li>
<li class="">Node</li>
<li class="">ABAC</li>
<li class="">RBAC</li>
<li class="">Webhook</li>
<li class="">AlwaysDeny</li>
</ul>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="1082-authorization-mechanisms">10.8.2. Authorization Mechanisms<a href="#1082-authorization-mechanisms" class="hash-link" aria-label="Direct link to 10.8.2. Authorization Mechanisms" title="Direct link to 10.8.2. Authorization Mechanisms" translate="no">​</a></h3>
<ul>
<li class="">Node based<!-- -->
<ul>
<li class="">used to access within the cluster, e.g. node access to apiserver</li>
</ul>
</li>
<li class="">Attribute Based Authorization (ABAC)<!-- -->
<ul>
<li class="">difficult to manage as it is managed by policy file defined in Kube ApiServer</li>
<li class="">external access to apiserver</li>
</ul>
</li>
<li class="">Role Based Authorization (RBAC)</li>
<li class="">Webhook</li>
</ul>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Flag used to set authorization mode on Kube ApiServer. Authorization check in defined ORDER of authorization mode</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">---authorization-mode </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Node,RBAC,Webhook </span><span class="token punctuation" style="color:#393A34">\</span><span class="token punctuation" style="color:#393A34">\</span><br></span></code></pre></div></div>
<h4 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="10821-node-authorizer">10.8.2.1. <strong>Node Authorizer</strong><a href="#10821-node-authorizer" class="hash-link" aria-label="Direct link to 10821-node-authorizer" title="Direct link to 10821-node-authorizer" translate="no">​</a></h4>
<p>e.g. is managed by certificates</p>
<ul>
<li class="">Kube ApiServer (server)<!-- -->
<ul>
<li class="">Kubelet (client, certificate group part of &quot;system:node<!-- -->:node1<!-- -->&quot;)<!-- -->
<ul>
<li class="">Read:<!-- -->
<ul>
<li class="">Services, Endpoints, Nodes, Pods</li>
</ul>
</li>
<li class="">Write<!-- -->
<ul>
<li class="">Node status, Pod status, events</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="10822-abac">10.8.2.2. <strong>ABAC</strong><a href="#10822-abac" class="hash-link" aria-label="Direct link to 10822-abac" title="Direct link to 10822-abac" translate="no">​</a></h4>
<p>e.g. is managed by policy file defined in Kube ApiServer (see below)</p>
<ul>
<li class="">Kube ApiServer (server)<!-- -->
<ul>
<li class="">User (client, e.g. dev-user-1)<!-- -->
<ul>
<li class="">Can View, Create, Delete Pods</li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// ABAC policy file</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token property" style="color:#36acaa">&quot;kind&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Policy&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;spec&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token property" style="color:#36acaa">&quot;user&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;dev-user-1&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;namespace&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;*&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;resource&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;pods&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">&quot;apiGroup&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;*&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<h4 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="10823-rbac">10.8.2.3. <strong>RBAC</strong><a href="#10823-rbac" class="hash-link" aria-label="Direct link to 10823-rbac" title="Direct link to 10823-rbac" translate="no">​</a></h4>
<p>e.g. is managed by policy file defined in Kube ApiServer</p>
<ul>
<li class="">Kube ApiServer (server)<!-- -->
<ul>
<li class="">Developers<!-- -->
<ul>
<li class="">User (client, e.g. dev-user-1)<!-- -->
<ul>
<li class="">Can View Pods</li>
</ul>
</li>
</ul>
</li>
<li class="">Admins<!-- -->
<ul>
<li class="">User (client, e.g. admin-user-1)<!-- -->
<ul>
<li class="">Can View, Create, Delete Pods</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="10824-webhook">10.8.2.4. Webhook<a href="#10824-webhook" class="hash-link" aria-label="Direct link to 10.8.2.4. Webhook" title="Direct link to 10.8.2.4. Webhook" translate="no">​</a></h4>
<ul>
<li class="">Authorization managed by external tool<!-- -->
<ul>
<li class="">Open Policy Agent</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="1083-rbac">10.8.3. RBAC<a href="#1083-rbac" class="hash-link" aria-label="Direct link to 10.8.3. RBAC" title="Direct link to 10.8.3. RBAC" translate="no">​</a></h3>
<p><strong>Roles</strong> and <strong>RoleBindings</strong> are namespaces, i.e. created within namespace. They created in <code>default</code> namespace if the namespace is not defined in description file.</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Check RBAC</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl roles</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl rolebindings</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl auth can-i </span><span class="token parameter variable" style="color:#36acaa">--list</span><span class="token plain"> </span><br></span></code></pre></div></div>
<ol>
<li class="">
<p>Create a Role</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Role definition file developer-role.yaml</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> rbac.authorization.k8s.io/v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Role</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> developer</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">role</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">namespace</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> dev</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">namespace</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">rules</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">apiGroups</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">                       </span><span class="token comment" style="color:#999988;font-style:italic"># &quot;&quot; indicates the core API group</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">resources</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;pods&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;services&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">verbs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;get&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;list&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;create&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;update&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;delete&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">resourceName</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;blue&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;orange&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic"># Specify Pod Names</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">apiGroups</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;apps&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">                   </span><span class="token comment" style="color:#999988;font-style:italic"># For resources in the apps API group</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">resources</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;deployments&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">verbs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;get&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;list&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;create&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;update&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;delete&quot;</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre></div></div>
</li>
<li class="">
<p>Link a Role to User</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Bind a Role to User in developer-rolebinding.yaml</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> rbac.authorization.k8s.io/v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> RoleBinding</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> developer</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">rolebinding</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">namespace</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> dev</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">namespace</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">subjects</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> User</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> dev</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">user</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">apiGroup</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> rbac.authorization.k8s.io</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">roleRef</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Role</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> developer</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">role</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">apiGroup</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> rbac.authorization.k8s.io</span><br></span></code></pre></div></div>
</li>
</ol>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="1084-cluster-roles-and-role-bindings">10.8.4. Cluster Roles and Role Bindings<a href="#1084-cluster-roles-and-role-bindings" class="hash-link" aria-label="Direct link to 10.8.4. Cluster Roles and Role Bindings" title="Direct link to 10.8.4. Cluster Roles and Role Bindings" translate="no">​</a></h3>
<p><strong>Resources</strong>:</p>
<ul>
<li class=""><strong>namespaced</strong>
<ul>
<li class="">pods, replicasets, jobs, deployments, services, secrets, roles, rolebindings, configmaps, PVC</li>
</ul>
</li>
<li class=""><strong>cluster-scoped</strong>
<ul>
<li class="">nodes<!-- -->
<ul>
<li class="">nodes are cluster wide/scoped resources and can not be assosiated to any particular namespace</li>
</ul>
</li>
<li class="">clusterroles</li>
<li class="">clusterrolebindings</li>
<li class="">PV</li>
<li class="">certificatesigningrequests</li>
<li class="">namespaces</li>
</ul>
</li>
</ul>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># List namespaced and non-namespaces api-resources</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl api-resources </span><span class="token parameter variable" style="color:#36acaa">--namespaced</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">true/false</span><br></span></code></pre></div></div>
<p>E.g. of cluster roles:</p>
<ul>
<li class="">Cluster Admin<!-- -->
<ul>
<li class="">Can view, create or delete Nodes</li>
</ul>
</li>
<li class="">Storage Admin<!-- -->
<ul>
<li class="">Can view, create or delete PVs/PVCs</li>
</ul>
</li>
</ul>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> rbac.authorization.k8s.io/v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ClusterRole</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> cluster</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">administrator</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">rules</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">apiGroups</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">                  </span><span class="token comment" style="color:#999988;font-style:italic"># &quot;&quot; indicates the core API group</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">resources</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;nodes&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">verbs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;list&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;get&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;create&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;delete&quot;</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre></div></div>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> rbac.authorization.k8s.io/v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ClusterRoleBinding</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> cluster</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">admin</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">clusterrolebinding</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">subjects</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> User</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> cluster</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">admin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">apiGroup</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> rbac.authorization.k8s.io</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">roleRef</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ClusterRole</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> cluster</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">administrator</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">apiGroup</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> rbac.authorization.k8s.io</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="109-service-accounts">10.9. Service Accounts<a href="#109-service-accounts" class="hash-link" aria-label="Direct link to 10.9. Service Accounts" title="Direct link to 10.9. Service Accounts" translate="no">​</a></h2>
<p>Types of user accounts:</p>
<ul>
<li class="">User account<!-- -->
<ul>
<li class="">used by humans</li>
</ul>
</li>
<li class="">Service account<!-- -->
<ul>
<li class="">used by machines, bots, application (e.g. Premetheus, Jenkins)</li>
<li class="">has an automatically (must be manually created from version v1.24) created token, stored as secret</li>
<li class="">every namespace has default service account, which associated to pod on creation</li>
</ul>
</li>
</ul>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get serviceaccount</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl create serviceaccount </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">service-account-name</span><span class="token operator" style="color:#393A34">&gt;</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="1010-image-security">10.10. Image Security<a href="#1010-image-security" class="hash-link" aria-label="Direct link to 10.10. Image Security" title="Direct link to 10.10. Image Security" translate="no">​</a></h2>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Create a secret of type docker-registry</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl create secret docker-registry </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">secret-name</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--docker-server</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">string </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--docker-username</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">user </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--docker-password</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">password </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--docker-email</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">email </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">--from-file</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">key</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">source</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">--dry-run</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">server</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">client</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">none</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: Pod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name: nginx-pod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  containers:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - name: nginx-container</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    image: nginx:latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  imagePullSecrets:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - name: </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">docker-registry-secret-name</span><span class="token operator" style="color:#393A34">&gt;</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="1011-docker-security">10.11. Docker Security<a href="#1011-docker-security" class="hash-link" aria-label="Direct link to 10.11. Docker Security" title="Direct link to 10.11. Docker Security" translate="no">​</a></h2>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Capability of root user list under</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> /usr/include/linux/capability.h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># E.g.: CHOWN, DAC, KILL, SETFCAP, SETPCAP, SETGID, SETUID, NET_BIND, NET_RAW, MAC_ADMIN, BROADCAST, NET_ADMIN, SYS_ADMIN, SYS_CHROOT, AUDIT_WRITE, MANY MORE</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Root user in linux and docker container does not have the same capabilities</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Add or Drop additional capabilities to docker container with</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> run --cap-add MAC_ADMIN ubuntu</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> run --cap-drop KILL ubuntu</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Run docker container with all capabilities</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> run </span><span class="token parameter variable" style="color:#36acaa">--privilided</span><span class="token plain"> ubuntu </span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="1012-security-context">10.12. Security Context<a href="#1012-security-context" class="hash-link" aria-label="Direct link to 10.12. Security Context" title="Direct link to 10.12. Security Context" translate="no">​</a></h2>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: Pod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name: ubuntu-sleep-pod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  labels:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    app: ubuntu-sleep</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  securityContext:    </span><span class="token comment" style="color:#999988;font-style:italic"># Pod Level Security Context</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    runAsUser: </span><span class="token number" style="color:#36acaa">1000</span><span class="token plain">   </span><span class="token comment" style="color:#999988;font-style:italic"># Run the container as user ID 1000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    runAsGroup: </span><span class="token number" style="color:#36acaa">3000</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># Run the container as group ID 3000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fsGroup: </span><span class="token number" style="color:#36acaa">2000</span><span class="token plain">     </span><span class="token comment" style="color:#999988;font-style:italic"># Set the group ID for mounted volumes</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  containers:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - name: ubuntu-container</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      image: ubuntu:latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      command: </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;sleep&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      args: </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;3600&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      securityContext:    </span><span class="token comment" style="color:#999988;font-style:italic"># Container Level Security Context</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        runAsUser: </span><span class="token number" style="color:#36acaa">1000</span><span class="token plain">   </span><span class="token comment" style="color:#999988;font-style:italic"># Run the container as user ID 1000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        runAsGroup: </span><span class="token number" style="color:#36acaa">3000</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># Run the container as group ID 3000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        capabilities:     </span><span class="token comment" style="color:#999988;font-style:italic"># Capabilities are supported only in container level</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          add: </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;MAC_ADMIN&quot;</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="1013-network-policies">10.13. Network Policies<a href="#1013-network-policies" class="hash-link" aria-label="Direct link to 10.13. Network Policies" title="Direct link to 10.13. Network Policies" translate="no">​</a></h2>
<p>A <strong>NetworkPolicy</strong> in Kubernetes is a resource that defines rules for controlling the <strong>ingress</strong> and <strong>egress</strong> traffic to and from Pods, allowing administrators to specify which Pods can communicate with each other and with external endpoints.</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Egress poicity type is not defined, hence egress response traffic not isolated. But egress originiating from db still requires egress policy definition</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Below db only accepts traffic from api-pod on port 3306</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: networking.k8s.io/v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: NetworkPolicy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name: db-policy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  podSelector:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    matchLabels:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      role: db</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  policyTypes:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - Ingress</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ingress:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - from:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        - podSelector:              </span><span class="token comment" style="color:#999988;font-style:italic"># all Pods will be allowed to reach db within defined namespace if podSelector not defined (AND operation)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            matchLabels:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              name: api-pod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          namespaceSelector:        </span><span class="token comment" style="color:#999988;font-style:italic"># to restrict Network Policy to specific namespace traffic flow (if - in front of it, then separate rule)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            matchLabels:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              name: prod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        - ipBlock:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            cidr: </span><span class="token number" style="color:#36acaa">192.168</span><span class="token plain">.5.10/32   </span><span class="token comment" style="color:#999988;font-style:italic"># Allow traffic from specific ip (OR operation with 1st rule &quot;podSelector&quot;)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      ports:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - protocol: TCP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        port: </span><span class="token number" style="color:#36acaa">3306</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Below db only accepts traffic from api-pod on port 3306 AND can push backups to external server with defined ip</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">apiVersion: networking.k8s.io/v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kind: NetworkPolicy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">metadata:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name: db-policy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  podSelector:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    matchLabels:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      role: db</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  policyTypes:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - Ingress</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - Egress</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ingress:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - from:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        - podSelector:              </span><span class="token comment" style="color:#999988;font-style:italic"># all Pods will be allowed to reach db within defined namespace if podSelector not defined (AND operation)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            matchLabels:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              name: api-pod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      ports:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - protocol: TCP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        port: </span><span class="token number" style="color:#36acaa">3306</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  egress:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - to:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        - ipBlock:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            cidr: </span><span class="token number" style="color:#36acaa">192.168</span><span class="token plain">.5.10/32 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      ports:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - protocol: TCP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        port: </span><span class="token number" style="color:#36acaa">80</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="1014-kubectx-and-kubens">10.14. Kubectx and Kubens<a href="#1014-kubectx-and-kubens" class="hash-link" aria-label="Direct link to 10.14. Kubectx and Kubens" title="Direct link to 10.14. Kubectx and Kubens" translate="no">​</a></h2>
<p><strong>kubectx</strong> is a tool to switch between contexts (clusters)
<strong>kubens</strong> is a tool to switch between Kubernetes namespaces</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># kubens and kubectx installation</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">git</span><span class="token plain"> clone https://github.com/ahmetb/kubectx /opt/kubectx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">ln</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-s</span><span class="token plain"> /opt/kubectx/kubectx /usr/local/bin/kubectx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">ln</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-s</span><span class="token plain"> /opt/kubectx/kubens /usr/local/bin/kubens</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="1015-custorm-resource-definition-crd">10.15. Custorm Resource Definition (CRD)<a href="#1015-custorm-resource-definition-crd" class="hash-link" aria-label="Direct link to 10.15. Custorm Resource Definition (CRD)" title="Direct link to 10.15. Custorm Resource Definition (CRD)" translate="no">​</a></h2>
<ul>
<li class="">Resource - objects that represent the state of the cluster<!-- -->
<ul>
<li class="">ReplicaSet</li>
<li class="">Deployments</li>
<li class="">Job</li>
<li class="">CronJob</li>
<li class="">Statefulset</li>
<li class="">Namespace</li>
</ul>
</li>
<li class="">Controller -  control loops that manage the lifecycle of resources to maintain the desired state<!-- -->
<ul>
<li class="">ReplicaSet</li>
<li class="">Deployments</li>
<li class="">Job</li>
<li class="">CronJob</li>
<li class="">Statefulset</li>
<li class="">Namespace</li>
</ul>
</li>
</ul>
<p>Custom resource</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># flight-ticket.yaml</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> flights.com/v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> FlightTicket</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> my</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">flight</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">ticket</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">from</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Berlin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">to</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> London</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">number</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><br></span></code></pre></div></div>
<p>Custom Resource Definition (CRD)</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> apiextensions.k8s.io/v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> CustomResourceDefinition</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> flighttickets.flights.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">group</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> flights.com         </span><span class="token comment" style="color:#999988;font-style:italic"># value of &quot;apiVersion&quot; of definition file</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">scope</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Namespaced</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">names</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> FlightTicket       </span><span class="token comment" style="color:#999988;font-style:italic"># value of &quot;kind&quot; of definition file</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">singular</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> flightticket</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">plural</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> flighttickets</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">shortnames</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> ft</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">versions</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">served</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">storage</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">schema</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">openAPIV3Schema</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">properties</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">properties</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token key atrule" style="color:#00a4db">from</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> string</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token key atrule" style="color:#00a4db">to</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> string</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token key atrule" style="color:#00a4db">number</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> integer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token key atrule" style="color:#00a4db">minumum</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token key atrule" style="color:#00a4db">maximum</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><br></span></code></pre></div></div>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl create </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> flight-ticket.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get flightticket</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl delete flightticket</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="1016-custom-controllers">10.16. Custom Controllers<a href="#1016-custom-controllers" class="hash-link" aria-label="Direct link to 10.16. Custom Controllers" title="Direct link to 10.16. Custom Controllers" translate="no">​</a></h2>
<p>To create Custom Controller</p>
<ul>
<li class="">Install Go</li>
<li class="">Clone <a href="https://github.com/kubernetes/sample-controller" target="_blank" rel="noopener noreferrer" class="">sample of custom controller</a></li>
<li class="">Customize controller.go</li>
<li class="">Build it with <code>go build -o sample-controller .</code></li>
<li class="">Run it with <code>./sample-controller -kubeconfig=$HOME/.kube/config</code>
<ul>
<li class="">Custom Controller can be containerized and run as k8s pod</li>
</ul>
</li>
</ul>
<div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// flightticket_controller.go</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">package</span><span class="token plain"> flightticket</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> controllerKind </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">apps</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">SchemeGroupVersion</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">WithKind</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Flightticket&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Run begins watching and syncing</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">dc </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">FligjtTicketController</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> Run </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">worker </span><span class="token builtin">int</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> stopCh </span><span class="token operator" style="color:#393A34">&lt;-</span><span class="token keyword" style="color:#00009f">chan</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">struct</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Cal BookFlightAPIReplicaSet</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">dc </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">FlightTicketController</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">callBookFlightAPI</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">obj </span><span class="token keyword" style="color:#00009f">interface</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="1017-operator-framework">10.17. Operator Framework<a href="#1017-operator-framework" class="hash-link" aria-label="Direct link to 10.17. Operator Framework" title="Direct link to 10.17. Operator Framework" translate="no">​</a></h2>
<ul>
<li class="">Operator Framework can be used to package Custom Resource Definition and Custom Controller together as simple entity</li>
<li class=""><strong>etcd operator</strong> is famous example to deploy and manage an etcd cluster within kubernetes<!-- -->
<ul>
<li class="">CRS<!-- -->
<ul>
<li class="">EtcdCluster</li>
<li class="">EtcdBackup</li>
<li class="">EtcdRestore</li>
</ul>
</li>
<li class="">CC<!-- -->
<ul>
<li class="">ETCD Controller</li>
<li class="">Backup Operator</li>
<li class="">Restore Operator</li>
</ul>
</li>
</ul>
</li>
<li class="">Check <a href="https://operatorhub.io/" target="_blank" rel="noopener noreferrer" class="">OperatorHub.io</a> for available operators</li>
</ul>
<h1>11. Storage</h1>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="111-docker-storage">11.1. Docker Storage<a href="#111-docker-storage" class="hash-link" aria-label="Direct link to 11.1. Docker Storage" title="Direct link to 11.1. Docker Storage" translate="no">​</a></h2>
<ul>
<li class="">Storage Drivers</li>
<li class="">Volume Drivers</li>
</ul>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="1111-docker-storage-drivers-and-file-systems">11.1.1. Docker Storage Drivers and File Systems<a href="#1111-docker-storage-drivers-and-file-systems" class="hash-link" aria-label="Direct link to 11.1.1. Docker Storage Drivers and File Systems" title="Direct link to 11.1.1. Docker Storage Drivers and File Systems" translate="no">​</a></h3>
<p><strong>Storage Drivers</strong> in Docker enables Layered Architecture and helps to manage storage on images and containers. Common Storage Drivers:</p>
<ul>
<li class="">AUFS (default SD on Ubuntu)</li>
<li class="">ZFS</li>
<li class="">BTRFS</li>
<li class="">Device Mapper</li>
<li class="">Overlay</li>
<li class="">Overlay2</li>
</ul>
<p>By default Docker stores data in</p>
<ul>
<li class="">/var/lib/docker<!-- -->
<ul>
<li class="">/aufs</li>
<li class="">/containers      (layered architecture, transient, <strong>container layers are read/write</strong>)</li>
<li class="">/image           (layered architecture, <strong>image layers are read-only</strong>)</li>
<li class="">/volumes<!-- -->
<ul>
<li class="">/data_volume<!-- -->
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Volume created with</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> volume create data_volume </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># and use either with VOLUME MOUNT: </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> run </span><span class="token parameter variable" style="color:#36acaa">-v</span><span class="token plain"> data_volume:/var/lib/mysql mysql </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># BIND MOUNT: </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> run </span><span class="token parameter variable" style="color:#36acaa">-v</span><span class="token plain"> /data/mysql:/var/lib/mysql mysql</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> run </span><span class="token parameter variable" style="color:#36acaa">--mount</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">type</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">bind, </span><span class="token assign-left variable" style="color:#36acaa">source</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">/data/mysql, </span><span class="token assign-left variable" style="color:#36acaa">target</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">/var/lib/mysql mysql</span><br></span></code></pre></div></div>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="1112-volume-driver-plugins-in-docker">11.1.2. Volume Driver Plugins in Docker<a href="#1112-volume-driver-plugins-in-docker" class="hash-link" aria-label="Direct link to 11.1.2. Volume Driver Plugins in Docker" title="Direct link to 11.1.2. Volume Driver Plugins in Docker" translate="no">​</a></h3>
<p><strong>Volumes</strong> in Docker are handled by <strong>Volume Driver Plugins</strong> and not by Storage Drivers.</p>
<p>Volume Driver Plugins:</p>
<ul>
<li class="">Local (default)</li>
<li class="">Azure File Storage</li>
<li class="">Convoy</li>
<li class="">DigitalOcean Block Storage</li>
<li class="">Flocker</li>
<li class="">gce-docker</li>
<li class="">GlusterFS</li>
<li class="">NetApp</li>
<li class="">RexRay</li>
<li class="">Portworx</li>
<li class="">VMware vSphere Storage</li>
</ul>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># AWS Cloud Storage, Amazon EBS</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> run </span><span class="token parameter variable" style="color:#36acaa">-it</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">--name</span><span class="token plain"> mysql --volume-driver rexray/ebs </span><span class="token parameter variable" style="color:#36acaa">--mount</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">src</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">ebs-vol, </span><span class="token assign-left variable" style="color:#36acaa">target</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">/var/lib/mysql mysql</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="112-container-interfaces">11.2. Container Interfaces<a href="#112-container-interfaces" class="hash-link" aria-label="Direct link to 11.2. Container Interfaces" title="Direct link to 11.2. Container Interfaces" translate="no">​</a></h2>
<p><strong>Kubernetes</strong>:</p>
<ul>
<li class=""><strong>Container Runtime Interface (CRI)</strong>
<ul>
<li class="">rkt</li>
<li class="">docker</li>
<li class="">cri-o</li>
</ul>
</li>
<li class=""><strong>Container Network Interface (CNI)</strong>
<ul>
<li class="">waveworks</li>
<li class="">flannel</li>
<li class="">cilium</li>
</ul>
</li>
<li class=""><strong>Container Storage Interface (CSI)</strong>
<ul>
<li class="">portworx</li>
<li class="">Amazon EBS</li>
<li class="">DELL EMC</li>
<li class="">GlusterFS</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="1121-container-storage-interface-csi">11.2.1. Container Storage Interface (CSI)<a href="#1121-container-storage-interface-csi" class="hash-link" aria-label="Direct link to 11.2.1. Container Storage Interface (CSI)" title="Direct link to 11.2.1. Container Storage Interface (CSI)" translate="no">​</a></h3>
<p>Container Storage Interface (CSI) is not kubernetes specific but universal standard which enables any orchestration tool to work with any storage vendor. Currently Kubernetes, Cloud Foundry and Mesos are with CSI. CSI definces RPCs as:</p>
<ul>
<li class="">CreateVolume</li>
<li class="">DeleteVolume</li>
<li class="">ControllerPublishVolume</li>
</ul>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="113-volumes">11.3. Volumes<a href="#113-volumes" class="hash-link" aria-label="Direct link to 11.3. Volumes" title="Direct link to 11.3. Volumes" translate="no">​</a></h2>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="1131-volumes-and-mounts">11.3.1. Volumes and Mounts<a href="#1131-volumes-and-mounts" class="hash-link" aria-label="Direct link to 11.3.1. Volumes and Mounts" title="Direct link to 11.3.1. Volumes and Mounts" translate="no">​</a></h3>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Pod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> random</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">number</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">generator</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">containers</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> alpine</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> alpine</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">command</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;/bin/sh&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&quot;-c&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">args</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;shuf -i 0-100 -n 1 &gt;&gt; /opt/number.out;&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">volumeMounts</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">mountPath</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /opt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">volume</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">volumes</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">volume</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">hostPath</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">                             </span><span class="token comment" style="color:#999988;font-style:italic"># hostPath (bounded to node)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">path</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Directory</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="1132-volume-types">11.3.2. Volume Types<a href="#1132-volume-types" class="hash-link" aria-label="Direct link to 11.3.2. Volume Types" title="Direct link to 11.3.2. Volume Types" translate="no">​</a></h3>
<p>Volume Types:</p>
<ul>
<li class="">NFS</li>
<li class="">GlusterFS</li>
<li class="">Flocker</li>
<li class="">Ceph</li>
<li class="">Scaleio</li>
<li class="">AWS</li>
</ul>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">volumes</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">volume</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">hostPath</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">                             </span><span class="token comment" style="color:#999988;font-style:italic"># hostPath (bounded to node)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">path</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Directory</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">volumes</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">volume</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">awsElasticBlockStore</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">                 </span><span class="token comment" style="color:#999988;font-style:italic"># awsElasticBlockStore (not bounded to node)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">volumeID</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> &lt;volume</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">id</span><span class="token punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">fsType</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ext4</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="114-persistent-volumes-pv">11.4. Persistent Volumes (PV)<a href="#114-persistent-volumes-pv" class="hash-link" aria-label="Direct link to 11.4. Persistent Volumes (PV)" title="Direct link to 11.4. Persistent Volumes (PV)" translate="no">​</a></h2>
<p><strong>Persistent Volumes (PV)</strong> is a cluster-wide pool of storage volumes configured by administrator. Resources can select storage from PV pool using <strong>Persistent Volume Claims (PVC)</strong>.</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> PersistentVolume</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> pv</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">vol1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">accessModes</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">                                    </span><span class="token comment" style="color:#999988;font-style:italic"># accessMode - how a volume should be mounted on the host</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> ReadWriteOnce                               </span><span class="token comment" style="color:#999988;font-style:italic"># ReadOnlyMany, ReadWriteOnce, ReadWriteMany</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">persistentVolumeReclaimPolicy</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Retain           </span><span class="token comment" style="color:#999988;font-style:italic"># Defines what happens to the volume when it is released. Recycle, Delete, Retain (will not be deleted)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">capacity</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">storage</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 1Gi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># 1. Option</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">hostPath</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">                                       </span><span class="token comment" style="color:#999988;font-style:italic"># Not for PROD</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">path</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /tmp/data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># 2. Option</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">awsElasticBlockStore</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">volumeID</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> &lt;volume</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">id</span><span class="token punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">fsType</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ext4</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="115-persistent-volume-claims-pvc">11.5. Persistent Volume Claims (PVC)<a href="#115-persistent-volume-claims-pvc" class="hash-link" aria-label="Direct link to 11.5. Persistent Volume Claims (PVC)" title="Direct link to 11.5. Persistent Volume Claims (PVC)" translate="no">​</a></h2>
<p>Resources will be boind to a single Persistent Volume (PV) by Persistent Volume Claims (PVC). During the bind following criterias are considered:</p>
<ul>
<li class="">Sufficient Capacity</li>
<li class="">Access Modes</li>
<li class="">Volume Modes</li>
<li class="">Storage Class</li>
<li class="">Selector (is used to bind PVC to specific PV)</li>
</ul>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> PersistentVolumeClaim</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> my</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">persistent</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">volume</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">claim</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">accessModes</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> ReadWriteOnce</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">resources</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">requests</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">storage</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 500Mi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">---</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Pod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> mypod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">containers</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> myfrontend</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> nginx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">volumeMounts</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">mountPath</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/var/www/html&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> mypd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">volumes</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> mypd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">persistentVolumeClaim</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">claimName</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> my</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">persistent</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">volume</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">claim</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="116-storage-class">11.6. Storage Class<a href="#116-storage-class" class="hash-link" aria-label="Direct link to 11.6. Storage Class" title="Direct link to 11.6. Storage Class" translate="no">​</a></h2>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="1161-static-provisioning-of-volume">11.6.1. Static Provisioning of Volume<a href="#1161-static-provisioning-of-volume" class="hash-link" aria-label="Direct link to 11.6.1. Static Provisioning of Volume" title="Direct link to 11.6.1. Static Provisioning of Volume" translate="no">​</a></h3>
<ul>
<li class="">Before PV is created a disk on e.g. google-cloud must be created manually</li>
</ul>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">gcloud beta compute disks create </span><span class="token parameter variable" style="color:#36acaa">--size</span><span class="token plain"> 1GB </span><span class="token parameter variable" style="color:#36acaa">--region</span><span class="token plain"> us-east1 pd-disk</span><br></span></code></pre></div></div>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> PersistentVolumeClaim</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> my</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">persistent</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">volume</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">claim</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">accessModes</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> ReadWriteOnce</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">resources</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">requests</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">storage</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 500Mi</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="1162-dynamic-provisioning-of-volume">11.6.2. Dynamic Provisioning of Volume<a href="#1162-dynamic-provisioning-of-volume" class="hash-link" aria-label="Direct link to 11.6.2. Dynamic Provisioning of Volume" title="Direct link to 11.6.2. Dynamic Provisioning of Volume" translate="no">​</a></h3>
<ul>
<li class="">PV Definition is not needed for DPV but created automatically by StorageClass</li>
</ul>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> storage.k8s.io/v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> StorageClass</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> google</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">storage</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">provisioner</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> kubernetes.io/gce</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">pd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">parameters</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">standard</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">replication-type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> none</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">---</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> PersistentVolumeClaim</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> my</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">persistent</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">volume</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">claim</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">accessModes</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> ReadWriteOnce</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">storageClassName</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> google</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">storage               </span><span class="token comment" style="color:#999988;font-style:italic"># Definition of storageClassName to dynamically define PV and create disk</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">resources</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">requests</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">storage</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 500Mi</span><br></span></code></pre></div></div>
<h1>12. Networking</h1>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="121-coredns">12.1. CoreDNS<a href="#121-coredns" class="hash-link" aria-label="Direct link to 12.1. CoreDNS" title="Direct link to 12.1. CoreDNS" translate="no">​</a></h2>
<p>Read more about CoreDNS here:</p>
<p><a href="https://github.com/kubernetes/dns/blob/master/docs/specification.md" target="_blank" rel="noopener noreferrer" class="">https://github.com/kubernetes/dns/blob/master/docs/specification.md</a>
<a href="https://coredns.io/plugins/kubernetes/" target="_blank" rel="noopener noreferrer" class="">https://coredns.io/plugins/kubernetes/</a></p>
<h1>13. Design and Install a Kubernetes Cluster</h1>
<h1>14. Install &quot;K8s the kubeadm way&quot;</h1>
<h1>15. Helm Basics</h1>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="151-what-is-helm">15.1. What is Helm<a href="#151-what-is-helm" class="hash-link" aria-label="Direct link to 15.1. What is Helm" title="Direct link to 15.1. What is Helm" translate="no">​</a></h2>
<p><strong>Helm</strong> is a package manager for Kubernetes.</p>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="152-helm-components">15.2. Helm Components<a href="#152-helm-components" class="hash-link" aria-label="Direct link to 15.2. Helm Components" title="Direct link to 15.2. Helm Components" translate="no">​</a></h2>
<ul>
<li class="">helm charts</li>
<li class="">helm cli</li>
<li class="">helm releases</li>
<li class="">helm chart repository<!-- -->
<ul>
<li class="">ArtifactHun.io<!-- -->
<ul>
<li class="">Appscode</li>
<li class="">TrueCharts</li>
<li class="">Bitnami</li>
<li class="">Community Operators</li>
</ul>
</li>
</ul>
</li>
</ul>
<h1>16. Kustomize Basics</h1>
<h1>17. End to End tests on a K8s Cluster</h1>
<h1>18. Troubleshooting</h1>
<h1>19. Other Topics</h1>
<h1>20. Ligtning Labs</h1>
<h1>21. Mock Exams</h1>
<h1>22. Course Conclusion</h1>
<h1>23. Commands</h1>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="231-kubernetes">23.1. Kubernetes<a href="#231-kubernetes" class="hash-link" aria-label="Direct link to 23.1. Kubernetes" title="Direct link to 23.1. Kubernetes" translate="no">​</a></h2>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># GET</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get all</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get pods </span><span class="token parameter variable" style="color:#36acaa">--watch</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get pods </span><span class="token parameter variable" style="color:#36acaa">-n</span><span class="token plain"> kube-system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get pods </span><span class="token parameter variable" style="color:#36acaa">-o</span><span class="token plain"> wide</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get pods </span><span class="token parameter variable" style="color:#36acaa">-l</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">environment</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">production,tier</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">frontend</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get pods </span><span class="token parameter variable" style="color:#36acaa">-l</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;environment in (production),tier in (frontend)&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get pods </span><span class="token parameter variable" style="color:#36acaa">-l</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;environment,environment notin (frontend)&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get pods </span><span class="token parameter variable" style="color:#36acaa">--selector</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">app</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">App1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get pods </span><span class="token parameter variable" style="color:#36acaa">--selector</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">app</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">App1 --no-headers </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">wc</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-l</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get pod </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">pod-name</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> --all-namespaces</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get replicationcontroller</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get replicaset</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get replicaset myapp-rs </span><span class="token parameter variable" style="color:#36acaa">-o</span><span class="token plain"> yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get deployments</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get services</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get configmaps</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get secrets</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get secret app-secret </span><span class="token parameter variable" style="color:#36acaa">-o</span><span class="token plain"> yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get hpa</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get all --all-namespaces </span><span class="token parameter variable" style="color:#36acaa">-o</span><span class="token plain"> yaml </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> all-resources.yaml                 </span><span class="token comment" style="color:#999988;font-style:italic"># Backup all resource configurations</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get serviceaccount</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get roles</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get rolebindings</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># DESCRIBE</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl describe pod myapp-pod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl describe </span><span class="token function" style="color:#d73a49">node</span><span class="token plain"> kubemaster</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># APPLY</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> object-definition-file.yaml                                   </span><span class="token comment" style="color:#999988;font-style:italic"># Create or Update (DEFAULT Rolling Update) k8s object </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> /path/to/object-definition-files</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># CREATE</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl create deployment </span><span class="token parameter variable" style="color:#36acaa">--image</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">nginx nginx </span><span class="token parameter variable" style="color:#36acaa">--namespace</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">dev</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl create deployment my-deployment </span><span class="token parameter variable" style="color:#36acaa">--image</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">nginx nginx </span><span class="token parameter variable" style="color:#36acaa">--replicas</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">3</span><span class="token plain"> --dry-run</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">client </span><span class="token parameter variable" style="color:#36acaa">-o</span><span class="token plain"> yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl create </span><span class="token function" style="color:#d73a49">service</span><span class="token plain"> nodeport myapp-service </span><span class="token parameter variable" style="color:#36acaa">--tcp</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">8080</span><span class="token plain">:8080 --dry-run</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">client </span><span class="token parameter variable" style="color:#36acaa">-o</span><span class="token plain"> yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl create namespace dev</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl create configmap </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">config-name</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> --from-literal</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">APP_COLOR</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">blue</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl create configmap </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">config-name</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> --from-file</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">app_config.properties</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl create secret generic </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">secret-name</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> --from-literal</span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">key</span><span class="token operator" style="color:#393A34">&gt;=</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">value</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl create secret generic </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">secret-name</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> --from-file</span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">path-to-file</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl create serviceaccount </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">service-account-name</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl create token </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">service-account-name</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl create secret docker-registry </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">secret-name</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--docker-server</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">string </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--docker-username</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">user </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--docker-password</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">password </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--docker-email</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">email </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">--from-file</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">key</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">source</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">--dry-run</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">server</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">client</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">none</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># EXEC</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl </span><span class="token builtin class-name">exec</span><span class="token plain"> etcd-master </span><span class="token parameter variable" style="color:#36acaa">-n</span><span class="token plain"> kube-system etcdctl get / </span><span class="token parameter variable" style="color:#36acaa">--prefix</span><span class="token plain"> -keys-only</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># RUN</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl run nginx </span><span class="token parameter variable" style="color:#36acaa">--image</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">nginx </span><span class="token parameter variable" style="color:#36acaa">--namespace</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">default --dry-run</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">client </span><span class="token parameter variable" style="color:#36acaa">-o</span><span class="token plain"> yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl run nginx </span><span class="token parameter variable" style="color:#36acaa">--image</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">nginx -- </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">arg</span><span class="token operator file-descriptor important" style="color:#393A34">1</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">arg</span><span class="token operator file-descriptor important" style="color:#393A34">2</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">. </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">argN</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl run nginx </span><span class="token parameter variable" style="color:#36acaa">--image</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">nginx </span><span class="token parameter variable" style="color:#36acaa">--command</span><span class="token plain"> -- </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">cmd</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">arg</span><span class="token operator file-descriptor important" style="color:#393A34">1</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">arg</span><span class="token operator file-descriptor important" style="color:#393A34">2</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">. </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">argN</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># EDIT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl edit replicaset</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># LABEL</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl label nodes </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">node-name</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">label-key</span><span class="token operator" style="color:#393A34">&gt;=</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">label-value</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># REPLACE</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl replace </span><span class="token parameter variable" style="color:#36acaa">--force</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> replicaset-definition.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># SCALE</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl scale </span><span class="token parameter variable" style="color:#36acaa">--replicas</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">6</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> replicaset-definition.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl scale </span><span class="token parameter variable" style="color:#36acaa">--replicas</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">6</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> replicaset myapp-rs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># AUTOSCALE </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl autoscale deployment foo --cpu-percent</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">50</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">--min</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">--max</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">10</span><span class="token plain">                </span><span class="token comment" style="color:#999988;font-style:italic"># Create HPA for a deployment &quot;foo&quot; with CPU thresholds of 50% and min 1 pod and max 10 pods</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># DELETE</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl delete replicaset myapp-replicaset               </span><span class="token comment" style="color:#999988;font-style:italic"># deletes all underlying Pods </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># CONFIG</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl config </span><span class="token parameter variable" style="color:#36acaa">-h</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl config view </span><span class="token parameter variable" style="color:#36acaa">--kubeconfig</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">/custom/path/to/config</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl config use-context </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">user-name</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">@</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">cluster-name</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl config set-context </span><span class="token variable" style="color:#36acaa">$(</span><span class="token variable" style="color:#36acaa">kubectl config current-context</span><span class="token variable" style="color:#36acaa">)</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">--namespace</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">dev</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># TAINT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl taint nodes </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">NODE-NAME</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">KEY</span><span class="token operator" style="color:#393A34">&gt;=</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">VALUE</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">:</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">TAINT-EFFECT</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">                    </span><span class="token comment" style="color:#999988;font-style:italic"># TAINT-EFFECTs: NoSchedule, PreferNoSchedule, NoExecute</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl taint nodes </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">NODE-NAME</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">KEY</span><span class="token operator" style="color:#393A34">&gt;=</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">VALUE</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">:</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">TAINT-EFFECT</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">-                   </span><span class="token comment" style="color:#999988;font-style:italic"># UNTAINT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># LOGS</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl logs </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">pod-name</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl logs </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">pod-name</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">container-name</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># AUTH</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl auth can-i </span><span class="token parameter variable" style="color:#36acaa">--list</span><span class="token plain">                                                      </span><span class="token comment" style="color:#999988;font-style:italic"># check current user permissions</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl auth can-i </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">verb</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">resource</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-n</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">namespace</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">--as</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">user-name</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">           </span><span class="token comment" style="color:#999988;font-style:italic"># check if the current user can perform a specific action on a resource</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl auth can-i create pods </span><span class="token parameter variable" style="color:#36acaa">-n</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">namespace</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">--as</span><span class="token plain"> dev-user                                  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># ROLLOUT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl rollout status deployment/</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">depoyment-name</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">                                 </span><span class="token comment" style="color:#999988;font-style:italic"># Check the status of a rollout</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl rollout </span><span class="token function" style="color:#d73a49">history</span><span class="token plain"> deployment/</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">depoyment-name</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">                                </span><span class="token comment" style="color:#999988;font-style:italic"># Show the history of rollouts</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl rollout undo deployment/</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">depoyment-name</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> --to-revision</span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">revision_number</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">   </span><span class="token comment" style="color:#999988;font-style:italic"># Undo a rollout to the specific revision</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># DRAIN</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl drain </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">node-name</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">                                   </span><span class="token comment" style="color:#999988;font-style:italic"># drain the node (will be marked as unschedulable) for maintenance purpose to gracefully terminate pods running on it and to reschedule them. </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># CORDON</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl cordon </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">node-name</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">                                  </span><span class="token comment" style="color:#999988;font-style:italic"># cordon node (mark as unschedulable) so that no new pods are scheduled on it</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># UNCORDON</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl uncordon </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">node-name</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">                                </span><span class="token comment" style="color:#999988;font-style:italic"># uncordon the node so that pods can be scheduled on it after drain</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># KUBE-CONTROLLER-MANAGER</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-controller-manager --pod-eviction-timeout</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">5m0s                          </span><span class="token comment" style="color:#999988;font-style:italic"># set time to wait pods to be evicted. I.e. control plane waits 5 minutes before considering the pod as dead and redeploy it</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># ETCDCTL</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">ETCDCTL_API</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">3</span><span class="token plain"> etcdctl member list</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">ETCDCTL_API</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">3</span><span class="token plain"> etcdctl snapshot save etcd_snapshot.db </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                      </span><span class="token parameter variable" style="color:#36acaa">--endpoints</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">https://127.0.0.1:2379 </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                      </span><span class="token parameter variable" style="color:#36acaa">--cacert</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">/etc/etcd/ca.crt </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                      </span><span class="token parameter variable" style="color:#36acaa">--cert</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">/etc/etcd/etcd-server.crt </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                      </span><span class="token parameter variable" style="color:#36acaa">--key</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">/etc/etcd/etcd-server.key</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">ETCDCTL_API</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">3</span><span class="token plain"> etcdctl snapshot status etcd_snapshot.db</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">ETCDCTL_API</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">3</span><span class="token plain"> etcdctl snapshot restore etcd_snapshot.db --data-dir /var/lib/etcd-from-backup</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetHideOnScrollNavbar_vjPI" id="232-helm">23.2. Helm<a href="#232-helm" class="hash-link" aria-label="Direct link to 23.2. Helm" title="Direct link to 23.2. Helm" translate="no">​</a></h2>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># INSTALL</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">helm </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">release-name</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">package-name</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">--version</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">version</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">helm </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">--set</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">varName</span><span class="token operator file-descriptor important" style="color:#393A34">1</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;newValue1&quot;</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">--set</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">varName</span><span class="token operator file-descriptor important" style="color:#393A34">2</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;newValue2&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">release-name</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">package-name</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">helm </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">--values</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">custom-value-file-name.yaml</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">release-name</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">package-name</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># UNINSTALL</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">helm uninstall </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">package-name</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># PULL</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">helm pull </span><span class="token parameter variable" style="color:#36acaa">--untar</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">package-name</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># UPGRARE</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">helm upgrade </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">release-name</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">package-name</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># ROLLBACK</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">helm rollback </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">release-name</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">revision-number</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># HISTORY</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">helm </span><span class="token function" style="color:#d73a49">history</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">release-name</span><span class="token operator" style="color:#393A34">&gt;</span><br></span></code></pre></div></div>
<h1>24. References</h1>
<ul>
<li class=""><a href="https://www.udemy.com/course/certified-kubernetes-administrator-with-practice-tests" target="_blank" rel="noopener noreferrer" class="">Certified Kubernetes Administrator (CKA) with Practice Tests by Mumshad Mannambeth</a></li>
<li class=""><a href="https://kubernetes.io/docs/reference/generated/kubectl/kubectl-commands" target="_blank" rel="noopener noreferrer" class="">Kubernetes Commands</a></li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_WFHX"><a href="https://github.com/m19v/m19v.github.io/blob/main/docs/notes/software-engineering/kubernetes.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2025-11-24T09:43:10.000Z" itemprop="dateModified">Nov 24, 2025</time></b> by <b>m19v</b></span></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/notes/software-engineering/kafka"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Apache Kafka</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/notes/software-engineering/managing-security-in-gc"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Managing Security in Google Cloud</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#51-kubernetes-architecture" class="table-of-contents__link toc-highlight">5.1. Kubernetes Architecture</a></li><li><a href="#52-open-container-initiative-oci" class="table-of-contents__link toc-highlight">5.2. Open Container Initiative (OCI)</a></li><li><a href="#53-container-runtime-interface-cri" class="table-of-contents__link toc-highlight">5.3. Container Runtime Interface (CRI)</a></li><li><a href="#54-docker-vs-containerd" class="table-of-contents__link toc-highlight">5.4. Docker vs ContainerD</a><ul><li><a href="#541-docker" class="table-of-contents__link toc-highlight">5.4.1. Docker</a></li><li><a href="#542-containerd" class="table-of-contents__link toc-highlight">5.4.2. ContainerD</a></li></ul></li><li><a href="#55-etcd" class="table-of-contents__link toc-highlight">5.5. ETCD</a><ul><li><a href="#551-get-started-quickly-with-etcd" class="table-of-contents__link toc-highlight">5.5.1. Get started quickly with ETCD</a></li><li><a href="#552-etcd-in-kubernetes" class="table-of-contents__link toc-highlight">5.5.2. ETCD in Kubernetes</a></li><li><a href="#553-etcd-setup---manual-vs-kubeadm" class="table-of-contents__link toc-highlight">5.5.3. ETCD Setup - Manual vs kubeadm</a></li></ul></li><li><a href="#56-kube-api-server" class="table-of-contents__link toc-highlight">5.6. Kube-API Server</a></li><li><a href="#57-kube-controller-manager" class="table-of-contents__link toc-highlight">5.7. Kube Controller Manager</a><ul><li><a href="#571-installation-of-kube-controller-manager" class="table-of-contents__link toc-highlight">5.7.1. Installation of Kube-Controller-Manager</a></li></ul></li><li><a href="#58-kube-scheduler" class="table-of-contents__link toc-highlight">5.8. Kube Scheduler</a></li><li><a href="#59-kubelet" class="table-of-contents__link toc-highlight">5.9. Kubelet</a></li><li><a href="#510-kube-proxy" class="table-of-contents__link toc-highlight">5.10. Kube Proxy</a></li><li><a href="#511-pods" class="table-of-contents__link toc-highlight">5.11. Pods</a></li><li><a href="#512-replicasets" class="table-of-contents__link toc-highlight">5.12. ReplicaSets</a></li><li><a href="#513-labels-and-selectors" class="table-of-contents__link toc-highlight">5.13. Labels and Selectors</a></li><li><a href="#514-annotations" class="table-of-contents__link toc-highlight">5.14. Annotations</a></li><li><a href="#515-deployments" class="table-of-contents__link toc-highlight">5.15. Deployments</a></li><li><a href="#516-services" class="table-of-contents__link toc-highlight">5.16. Services</a><ul><li><a href="#5161-clusterip" class="table-of-contents__link toc-highlight">5.16.1. ClusterIP</a></li><li><a href="#5162-nodeport" class="table-of-contents__link toc-highlight">5.16.2. NodePort</a></li><li><a href="#5163-loadbalancer" class="table-of-contents__link toc-highlight">5.16.3. LoadBalancer</a></li><li><a href="#5164-externalname" class="table-of-contents__link toc-highlight">5.16.4. ExternalName</a></li></ul></li><li><a href="#517-namespaces" class="table-of-contents__link toc-highlight">5.17. Namespaces</a><ul><li><a href="#5171-resource-quota" class="table-of-contents__link toc-highlight">5.17.1. Resource Quota</a></li></ul></li><li><a href="#518-imperative-vs-declarative" class="table-of-contents__link toc-highlight">5.18. Imperative vs. Declarative</a></li><li><a href="#61-manual-scheduling" class="table-of-contents__link toc-highlight">6.1. Manual Scheduling</a><ul><li><a href="#611-binding-object" class="table-of-contents__link toc-highlight">6.1.1. Binding Object</a></li></ul></li><li><a href="#62-taints-and-tolerations" class="table-of-contents__link toc-highlight">6.2. Taints and Tolerations</a></li><li><a href="#63-node-selectors" class="table-of-contents__link toc-highlight">6.3. Node Selectors</a></li><li><a href="#64-node-affinity" class="table-of-contents__link toc-highlight">6.4. Node Affinity</a><ul><li><a href="#641-node-affinity-types" class="table-of-contents__link toc-highlight">6.4.1. Node Affinity Types</a></li></ul></li><li><a href="#65-taints-and-tolerations-vs-node-affinity" class="table-of-contents__link toc-highlight">6.5. Taints and Tolerations vs Node Affinity</a></li><li><a href="#66-resource-requirements-and-limits" class="table-of-contents__link toc-highlight">6.6. Resource Requirements and Limits</a><ul><li><a href="#661-default-behaviour" class="table-of-contents__link toc-highlight">6.6.1. Default Behaviour</a></li><li><a href="#662-resource-requests" class="table-of-contents__link toc-highlight">6.6.2. Resource Requests</a></li><li><a href="#663-resource-limits" class="table-of-contents__link toc-highlight">6.6.3. Resource Limits</a></li><li><a href="#664-limitrange" class="table-of-contents__link toc-highlight">6.6.4. LimitRange</a></li><li><a href="#665-resourcequota" class="table-of-contents__link toc-highlight">6.6.5. ResourceQuota</a></li></ul></li><li><a href="#67-deamonsets" class="table-of-contents__link toc-highlight">6.7. DeamonSets</a></li><li><a href="#68-static-pods" class="table-of-contents__link toc-highlight">6.8. Static Pods</a><ul><li><a href="#681-what-is-static-pods" class="table-of-contents__link toc-highlight">6.8.1. What is Static Pods</a></li><li><a href="#682-static-pods-in-cluster" class="table-of-contents__link toc-highlight">6.8.2. Static Pods in Cluster</a></li><li><a href="#683-static-pods-use-case" class="table-of-contents__link toc-highlight">6.8.3. Static Pods Use Case</a></li><li><a href="#684-static-pods-vs-daemonsets" class="table-of-contents__link toc-highlight">6.8.4. Static Pods vs. DaemonSets</a></li></ul></li><li><a href="#69-multiple-schedulers" class="table-of-contents__link toc-highlight">6.9. Multiple Schedulers</a></li><li><a href="#610-configuring-scheduler-profiles" class="table-of-contents__link toc-highlight">6.10. Configuring Scheduler Profiles</a></li><li><a href="#611-admission-controllers" class="table-of-contents__link toc-highlight">6.11. Admission Controllers</a></li><li><a href="#612-validating-and-mutating-admission-controllers" class="table-of-contents__link toc-highlight">6.12. Validating and Mutating Admission Controllers</a><ul><li><a href="#6121-validating-admission-controllers" class="table-of-contents__link toc-highlight">6.12.1. Validating Admission Controllers</a></li><li><a href="#6122-mutating-admission-controller" class="table-of-contents__link toc-highlight">6.12.2. Mutating Admission Controller</a></li><li><a href="#6123-custom-validatingmutating-admission-controllers" class="table-of-contents__link toc-highlight">6.12.3. Custom Validating/Mutating Admission Controllers</a></li></ul></li><li><a href="#71-monitor-cluster-components" class="table-of-contents__link toc-highlight">7.1. Monitor Cluster Components</a><ul><li><a href="#711-tools" class="table-of-contents__link toc-highlight">7.1.1. Tools</a></li></ul></li><li><a href="#72-managing-application-logs" class="table-of-contents__link toc-highlight">7.2. Managing Application Logs</a></li><li><a href="#81-rolling-updates-and-rollbacks" class="table-of-contents__link toc-highlight">8.1. Rolling Updates and Rollbacks</a><ul><li><a href="#811-deployment-strategy" class="table-of-contents__link toc-highlight">8.1.1. Deployment Strategy</a></li></ul></li><li><a href="#82-configure-applications" class="table-of-contents__link toc-highlight">8.2. Configure Applications</a><ul><li><a href="#821-commands-and-arguments-in-docker-and-k8s" class="table-of-contents__link toc-highlight">8.2.1. Commands and Arguments in Docker and K8s</a></li><li><a href="#822-configuring-environment-variables-in-applications" class="table-of-contents__link toc-highlight">8.2.2. Configuring Environment Variables in Applications</a></li><li><a href="#823-configuring-configmaps-in-applications" class="table-of-contents__link toc-highlight">8.2.3. Configuring ConfigMaps in Applications</a></li><li><a href="#824-configure-secrets-an-applications" class="table-of-contents__link toc-highlight">8.2.4. Configure Secrets an Applications</a></li></ul></li><li><a href="#83-scale-applications" class="table-of-contents__link toc-highlight">8.3. Scale Applications</a></li><li><a href="#84-multi-container-pods" class="table-of-contents__link toc-highlight">8.4. Multi Container Pods</a><ul><li><a href="#841-multi-container-pods-design-patterns" class="table-of-contents__link toc-highlight">8.4.1. Multi-container Pods Design Patterns</a></li></ul></li><li><a href="#85-initcontainers" class="table-of-contents__link toc-highlight">8.5. InitContainers</a></li><li><a href="#86-self-healing-applications" class="table-of-contents__link toc-highlight">8.6. Self Healing Applications</a></li><li><a href="#87-intro-to-autoscaling" class="table-of-contents__link toc-highlight">8.7. Intro to Autoscaling</a><ul><li><a href="#871-scaling-cluster-infra-vs-scaling-workloads" class="table-of-contents__link toc-highlight">8.7.1. Scaling Cluster Infra vs Scaling Workloads</a></li><li><a href="#872-manual-vs-automated-scaling" class="table-of-contents__link toc-highlight">8.7.2. Manual vs Automated Scaling</a></li><li><a href="#873-horizontal-pod-autoscaler-hpa" class="table-of-contents__link toc-highlight">8.7.3. Horizontal Pod Autoscaler (HPA)</a></li><li><a href="#874-vertical-pod-autoscaling-vpa" class="table-of-contents__link toc-highlight">8.7.4. Vertical Pod Autoscaling (VPA)</a></li><li><a href="#875-in-place-resize-pods" class="table-of-contents__link toc-highlight">8.7.5. In-place resize Pods</a></li><li><a href="#876-vpa-vs-hpa" class="table-of-contents__link toc-highlight">8.7.6. VPA vs. HPA</a></li></ul></li><li><a href="#91-os-upgrade" class="table-of-contents__link toc-highlight">9.1. OS Upgrade</a></li><li><a href="#92-kubernetes-software-versions" class="table-of-contents__link toc-highlight">9.2. Kubernetes Software Versions</a></li><li><a href="#93-cluster-upgrade-process" class="table-of-contents__link toc-highlight">9.3. Cluster Upgrade Process</a><ul><li><a href="#931-kubeadm-upgrade" class="table-of-contents__link toc-highlight">9.3.1. <code>kubeadm upgrade</code></a></li><li><a href="#932-cluster-upgrade---demo" class="table-of-contents__link toc-highlight">9.3.2. Cluster Upgrade - Demo</a></li><li><a href="#933-backup-and-restore-methods" class="table-of-contents__link toc-highlight">9.3.3. Backup and Restore Methods</a></li></ul></li><li><a href="#101-kubernetes-security-primitives" class="table-of-contents__link toc-highlight">10.1. Kubernetes Security Primitives</a><ul><li><a href="#1011-cluster-hosts-security" class="table-of-contents__link toc-highlight">10.1.1. Cluster Hosts Security</a></li><li><a href="#1012-kubernetes-security" class="table-of-contents__link toc-highlight">10.1.2. Kubernetes Security</a></li><li><a href="#1013-tls-certificates" class="table-of-contents__link toc-highlight">10.1.3. TLS Certificates</a></li><li><a href="#1014-application-communication-within-cluster" class="table-of-contents__link toc-highlight">10.1.4. Application Communication within Cluster</a></li></ul></li><li><a href="#102-authentication" class="table-of-contents__link toc-highlight">10.2. Authentication</a><ul><li><a href="#1021-users" class="table-of-contents__link toc-highlight">10.2.1. Users</a></li><li><a href="#1022-service-accounts" class="table-of-contents__link toc-highlight">10.2.2. Service Accounts</a></li></ul></li><li><a href="#103-tls-certificates-in-k8s" class="table-of-contents__link toc-highlight">10.3. TLS Certificates in K8s</a><ul><li><a href="#1031-tls-basics" class="table-of-contents__link toc-highlight">10.3.1. TLS Basics</a></li><li><a href="#1032-tls-in-kubernetes" class="table-of-contents__link toc-highlight">10.3.2. TLS in Kubernetes</a></li><li><a href="#1033-tls-in-kubernetes---certificate-creation" class="table-of-contents__link toc-highlight">10.3.3. TLS in Kubernetes - Certificate Creation</a></li><li><a href="#1034-view-certificate-details" class="table-of-contents__link toc-highlight">10.3.4. View Certificate Details</a></li></ul></li><li><a href="#104-certificate-api" class="table-of-contents__link toc-highlight">10.4. Certificate API</a><ul><li><a href="#1041-steps-to-generate-certificate-for-a-new-user" class="table-of-contents__link toc-highlight">10.4.1. Steps to generate certificate for a new User</a></li></ul></li><li><a href="#105-kubeconfig" class="table-of-contents__link toc-highlight">10.5. KubeConfig</a></li><li><a href="#106-persistent-keyvalue-store" class="table-of-contents__link toc-highlight">10.6. Persistent Key/Value Store</a></li><li><a href="#107-api-group" class="table-of-contents__link toc-highlight">10.7. API Group</a></li><li><a href="#108-authorization" class="table-of-contents__link toc-highlight">10.8. Authorization</a><ul><li><a href="#1081-authorization-modes" class="table-of-contents__link toc-highlight">10.8.1. Authorization Modes</a></li><li><a href="#1082-authorization-mechanisms" class="table-of-contents__link toc-highlight">10.8.2. Authorization Mechanisms</a></li><li><a href="#1083-rbac" class="table-of-contents__link toc-highlight">10.8.3. RBAC</a></li><li><a href="#1084-cluster-roles-and-role-bindings" class="table-of-contents__link toc-highlight">10.8.4. Cluster Roles and Role Bindings</a></li></ul></li><li><a href="#109-service-accounts" class="table-of-contents__link toc-highlight">10.9. Service Accounts</a></li><li><a href="#1010-image-security" class="table-of-contents__link toc-highlight">10.10. Image Security</a></li><li><a href="#1011-docker-security" class="table-of-contents__link toc-highlight">10.11. Docker Security</a></li><li><a href="#1012-security-context" class="table-of-contents__link toc-highlight">10.12. Security Context</a></li><li><a href="#1013-network-policies" class="table-of-contents__link toc-highlight">10.13. Network Policies</a></li><li><a href="#1014-kubectx-and-kubens" class="table-of-contents__link toc-highlight">10.14. Kubectx and Kubens</a></li><li><a href="#1015-custorm-resource-definition-crd" class="table-of-contents__link toc-highlight">10.15. Custorm Resource Definition (CRD)</a></li><li><a href="#1016-custom-controllers" class="table-of-contents__link toc-highlight">10.16. Custom Controllers</a></li><li><a href="#1017-operator-framework" class="table-of-contents__link toc-highlight">10.17. Operator Framework</a></li><li><a href="#111-docker-storage" class="table-of-contents__link toc-highlight">11.1. Docker Storage</a><ul><li><a href="#1111-docker-storage-drivers-and-file-systems" class="table-of-contents__link toc-highlight">11.1.1. Docker Storage Drivers and File Systems</a></li><li><a href="#1112-volume-driver-plugins-in-docker" class="table-of-contents__link toc-highlight">11.1.2. Volume Driver Plugins in Docker</a></li></ul></li><li><a href="#112-container-interfaces" class="table-of-contents__link toc-highlight">11.2. Container Interfaces</a><ul><li><a href="#1121-container-storage-interface-csi" class="table-of-contents__link toc-highlight">11.2.1. Container Storage Interface (CSI)</a></li></ul></li><li><a href="#113-volumes" class="table-of-contents__link toc-highlight">11.3. Volumes</a><ul><li><a href="#1131-volumes-and-mounts" class="table-of-contents__link toc-highlight">11.3.1. Volumes and Mounts</a></li><li><a href="#1132-volume-types" class="table-of-contents__link toc-highlight">11.3.2. Volume Types</a></li></ul></li><li><a href="#114-persistent-volumes-pv" class="table-of-contents__link toc-highlight">11.4. Persistent Volumes (PV)</a></li><li><a href="#115-persistent-volume-claims-pvc" class="table-of-contents__link toc-highlight">11.5. Persistent Volume Claims (PVC)</a></li><li><a href="#116-storage-class" class="table-of-contents__link toc-highlight">11.6. Storage Class</a><ul><li><a href="#1161-static-provisioning-of-volume" class="table-of-contents__link toc-highlight">11.6.1. Static Provisioning of Volume</a></li><li><a href="#1162-dynamic-provisioning-of-volume" class="table-of-contents__link toc-highlight">11.6.2. Dynamic Provisioning of Volume</a></li></ul></li><li><a href="#121-coredns" class="table-of-contents__link toc-highlight">12.1. CoreDNS</a></li><li><a href="#151-what-is-helm" class="table-of-contents__link toc-highlight">15.1. What is Helm</a></li><li><a href="#152-helm-components" class="table-of-contents__link toc-highlight">15.2. Helm Components</a></li><li><a href="#231-kubernetes" class="table-of-contents__link toc-highlight">23.1. Kubernetes</a></li><li><a href="#232-helm" class="table-of-contents__link toc-highlight">23.2. Helm</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">© 2025 - {m19v}</div></div></div></footer></div>
</body>
</html>