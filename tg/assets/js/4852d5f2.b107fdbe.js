"use strict";(globalThis.webpackChunkm_19_v=globalThis.webpackChunkm_19_v||[]).push([[251],{6709:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>a,contentTitle:()=>c,default:()=>h,frontMatter:()=>t,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"notes/software-engineering/kubernetes","title":"Kubernetes","description":"- 1. Table of Content","source":"@site/docs/notes/software-engineering/kubernetes.md","sourceDirName":"notes/software-engineering","slug":"/notes/software-engineering/kubernetes","permalink":"/tg/docs/notes/software-engineering/kubernetes","draft":false,"unlisted":false,"editUrl":"https://github.com/m19v/m19v.github.io/blob/main/docs/notes/software-engineering/kubernetes.md","tags":[],"version":"current","lastUpdatedBy":"m19v","lastUpdatedAt":1763977390000,"frontMatter":{"title":"Kubernetes"},"sidebar":"tutorialSidebar","previous":{"title":"Apache Kafka","permalink":"/tg/docs/notes/software-engineering/kafka"},"next":{"title":"Managing Security in Google Cloud","permalink":"/tg/docs/notes/software-engineering/managing-security-in-gc"}}');var s=r(4848),l=r(8453);const t={title:"Kubernetes"},c="1. Table of Content",a={},o=[{value:"5.1. Kubernetes Architecture",id:"51-kubernetes-architecture",level:2},{value:"5.2. Open Container Initiative (OCI)",id:"52-open-container-initiative-oci",level:2},{value:"5.3. Container Runtime Interface (CRI)",id:"53-container-runtime-interface-cri",level:2},{value:"5.4. Docker vs ContainerD",id:"54-docker-vs-containerd",level:2},{value:"5.4.1. Docker",id:"541-docker",level:3},{value:"5.4.2. ContainerD",id:"542-containerd",level:3},{value:"5.5. ETCD",id:"55-etcd",level:2},{value:"5.5.1. Get started quickly with ETCD",id:"551-get-started-quickly-with-etcd",level:3},{value:"5.5.2. ETCD in Kubernetes",id:"552-etcd-in-kubernetes",level:3},{value:"5.5.3. ETCD Setup - Manual vs kubeadm",id:"553-etcd-setup---manual-vs-kubeadm",level:3},{value:"5.6. Kube-API Server",id:"56-kube-api-server",level:2},{value:"5.7. Kube Controller Manager",id:"57-kube-controller-manager",level:2},{value:"5.7.1. Installation of Kube-Controller-Manager",id:"571-installation-of-kube-controller-manager",level:3},{value:"5.8. Kube Scheduler",id:"58-kube-scheduler",level:2},{value:"5.9. Kubelet",id:"59-kubelet",level:2},{value:"5.10. Kube Proxy",id:"510-kube-proxy",level:2},{value:"5.11. Pods",id:"511-pods",level:2},{value:"5.12. ReplicaSets",id:"512-replicasets",level:2},{value:"5.13. Labels and Selectors",id:"513-labels-and-selectors",level:2},{value:"5.14. Annotations",id:"514-annotations",level:2},{value:"5.15. Deployments",id:"515-deployments",level:2},{value:"5.16. Services",id:"516-services",level:2},{value:"5.16.1. ClusterIP",id:"5161-clusterip",level:3},{value:"5.16.2. NodePort",id:"5162-nodeport",level:3},{value:"5.16.3. LoadBalancer",id:"5163-loadbalancer",level:3},{value:"5.16.4. ExternalName",id:"5164-externalname",level:3},{value:"5.17. Namespaces",id:"517-namespaces",level:2},{value:"5.17.1. Resource Quota",id:"5171-resource-quota",level:3},{value:"5.18. Imperative vs. Declarative",id:"518-imperative-vs-declarative",level:2},{value:"6.1. Manual Scheduling",id:"61-manual-scheduling",level:2},{value:"6.1.1. Binding Object",id:"611-binding-object",level:3},{value:"6.2. Taints and Tolerations",id:"62-taints-and-tolerations",level:2},{value:"6.3. Node Selectors",id:"63-node-selectors",level:2},{value:"6.4. Node Affinity",id:"64-node-affinity",level:2},{value:"6.4.1. Node Affinity Types",id:"641-node-affinity-types",level:3},{value:"6.5. Taints and Tolerations vs Node Affinity",id:"65-taints-and-tolerations-vs-node-affinity",level:2},{value:"6.6. Resource Requirements and Limits",id:"66-resource-requirements-and-limits",level:2},{value:"6.6.1. Default Behaviour",id:"661-default-behaviour",level:3},{value:"6.6.2. Resource Requests",id:"662-resource-requests",level:3},{value:"6.6.3. Resource Limits",id:"663-resource-limits",level:3},{value:"6.6.4. LimitRange",id:"664-limitrange",level:3},{value:"6.6.5. ResourceQuota",id:"665-resourcequota",level:3},{value:"6.7. DeamonSets",id:"67-deamonsets",level:2},{value:"6.8. Static Pods",id:"68-static-pods",level:2},{value:"6.8.1. What is Static Pods",id:"681-what-is-static-pods",level:3},{value:"6.8.2. Static Pods in Cluster",id:"682-static-pods-in-cluster",level:3},{value:"6.8.3. Static Pods Use Case",id:"683-static-pods-use-case",level:3},{value:"6.8.4. Static Pods vs. DaemonSets",id:"684-static-pods-vs-daemonsets",level:3},{value:"6.9. Multiple Schedulers",id:"69-multiple-schedulers",level:2},{value:"6.10. Configuring Scheduler Profiles",id:"610-configuring-scheduler-profiles",level:2},{value:"6.11. Admission Controllers",id:"611-admission-controllers",level:2},{value:"6.12. Validating and Mutating Admission Controllers",id:"612-validating-and-mutating-admission-controllers",level:2},{value:"6.12.1. Validating Admission Controllers",id:"6121-validating-admission-controllers",level:3},{value:"6.12.2. Mutating Admission Controller",id:"6122-mutating-admission-controller",level:3},{value:"6.12.3. Custom Validating/Mutating Admission Controllers",id:"6123-custom-validatingmutating-admission-controllers",level:3},{value:"7.1. Monitor Cluster Components",id:"71-monitor-cluster-components",level:2},{value:"7.1.1. Tools",id:"711-tools",level:3},{value:"7.2. Managing Application Logs",id:"72-managing-application-logs",level:2},{value:"8.1. Rolling Updates and Rollbacks",id:"81-rolling-updates-and-rollbacks",level:2},{value:"8.1.1. Deployment Strategy",id:"811-deployment-strategy",level:3},{value:"8.2. Configure Applications",id:"82-configure-applications",level:2},{value:"8.2.1. Commands and Arguments in Docker and K8s",id:"821-commands-and-arguments-in-docker-and-k8s",level:3},{value:"8.2.2. Configuring Environment Variables in Applications",id:"822-configuring-environment-variables-in-applications",level:3},{value:"8.2.3. Configuring ConfigMaps in Applications",id:"823-configuring-configmaps-in-applications",level:3},{value:"8.2.4. Configure Secrets an Applications",id:"824-configure-secrets-an-applications",level:3},{value:"8.2.4.1. Create Secrets",id:"8241-create-secrets",level:4},{value:"8.2.4.2. Encrypting Secret Data at Rest",id:"8242-encrypting-secret-data-at-rest",level:4},{value:"8.2.4.3. Secret Store Providers",id:"8243-secret-store-providers",level:4},{value:"8.3. Scale Applications",id:"83-scale-applications",level:2},{value:"8.4. Multi Container Pods",id:"84-multi-container-pods",level:2},{value:"8.4.1. Multi-container Pods Design Patterns",id:"841-multi-container-pods-design-patterns",level:3},{value:"8.5. InitContainers",id:"85-initcontainers",level:2},{value:"8.6. Self Healing Applications",id:"86-self-healing-applications",level:2},{value:"8.7. Intro to Autoscaling",id:"87-intro-to-autoscaling",level:2},{value:"8.7.1. Scaling Cluster Infra vs Scaling Workloads",id:"871-scaling-cluster-infra-vs-scaling-workloads",level:3},{value:"8.7.2. Manual vs Automated Scaling",id:"872-manual-vs-automated-scaling",level:3},{value:"8.7.3. Horizontal Pod Autoscaler (HPA)",id:"873-horizontal-pod-autoscaler-hpa",level:3},{value:"8.7.3.1. Scaling a workload manually",id:"8731-scaling-a-workload-manually",level:4},{value:"8.7.3.2. HPA",id:"8732-hpa",level:4},{value:"8.7.4. Vertical Pod Autoscaling (VPA)",id:"874-vertical-pod-autoscaling-vpa",level:3},{value:"8.7.4.1. Deployment of VPA Components",id:"8741-deployment-of-vpa-components",level:4},{value:"8.7.5. In-place resize Pods",id:"875-in-place-resize-pods",level:3},{value:"8.7.5.1. Limitations",id:"8751-limitations",level:4},{value:"8.7.6. VPA vs. HPA",id:"876-vpa-vs-hpa",level:3},{value:"9.1. OS Upgrade",id:"91-os-upgrade",level:2},{value:"9.2. Kubernetes Software Versions",id:"92-kubernetes-software-versions",level:2},{value:"9.3. Cluster Upgrade Process",id:"93-cluster-upgrade-process",level:2},{value:"9.3.1. <code>kubeadm upgrade</code>",id:"931-kubeadm-upgrade",level:3},{value:"9.3.2. Cluster Upgrade - Demo",id:"932-cluster-upgrade---demo",level:3},{value:"9.3.3. Backup and Restore Methods",id:"933-backup-and-restore-methods",level:3},{value:"9.3.3.1. Backup Candidates",id:"9331-backup-candidates",level:4},{value:"10.1. Kubernetes Security Primitives",id:"101-kubernetes-security-primitives",level:2},{value:"10.1.1. Cluster Hosts Security",id:"1011-cluster-hosts-security",level:3},{value:"10.1.2. Kubernetes Security",id:"1012-kubernetes-security",level:3},{value:"10.1.3. TLS Certificates",id:"1013-tls-certificates",level:3},{value:"10.1.4. Application Communication within Cluster",id:"1014-application-communication-within-cluster",level:3},{value:"10.2. Authentication",id:"102-authentication",level:2},{value:"10.2.1. Users",id:"1021-users",level:3},{value:"10.2.1.1. Basic Authentication Mechanism - Static Password File",id:"10211-basic-authentication-mechanism---static-password-file",level:4},{value:"10.2.1.2. Basic Authentication Mechanism - Static Token File",id:"10212-basic-authentication-mechanism---static-token-file",level:4},{value:"10.2.2. Service Accounts",id:"1022-service-accounts",level:3},{value:"10.3. TLS Certificates in K8s",id:"103-tls-certificates-in-k8s",level:2},{value:"10.3.1. TLS Basics",id:"1031-tls-basics",level:3},{value:"10.3.1.1. Private vs Public Key",id:"10311-private-vs-public-key",level:4},{value:"10.3.1.2. Symmetric Encryption",id:"10312-symmetric-encryption",level:4},{value:"10.3.1.3. Asymmetric Encryption",id:"10313-asymmetric-encryption",level:4},{value:"10.3.1.4. Asymmetric Encryption - SSH",id:"10314-asymmetric-encryption---ssh",level:4},{value:"10.3.1.5. Asymmetric Encryption - HTTPS",id:"10315-asymmetric-encryption---https",level:4},{value:"10.3.1.6. Certificate Authority (CA)",id:"10316-certificate-authority-ca",level:4},{value:"10.3.1.7. Naming Convention of Public and Private Keys",id:"10317-naming-convention-of-public-and-private-keys",level:4},{value:"10.3.1.8. TLS Use Cases",id:"10318-tls-use-cases",level:4},{value:"10.3.2. TLS in Kubernetes",id:"1032-tls-in-kubernetes",level:3},{value:"10.3.3. TLS in Kubernetes - Certificate Creation",id:"1033-tls-in-kubernetes---certificate-creation",level:3},{value:"10.3.4. View Certificate Details",id:"1034-view-certificate-details",level:3},{value:"10.4. Certificate API",id:"104-certificate-api",level:2},{value:"10.4.1. Steps to generate certificate for a new User",id:"1041-steps-to-generate-certificate-for-a-new-user",level:3},{value:"10.5. KubeConfig",id:"105-kubeconfig",level:2},{value:"10.6. Persistent Key/Value Store",id:"106-persistent-keyvalue-store",level:2},{value:"10.7. API Group",id:"107-api-group",level:2},{value:"10.8. Authorization",id:"108-authorization",level:2},{value:"10.8.1. Authorization Modes",id:"1081-authorization-modes",level:3},{value:"10.8.2. Authorization Mechanisms",id:"1082-authorization-mechanisms",level:3},{value:"10.8.2.1. <strong>Node Authorizer</strong>",id:"10821-node-authorizer",level:4},{value:"10.8.2.2. <strong>ABAC</strong>",id:"10822-abac",level:4},{value:"10.8.2.3. <strong>RBAC</strong>",id:"10823-rbac",level:4},{value:"10.8.2.4. Webhook",id:"10824-webhook",level:4},{value:"10.8.3. RBAC",id:"1083-rbac",level:3},{value:"10.8.4. Cluster Roles and Role Bindings",id:"1084-cluster-roles-and-role-bindings",level:3},{value:"10.9. Service Accounts",id:"109-service-accounts",level:2},{value:"10.10. Image Security",id:"1010-image-security",level:2},{value:"10.11. Docker Security",id:"1011-docker-security",level:2},{value:"10.12. Security Context",id:"1012-security-context",level:2},{value:"10.13. Network Policies",id:"1013-network-policies",level:2},{value:"10.14. Kubectx and Kubens",id:"1014-kubectx-and-kubens",level:2},{value:"10.15. Custorm Resource Definition (CRD)",id:"1015-custorm-resource-definition-crd",level:2},{value:"10.16. Custom Controllers",id:"1016-custom-controllers",level:2},{value:"10.17. Operator Framework",id:"1017-operator-framework",level:2},{value:"11.1. Docker Storage",id:"111-docker-storage",level:2},{value:"11.1.1. Docker Storage Drivers and File Systems",id:"1111-docker-storage-drivers-and-file-systems",level:3},{value:"11.1.2. Volume Driver Plugins in Docker",id:"1112-volume-driver-plugins-in-docker",level:3},{value:"11.2. Container Interfaces",id:"112-container-interfaces",level:2},{value:"11.2.1. Container Storage Interface (CSI)",id:"1121-container-storage-interface-csi",level:3},{value:"11.3. Volumes",id:"113-volumes",level:2},{value:"11.3.1. Volumes and Mounts",id:"1131-volumes-and-mounts",level:3},{value:"11.3.2. Volume Types",id:"1132-volume-types",level:3},{value:"11.4. Persistent Volumes (PV)",id:"114-persistent-volumes-pv",level:2},{value:"11.5. Persistent Volume Claims (PVC)",id:"115-persistent-volume-claims-pvc",level:2},{value:"11.6. Storage Class",id:"116-storage-class",level:2},{value:"11.6.1. Static Provisioning of Volume",id:"1161-static-provisioning-of-volume",level:3},{value:"11.6.2. Dynamic Provisioning of Volume",id:"1162-dynamic-provisioning-of-volume",level:3},{value:"12.1. CoreDNS",id:"121-coredns",level:2},{value:"15.1. What is Helm",id:"151-what-is-helm",level:2},{value:"15.2. Helm Components",id:"152-helm-components",level:2},{value:"23.1. Kubernetes",id:"231-kubernetes",level:2},{value:"23.2. Helm",id:"232-helm",level:2}];function d(e){const n={a:"a",blockquote:"blockquote",br:"br",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"1-table-of-content",children:"1. Table of Content"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#1-table-of-content",children:"1. Table of Content"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#2-intro",children:"2. Intro"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#3-certification",children:"3. Certification"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#4-cka-lecture-and-lab-notes",children:"4. CKA Lecture and Lab Notes"})}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"#5-core-concepts",children:"5. Core Concepts"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#51-kubernetes-architecture",children:"5.1. Kubernetes Architecture"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#52-open-container-initiative-oci",children:"5.2. Open Container Initiative (OCI)"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#53-container-runtime-interface-cri",children:"5.3. Container Runtime Interface (CRI)"})}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"#54-docker-vs-containerd",children:"5.4. Docker vs ContainerD"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#541-docker",children:"5.4.1. Docker"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#542-containerd",children:"5.4.2. ContainerD"})}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"#55-etcd",children:"5.5. ETCD"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#551-get-started-quickly-with-etcd",children:"5.5.1. Get started quickly with ETCD"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#552-etcd-in-kubernetes",children:"5.5.2. ETCD in Kubernetes"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#553-etcd-setup---manual-vs-kubeadm",children:"5.5.3. ETCD Setup - Manual vs kubeadm"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#56-kube-api-server",children:"5.6. Kube-API Server"})}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"#57-kube-controller-manager",children:"5.7. Kube Controller Manager"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#571-installation-of-kube-controller-manager",children:"5.7.1. Installation of Kube-Controller-Manager"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#58-kube-scheduler",children:"5.8. Kube Scheduler"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#59-kubelet",children:"5.9. Kubelet"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#510-kube-proxy",children:"5.10. Kube Proxy"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#511-pods",children:"5.11. Pods"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#512-replicasets",children:"5.12. ReplicaSets"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#513-labels-and-selectors",children:"5.13. Labels and Selectors"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#514-annotations",children:"5.14. Annotations"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#515-deployments",children:"5.15. Deployments"})}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"#516-services",children:"5.16. Services"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#5161-clusterip",children:"5.16.1. ClusterIP"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#5162-nodeport",children:"5.16.2. NodePort"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#5163-loadbalancer",children:"5.16.3. LoadBalancer"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#5164-externalname",children:"5.16.4. ExternalName"})}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"#517-namespaces",children:"5.17. Namespaces"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#5171-resource-quota",children:"5.17.1. Resource Quota"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#518-imperative-vs-declarative",children:"5.18. Imperative vs. Declarative"})}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"#6-scheduling",children:"6. Scheduling"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"#61-manual-scheduling",children:"6.1. Manual Scheduling"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#611-binding-object",children:"6.1.1. Binding Object"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#62-taints-and-tolerations",children:"6.2. Taints and Tolerations"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#63-node-selectors",children:"6.3. Node Selectors"})}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"#64-node-affinity",children:"6.4. Node Affinity"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#641-node-affinity-types",children:"6.4.1. Node Affinity Types"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#65-taints-and-tolerations-vs-node-affinity",children:"6.5. Taints and Tolerations vs Node Affinity"})}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"#66-resource-requirements-and-limits",children:"6.6. Resource Requirements and Limits"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#661-default-behaviour",children:"6.6.1. Default Behaviour"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#662-resource-requests",children:"6.6.2. Resource Requests"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#663-resource-limits",children:"6.6.3. Resource Limits"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#664-limitrange",children:"6.6.4. LimitRange"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#665-resourcequota",children:"6.6.5. ResourceQuota"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#67-deamonsets",children:"6.7. DeamonSets"})}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"#68-static-pods",children:"6.8. Static Pods"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#681-what-is-static-pods",children:"6.8.1. What is Static Pods"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#682-static-pods-in-cluster",children:"6.8.2. Static Pods in Cluster"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#683-static-pods-use-case",children:"6.8.3. Static Pods Use Case"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#684-static-pods-vs-daemonsets",children:"6.8.4. Static Pods vs. DaemonSets"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#69-multiple-schedulers",children:"6.9. Multiple Schedulers"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#610-configuring-scheduler-profiles",children:"6.10. Configuring Scheduler Profiles"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#611-admission-controllers",children:"6.11. Admission Controllers"})}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"#612-validating-and-mutating-admission-controllers",children:"6.12. Validating and Mutating Admission Controllers"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#6121-validating-admission-controllers",children:"6.12.1. Validating Admission Controllers"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#6122-mutating-admission-controller",children:"6.12.2. Mutating Admission Controller"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#6123-custom-validatingmutating-admission-controllers",children:"6.12.3. Custom Validating/Mutating Admission Controllers"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"#7-logging-and-monitoring",children:"7. Logging and Monitoring"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"#71-monitor-cluster-components",children:"7.1. Monitor Cluster Components"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#711-tools",children:"7.1.1. Tools"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#72-managing-application-logs",children:"7.2. Managing Application Logs"})}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"#8-application-lifecycle-management",children:"8. Application Lifecycle Management"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"#81-rolling-updates-and-rollbacks",children:"8.1. Rolling Updates and Rollbacks"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#811-deployment-strategy",children:"8.1.1. Deployment Strategy"})}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"#82-configure-applications",children:"8.2. Configure Applications"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#821-commands-and-arguments-in-docker-and-k8s",children:"8.2.1. Commands and Arguments in Docker and K8s"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#822-configuring-environment-variables-in-applications",children:"8.2.2. Configuring Environment Variables in Applications"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#823-configuring-configmaps-in-applications",children:"8.2.3. Configuring ConfigMaps in Applications"})}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"#824-configure-secrets-an-applications",children:"8.2.4. Configure Secrets an Applications"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#8241-create-secrets",children:"8.2.4.1. Create Secrets"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#8242-encrypting-secret-data-at-rest",children:"8.2.4.2. Encrypting Secret Data at Rest"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#8243-secret-store-providers",children:"8.2.4.3. Secret Store Providers"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#83-scale-applications",children:"8.3. Scale Applications"})}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"#84-multi-container-pods",children:"8.4. Multi Container Pods"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#841-multi-container-pods-design-patterns",children:"8.4.1. Multi-container Pods Design Patterns"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#85-initcontainers",children:"8.5. InitContainers"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#86-self-healing-applications",children:"8.6. Self Healing Applications"})}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"#87-intro-to-autoscaling",children:"8.7. Intro to Autoscaling"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#871-scaling-cluster-infra-vs-scaling-workloads",children:"8.7.1. Scaling Cluster Infra vs Scaling Workloads"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#872-manual-vs-automated-scaling",children:"8.7.2. Manual vs Automated Scaling"})}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"#873-horizontal-pod-autoscaler-hpa",children:"8.7.3. Horizontal Pod Autoscaler (HPA)"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#8731-scaling-a-workload-manually",children:"8.7.3.1. Scaling a workload manually"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#8732-hpa",children:"8.7.3.2. HPA"})}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"#874-vertical-pod-autoscaling-vpa",children:"8.7.4. Vertical Pod Autoscaling (VPA)"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#8741-deployment-of-vpa-components",children:"8.7.4.1. Deployment of VPA Components"})}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"#875-in-place-resize-pods",children:"8.7.5. In-place resize Pods"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#8751-limitations",children:"8.7.5.1. Limitations"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#876-vpa-vs-hpa",children:"8.7.6. VPA vs. HPA"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"#9-cluster-maintenance",children:"9. Cluster Maintenance"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#91-os-upgrade",children:"9.1. OS Upgrade"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#92-kubernetes-software-versions",children:"9.2. Kubernetes Software Versions"})}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"#93-cluster-upgrade-process",children:"9.3. Cluster Upgrade Process"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsxs)(n.a,{href:"#931-kubeadm-upgrade",children:["9.3.1. ",(0,s.jsx)(n.code,{children:"kubeadm upgrade"})]})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#932-cluster-upgrade---demo",children:"9.3.2. Cluster Upgrade - Demo"})}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"#933-backup-and-restore-methods",children:"9.3.3. Backup and Restore Methods"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#9331-backup-candidates",children:"9.3.3.1. Backup Candidates"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"#10-security",children:"10. Security"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"#101-kubernetes-security-primitives",children:"10.1. Kubernetes Security Primitives"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#1011-cluster-hosts-security",children:"10.1.1. Cluster Hosts Security"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#1012-kubernetes-security",children:"10.1.2. Kubernetes Security"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#1013-tls-certificates",children:"10.1.3. TLS Certificates"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#1014-application-communication-within-cluster",children:"10.1.4. Application Communication within Cluster"})}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"#102-authentication",children:"10.2. Authentication"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"#1021-users",children:"10.2.1. Users"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#10211-basic-authentication-mechanism---static-password-file",children:"10.2.1.1. Basic Authentication Mechanism - Static Password File"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#10212-basic-authentication-mechanism---static-token-file",children:"10.2.1.2. Basic Authentication Mechanism - Static Token File"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#1022-service-accounts",children:"10.2.2. Service Accounts"})}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"#103-tls-certificates-in-k8s",children:"10.3. TLS Certificates in K8s"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"#1031-tls-basics",children:"10.3.1. TLS Basics"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#10311-private-vs-public-key",children:"10.3.1.1. Private vs Public Key"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#10312-symmetric-encryption",children:"10.3.1.2. Symmetric Encryption"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#10313-asymmetric-encryption",children:"10.3.1.3. Asymmetric Encryption"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#10314-asymmetric-encryption---ssh",children:"10.3.1.4. Asymmetric Encryption - SSH"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#10315-asymmetric-encryption---https",children:"10.3.1.5. Asymmetric Encryption - HTTPS"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#10316-certificate-authority-ca",children:"10.3.1.6. Certificate Authority (CA)"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#10317-naming-convention-of-public-and-private-keys",children:"10.3.1.7. Naming Convention of Public and Private Keys"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#10318-tls-use-cases",children:"10.3.1.8. TLS Use Cases"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#1032-tls-in-kubernetes",children:"10.3.2. TLS in Kubernetes"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#1033-tls-in-kubernetes---certificate-creation",children:"10.3.3. TLS in Kubernetes - Certificate Creation"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#1034-view-certificate-details",children:"10.3.4. View Certificate Details"})}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"#104-certificate-api",children:"10.4. Certificate API"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#1041-steps-to-generate-certificate-for-a-new-user",children:"10.4.1. Steps to generate certificate for a new User"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#105-kubeconfig",children:"10.5. KubeConfig"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#106-persistent-keyvalue-store",children:"10.6. Persistent Key/Value Store"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#107-api-group",children:"10.7. API Group"})}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"#108-authorization",children:"10.8. Authorization"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#1081-authorization-modes",children:"10.8.1. Authorization Modes"})}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"#1082-authorization-mechanisms",children:"10.8.2. Authorization Mechanisms"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsxs)(n.a,{href:"#10821-node-authorizer",children:["10.8.2.1. ",(0,s.jsx)(n.strong,{children:"Node Authorizer"})]})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsxs)(n.a,{href:"#10822-abac",children:["10.8.2.2. ",(0,s.jsx)(n.strong,{children:"ABAC"})]})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsxs)(n.a,{href:"#10823-rbac",children:["10.8.2.3. ",(0,s.jsx)(n.strong,{children:"RBAC"})]})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#10824-webhook",children:"10.8.2.4. Webhook"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#1083-rbac",children:"10.8.3. RBAC"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#1084-cluster-roles-and-role-bindings",children:"10.8.4. Cluster Roles and Role Bindings"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#109-service-accounts",children:"10.9. Service Accounts"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#1010-image-security",children:"10.10. Image Security"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#1011-docker-security",children:"10.11. Docker Security"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#1012-security-context",children:"10.12. Security Context"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#1013-network-policies",children:"10.13. Network Policies"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#1014-kubectx-and-kubens",children:"10.14. Kubectx and Kubens"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#1015-custorm-resource-definition-crd",children:"10.15. Custorm Resource Definition (CRD)"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#1016-custom-controllers",children:"10.16. Custom Controllers"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#1017-operator-framework",children:"10.17. Operator Framework"})}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"#11-storage",children:"11. Storage"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"#111-docker-storage",children:"11.1. Docker Storage"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#1111-docker-storage-drivers-and-file-systems",children:"11.1.1. Docker Storage Drivers and File Systems"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#1112-volume-driver-plugins-in-docker",children:"11.1.2. Volume Driver Plugins in Docker"})}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"#112-container-interfaces",children:"11.2. Container Interfaces"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#1121-container-storage-interface-csi",children:"11.2.1. Container Storage Interface (CSI)"})}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"#113-volumes",children:"11.3. Volumes"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#1131-volumes-and-mounts",children:"11.3.1. Volumes and Mounts"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#1132-volume-types",children:"11.3.2. Volume Types"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#114-persistent-volumes-pv",children:"11.4. Persistent Volumes (PV)"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#115-persistent-volume-claims-pvc",children:"11.5. Persistent Volume Claims (PVC)"})}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"#116-storage-class",children:"11.6. Storage Class"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#1161-static-provisioning-of-volume",children:"11.6.1. Static Provisioning of Volume"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#1162-dynamic-provisioning-of-volume",children:"11.6.2. Dynamic Provisioning of Volume"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"#12-networking",children:"12. Networking"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#121-coredns",children:"12.1. CoreDNS"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#13-design-and-install-a-kubernetes-cluster",children:"13. Design and Install a Kubernetes Cluster"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#14-install-k8s-the-kubeadm-way",children:'14. Install "K8s the kubeadm way"'})}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"#15-helm-basics",children:"15. Helm Basics"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#151-what-is-helm",children:"15.1. What is Helm"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#152-helm-components",children:"15.2. Helm Components"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#16-kustomize-basics",children:"16. Kustomize Basics"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#17-end-to-end-tests-on-a-k8s-cluster",children:"17. End to End tests on a K8s Cluster"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#18-troubleshooting",children:"18. Troubleshooting"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#19-other-topics",children:"19. Other Topics"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#20-ligtning-labs",children:"20. Ligtning Labs"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#21-mock-exams",children:"21. Mock Exams"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#22-course-conclusion",children:"22. Course Conclusion"})}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"#23-commands",children:"23. Commands"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#231-kubernetes",children:"23.1. Kubernetes"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#232-helm",children:"23.2. Helm"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#24-references",children:"24. References"})}),"\n"]}),"\n",(0,s.jsx)(n.h1,{id:"2-intro",children:"2. Intro"}),"\n",(0,s.jsx)(n.p,{children:"This document contains my notes on preparation course of Certified Kubernetes Administrators (CKA) Certification by Mumshad Mannambeth."}),"\n",(0,s.jsx)(n.h1,{id:"3-certification",children:"3. Certification"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://www.cncf.io/certification/cka/",children:"Certified Kubernetes Administrator"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://github.com/cncf/curriculum",children:"Exam Curriculum (Topics)"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://www.cncf.io/certification/candidate-handbook",children:"Candidate Handbook"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"http://training.linuxfoundation.org/go//Important-Tips-CKA-CKAD",children:"Exam Tips"})}),"\n"]}),"\n",(0,s.jsx)(n.h1,{id:"4-cka-lecture-and-lab-notes",children:"4. CKA Lecture and Lab Notes"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://github.com/kodekloudhub/certified-kubernetes-administrator-course",children:"Certified Kubernetes Administrator (CKA) Course"})}),"\n"]}),"\n",(0,s.jsx)(n.h1,{id:"5-core-concepts",children:"5. Core Concepts"}),"\n",(0,s.jsx)(n.h2,{id:"51-kubernetes-architecture",children:"5.1. Kubernetes Architecture"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Worker Nodes: hosts application as containers","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Worker Nodes Components:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"kubelet: is an agent which runs on Worker Nodes"}),"\n",(0,s.jsx)(n.li,{children:"kube-proxy: is a service responsible for networking on Worker Nodes"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["Master Node: manage, plan schedule, monitor etc. nodes using Control Plane Components","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Control Plane Components:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"kube-apiserver: is responsible for orchestration of all operations within k8s cluster Control Plane Components"}),"\n",(0,s.jsx)(n.li,{children:"ETCD Cluster: is a database which stores information in a key-value format"}),"\n",(0,s.jsx)(n.li,{children:"kube-scheduler: identifies right node based on containers resource requirements"}),"\n",(0,s.jsxs)(n.li,{children:["Controller-Manager","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Node-Controller"}),"\n",(0,s.jsx)(n.li,{children:"Replication-Controller"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"52-open-container-initiative-oci",children:"5.2. Open Container Initiative (OCI)"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"imagespec"}),": specifications how container image must be built"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"runtimespec"}),": specifications how conainer runtime should be developed"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"53-container-runtime-interface-cri",children:"5.3. Container Runtime Interface (CRI)"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Kubernetes introduced ",(0,s.jsx)(n.strong,{children:"Container Runtime Interface (CRI)"})," which allows any vendor to work as container runtime as long as it adheres to ",(0,s.jsx)(n.strong,{children:"OCI"})," specification and not only Docker which used initially ",(0,s.jsx)(n.strong,{children:"dockershim"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["Starting from version ",(0,s.jsx)(n.strong,{children:"v1.24"})," Kubernetes deleted ",(0,s.jsx)(n.strong,{children:"dockershim"})," and Docker support"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"54-docker-vs-containerd",children:"5.4. Docker vs ContainerD"}),"\n",(0,s.jsx)(n.h3,{id:"541-docker",children:"5.4.1. Docker"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Docker is not only container runtime, but also consist of multiple tools","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"CLI"}),"\n",(0,s.jsx)(n.li,{children:"API"}),"\n",(0,s.jsx)(n.li,{children:"BUILD"}),"\n",(0,s.jsx)(n.li,{children:"Volumes"}),"\n",(0,s.jsx)(n.li,{children:"AUTH"}),"\n",(0,s.jsx)(n.li,{children:"SECURITY"}),"\n",(0,s.jsx)(n.li,{children:"ContainerD"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:"Docker uses container runtime ContainerD"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"542-containerd",children:"5.4.2. ContainerD"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"ContainerD is part of Cloud Native Computing Foundation (CNCF)"}),"\n",(0,s.jsx)(n.li,{children:"ContainerD is a higher-level tool that manages the entire lifecycle of containers."}),"\n",(0,s.jsx)(n.li,{children:"ContainerD is a deamon which manages runc and compatable with Container Runtime Interface (CRI)"}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"runc"})," is a container runtime"]}),"\n",(0,s.jsx)(n.li,{children:"ContainerD works as container runtime on its own separate from Docker"}),"\n",(0,s.jsxs)(n.li,{children:["ContainerD comes with ",(0,s.jsx)(n.code,{children:"crt"})," CLI tool mainly made for debugging container. ",(0,s.jsx)(n.code,{children:"nerdctl"})," (similar to docker CLI) provides stable and humand-friendly user experience"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"crictl"})," is another CLI tool from k8s community compatable with CRI which works accross different container runtime. Mainly used for debugging"]}),"\n",(0,s.jsxs)(n.li,{children:["Read ",(0,s.jsx)(n.a,{href:"https://github.com/containerd/containerd/blob/main/docs/getting-started.md",children:"more"})]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"55-etcd",children:"5.5. ETCD"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"ETCD"})," is a distributed reliable key-value store that is simple, secure and fast"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Key-Value Store"})," stores information if form of documents, pages (i.e. files) which can be in any format and structure"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"551-get-started-quickly-with-etcd",children:"5.5.1. Get started quickly with ETCD"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Download the relevant binary for your operating system from github releases page (",(0,s.jsx)(n.a,{href:"https://github.com/etcd-io/etcd/releases",children:"https://github.com/etcd-io/etcd/releases"}),")"]}),"\n",(0,s.jsx)(n.p,{children:"For Example: To download ETCD v3.5.6, run the below curl command"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"$ curl -LO https://github.com/etcd-io/etcd/releases/download/v3.5.6/etcd-v3.5.6-linux-amd64.tar.gz\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Extract it."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"$ tar xvzf etcd-v3.5.6-linux-amd64.tar.gz\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Run the ETCD Service"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"$ ./etcd\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["When you start ",(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"ETCD"})})," it will by default listen on port ",(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"2379"})})]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["The default client that comes with ",(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"ETCD"})})," is the ",(0,s.jsx)(n.a,{href:"https://github.com/etcd-io/etcd/tree/main/etcdctl",children:(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"etcdctl"})})})," client. You can use it to store and retrieve key-value pairs."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"Syntax: To Store a Key-Value pair\r\n$ ./etcdctl put key1 value1\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"Syntax: To retrieve the stored data\r\n$ ./etcdctl get key1\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:'Syntax: To view more commands. Run etcdctl without any arguments\r\n$ ./etcdctl\r\n\r\n# etcdctl command in API 3 version\r\netcdctl snapshot save \r\netcdctl endpoint health\r\netcdctl get\r\netcdctl put\r\n\r\nexport ETCDCTL_API=3           # set the environment variable ETCDCTL_API for desired API version\r\n\r\n# Certs for ETCDCTL to authenticate to the ETCD API Server\r\n--cacert /etc/kubernetes/pki/etcd/ca.crt     \r\n--cert /etc/kubernetes/pki/etcd/server.crt     \r\n--key /etc/kubernetes/pki/etcd/server.key\r\n\r\n# Example: \r\nkubectl exec etcd-master -n kube-system -- sh -c "ETCDCTL_API=3 etcdctl get / --prefix --keys-only --limit=10 --cacert /etc/kubernetes/pki/etcd/ca.crt --cert /etc/kubernetes/pki/etcd/server.crt  --key /etc/kubernetes/pki/etcd/server.key" \r\n\n'})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"552-etcd-in-kubernetes",children:"5.5.2. ETCD in Kubernetes"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.strong,{children:"ETCD Datastore"})," stores following cluster information:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Nodes"}),"\n",(0,s.jsx)(n.li,{children:"PODS"}),"\n",(0,s.jsx)(n.li,{children:"Configs"}),"\n",(0,s.jsx)(n.li,{children:"Secrets"}),"\n",(0,s.jsx)(n.li,{children:"Accounts"}),"\n",(0,s.jsx)(n.li,{children:"Roles"}),"\n",(0,s.jsx)(n.li,{children:"Bindings"}),"\n",(0,s.jsx)(n.li,{children:"Others"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"kubectl get"})," command retrieves all information from the ",(0,s.jsx)(n.strong,{children:"ETCD Server"})]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"553-etcd-setup---manual-vs-kubeadm",children:"5.5.3. ETCD Setup - Manual vs kubeadm"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Read ",(0,s.jsx)(n.a,{href:"https://github.com/kodekloudhub/certified-kubernetes-administrator-course/blob/master/docs/02-Core-Concepts/05-ETCD-in-Kubernetes.md",children:"more"})]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"56-kube-api-server",children:"5.6. Kube-API Server"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Kube-API Server"})," is a primary management component in K8s"]}),"\n",(0,s.jsxs)(n.li,{children:["kube-api server performs following actions when  ",(0,s.jsx)(n.code,{children:"kubectl"})," command is executed:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Authenticate User"}),"\n",(0,s.jsx)(n.li,{children:"Validate Request"}),"\n",(0,s.jsx)(n.li,{children:"Retrieve dataf"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["Read ",(0,s.jsx)(n.a,{href:"https://github.com/kodekloudhub/certified-kubernetes-administrator-course/blob/master/docs/02-Core-Concepts/06-Kube-API-Server.md",children:"more"})]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"57-kube-controller-manager",children:"5.7. Kube Controller Manager"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Kube Controller Manager"})," manages various controllers in kubernetes"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Controller"})," is a process that continuously monitors the state of the components within the system and ensures the whole system to have the desired functioning state"]}),"\n",(0,s.jsxs)(n.li,{children:["Controllers:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Node Controller"})," - monitors health of Nodes every ",(0,s.jsx)(n.code,{children:"5s"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"Node Monitor Period = 5s"})}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"Node Monitor Grace Period = 40s"})," (i.e. waits 40s before marking it as unreachable)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"POD Eviction Timeout = 5m"})," (i.e. waits 5m to come back up if unreachable before removing pods and provisioning resources to the healthy nodes if it is part of replica set)"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Replication Controller"})," - monitors state of replica sets"]}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Deployment Controller"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Namespace Controller"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Endpoint-Controller"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"CronJob"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Job Controller"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"PV Protection Controller"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Service Account Controller"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Stateful Set"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Replica Set"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"PV Binder Controller"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"571-installation-of-kube-controller-manager",children:"5.7.1. Installation of Kube-Controller-Manager"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Read ",(0,s.jsx)(n.a,{href:"https://github.com/kodekloudhub/certified-kubernetes-administrator-course/blob/master/docs/02-Core-Concepts/07-Kube-Controller-Manager.md",children:"more"})]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"58-kube-scheduler",children:"5.8. Kube Scheduler"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"kube-scheduler"})," is responsible for scheduling pods on nodes. The kube-scheduler is only responsible for deciding which pod goes on which node depending on certain criteria (e.g. ",(0,s.jsx)(n.strong,{children:"Filter Nodes"}),", ",(0,s.jsx)(n.strong,{children:"Rank Nodes"}),"). It doesn't actually place the pod on the nodes, that's the job of the ",(0,s.jsx)(n.code,{children:"kubelet"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["Read ",(0,s.jsx)(n.a,{href:"https://github.com/kodekloudhub/certified-kubernetes-administrator-course/blob/master/docs/02-Core-Concepts/08-Kube-Scheduler.md",children:"more"})]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"59-kubelet",children:"5.9. Kubelet"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"kubelet"})," is a node agent which is responsible for creating the pods on the nodes and the sole point of contact for the kubernetes cluster"]}),"\n",(0,s.jsx)(n.li,{children:"kubelet also collects reports and sends regularly to master node"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"510-kube-proxy",children:"5.10. Kube Proxy"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"POD Network"})," is an internal virtual network that spans across all nodes in the cluster to which all pods are connected. Within k8s cluster every pod can reach every other pod which is accomplished by deploying networking solution, i.e. POD Network."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"kube-proxy"})," is a network component in Kubernetes that helps manage network communication to and from the Pods in a k8s cluster. Key function of kube-proxy:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Traffic Routing"}),"\n",(0,s.jsx)(n.li,{children:"Load Balancing"}),"\n",(0,s.jsx)(n.li,{children:"Service Discovery"}),"\n",(0,s.jsx)(n.li,{children:"Protocol Support"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"511-pods",children:"5.11. Pods"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Pod"})," is a logical host for one or more containers that are deployed together on the same host"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"# Example of Pod definition with YAML\r\n\r\napiVersion: v1\r\nkind: Pod               \r\nmetadata:                       # dictionary\r\n    name: myapp-pod\r\n    namespace: dev\r\n    labels:                     # under labels custom key:value allowed\r\n        app: myapp\r\n        type: front-end\r\n\r\nspec:                           # dictionary\r\n    containers:                 # list/array\r\n        - name: nginx-controller\r\n          image: nginx\r\n\n"})}),"\n",(0,s.jsx)(n.h2,{id:"512-replicasets",children:"5.12. ReplicaSets"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"ReplicaSet"})," and ",(0,s.jsx)(n.strong,{children:"ReplicationController"})," (deprecated in favor of ReplicaSet) are both Kubernetes resources for managing pod replication to ensure a specified number of pod replicas running at any given time"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"# Example of ReplicationController definition with YAML\r\n\r\napiVersion: v1\r\nkind: ReplicationController\r\nmetadata:                       # dictionary\r\n    name: myapp-rc\r\n    namespace: dev\r\n    labels:                     # under labels custom key:value allowed\r\n        app: myapp\r\n        type: front-end\r\n\r\nspec:                           # dictionary\r\n    template:                   # Pod template for replication\r\n        metadata:                       \r\n            name: myapp-pod\r\n            labels:                     \r\n                app: myapp\r\n                type: front-end\r\n\r\n        spec:                           \r\n            containers:                 \r\n                - name: nginx-controller\r\n                image: nginx\r\n    \r\n    replicas: 3\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"# Example of ReplicaSet definition with YAML\r\n\r\napiVersion: apps/v1\r\nkind: ReplicaSet\r\nmetadata:                       # dictionary\r\n    name: myapp-rs\r\n    namespace: dev\r\n    labels:                     # under labels custom key:value allowed\r\n        app: myapp\r\n        type: front-end\r\n\r\nspec:                           # dictionary\r\n    template:                   # Pod template for replication\r\n        metadata:                       \r\n            name: myapp-pod\r\n            labels:                     \r\n                app: myapp\r\n                type: front-end\r\n\r\n        spec:                           \r\n            containers:                 \r\n                - name: nginx-controller\r\n                image: nginx\r\n    \r\n    replicas: 3\r\n    selector:                   # Major difference from ReplicationController\r\n        matchLabels:\r\n            type: front-end     # To select all existing Pods matching defined label\n"})}),"\n",(0,s.jsx)(n.h2,{id:"513-labels-and-selectors",children:"5.13. Labels and Selectors"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Labels"})," are ",(0,s.jsx)(n.em,{children:"key/value"})," pairs that are attached to objects such as Pods for categorizing resources."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Selectors"})," are ",(0,s.jsx)(n.em,{children:"queries"})," to filter resources based on ",(0,s.jsx)(n.em,{children:"labels"}),"."]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"514-annotations",children:"5.14. Annotations"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Annotations"})," are key-value pairs that can be attached to various Kubernetes objects (e.g. pods, services, deployments etc.) to store arbitrary metadata that is not used for identification or selection."]}),"\n",(0,s.jsxs)(n.li,{children:["Usage of Annotations:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Storing build or version information"}),"\n",(0,s.jsx)(n.li,{children:"Providing links to documentation or related resources"}),"\n",(0,s.jsx)(n.li,{children:"Specifying configuration options for tools that interact with the resource (e.g., deployment tools, monitoring systems)"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"515-deployments",children:"5.15. Deployments"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Deployment"})," is a higher-level abstraction that manages a ReplicaSet, which in turn manages the Pods."]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"# Example of Deployment definition with YAML\r\n\r\napiVersion: apps/v1\r\nkind: Deployment\r\nmetadata:                       # dictionary\r\n    name: myapp-rs\r\n    namespace: dev\r\n    labels:                     # under labels custom key:value allowed\r\n        app: myapp\r\n        type: front-end\r\n\r\nspec:                           # dictionary\r\n    template:                   # Pod template for replication\r\n        metadata:                       \r\n            name: myapp-pod\r\n            labels:                     \r\n                app: myapp\r\n                type: front-end\r\n\r\n        spec:                           \r\n            containers:                 \r\n                - name: nginx-controller\r\n                image: nginx\r\n    \r\n    replicas: 3\r\n    selector:                   \r\n        matchLabels:\r\n            type: front-end     # To select all existing Pods matching defined label\n"})}),"\n",(0,s.jsx)(n.h2,{id:"516-services",children:"5.16. Services"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Service"})," is used to expose a set of Pods and enable communication between them"]}),"\n",(0,s.jsx)(n.li,{children:"Services enable communication between different components of an application, allowing Pods to discover and interact with each other reliably"}),"\n",(0,s.jsx)(n.li,{children:"There are different types of Services, each serving a specific purpose"}),"\n",(0,s.jsxs)(n.li,{children:["Service acts as built-in ",(0,s.jsx)(n.em,{children:"load balancer"})," to distribute load across different Pods (",(0,s.jsx)(n.code,{children:"Algorithm: Random, SessionAffinity: Yes"}),")"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"5161-clusterip",children:"5.16.1. ClusterIP"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"This is the default service type"}),"\n",(0,s.jsx)(n.li,{children:"It exposes the service on a cluster-internal IP"}),"\n",(0,s.jsx)(n.li,{children:"Only accessible from within the cluste"}),"\n",(0,s.jsx)(n.li,{children:"Useful for internal communication between services"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"# Example of Service of type ClusterIP definition with YAML\r\n\r\napiVersion: v1\r\nkind: Service               \r\nmetadata:                       # dictionary\r\n    name: back-end\r\n    namespace: dev\r\n\r\nspec:\r\n    type: ClusterIP\r\n    ports:\r\n      - port: 80                # The port that the service will expose\r\n        targetPort: 8080        # The port on the pod that the service should forward to\r\n    selector:\r\n        app: myapp\r\n        type: back-end\r\n\n"})}),"\n",(0,s.jsx)(n.h3,{id:"5162-nodeport",children:"5.16.2. NodePort"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Service of type NodePort listens on the static port of each node's IP address in cluster and forward request to the Pods"}),"\n",(0,s.jsxs)(n.li,{children:["Node's port range ",(0,s.jsx)(n.code,{children:"30 000 to 32 767"})]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"# Example of Service of type NodePort definition with YAML\r\n\r\napiVersion: v1\r\nkind: Service               \r\nmetadata:                       # dictionary\r\n    name: myapp-service\r\n    namespace: dev\r\n\r\nspec:\r\n    type: NodePort\r\n    ports:\r\n      - port: 80                # The port that the service will expose\r\n        targetPort: 8080        # The port on the pod that the service should forward to\r\n        nodePort: 30008         # The port on each node that will forward to the service\r\n    selector:\r\n        app: myapp\r\n        type: front-end\n"})}),"\n",(0,s.jsx)(n.h3,{id:"5163-loadbalancer",children:"5.16.3. LoadBalancer"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Creates an external load balancer (if supported by the cloud provider)"}),"\n",(0,s.jsx)(n.li,{children:"Automatically assigns a public IP address to the service"}),"\n",(0,s.jsx)(n.li,{children:"Distributes incoming traffic across multiple nodes"}),"\n",(0,s.jsx)(n.li,{children:"Ideal for production environments where you need to handle large amounts of traffic"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"# Example of Service of type LoadBalancer definition with YAML\r\n\r\napiVersion: v1\r\nkind: Service               \r\nmetadata:                       # dictionary\r\n    name: myapp-service\r\n    namespace: dev\r\n\r\nspec:\r\n    type: LoadBalancer\r\n    ports:\r\n      - port: 80                # The port that the service will expose\r\n        targetPort: 8080        # The port on the pod that the service should forward to\r\n        nodePort: 30008         # The port on each node that will forward to the service\r\n\n"})}),"\n",(0,s.jsx)(n.h3,{id:"5164-externalname",children:"5.16.4. ExternalName"}),"\n",(0,s.jsx)(n.h2,{id:"517-namespaces",children:"5.17. Namespaces"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Namespace"})," is a way to organize and manage resources within a cluster which provides a mechanism for isolating groups of resources"]}),"\n",(0,s.jsxs)(n.li,{children:["Key Points of Namespaces:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Isolation"}),"\n",(0,s.jsx)(n.li,{children:"Resource Management"}),"\n",(0,s.jsx)(n.li,{children:"Access Control"}),"\n",(0,s.jsx)(n.li,{children:"Resource Quotas"}),"\n",(0,s.jsx)(n.li,{children:"Network Policies"}),"\n",(0,s.jsx)(n.li,{children:"Scoped Resources"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Info:"})," A pattern to access a service in a different namespace using DNS:"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"<service-name>.<namespace>.svc.cluster.local"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"<service-name>"}),": name of the service to access"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"<namespace>"}),": namespace where the service is located"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"svc"}),": indicates that a service being accessed"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"cluster.local"}),": default domain name for services in the k8s cluster (can be customized)"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"# Example of Namespace definition with YAML\r\n\r\napiVersion: v1\r\nkind: Namespace\r\nmetadata:\r\n    name: dev\n"})}),"\n",(0,s.jsx)(n.h3,{id:"5171-resource-quota",children:"5.17.1. Resource Quota"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'# Example of ResourceQuota definition with YAML\r\n\r\napiVersion: v1\r\nkind: ResourceQuota\r\nmetadata:\r\n    name: compute-quota\r\n    namespace: dev\r\n\r\nspec: \r\n  hard:\r\n    pods: "10"\r\n    requests.cpu: "4"\r\n    requests.memory: "5Gi"\r\n    limits.cpu: "10"\r\n    limits.memory: "10Gi"\n'})}),"\n",(0,s.jsx)(n.h2,{id:"518-imperative-vs-declarative",children:"5.18. Imperative vs. Declarative"}),"\n",(0,s.jsx)(n.p,{children:"In the context of Infrastructure as Code (IaC), imperative and declarative are two different approaches to defining and managing infrastructure."}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["In an ",(0,s.jsx)(n.strong,{children:"imperative"})," approach, you specify how to achieve a desired state by providing a sequence of commands or instructions."]}),"\n",(0,s.jsxs)(n.li,{children:["In a ",(0,s.jsx)(n.strong,{children:"declarative"})," approach, you specify what the desired state of the infrastructure should be, without detailing the steps to achieve that state."]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"# IMPERAIVE APPROACH\r\n\r\n# create objects\r\nkubectl run --image=nginx nginx \r\nkubectl create deployment --image=nginx nginx \r\nkubectl expose deployment nginx --port 80\r\n\r\n# update objects\r\nkubectl edit deployment nginx\r\nkubectl scale deployment nginx --replicas=5\r\nkubectl set image deployment nginx nginx=nginx:1.18\r\n\r\nkubectl create -f nginx.yaml\r\nkubectl replace -f nginx.yaml\r\nkubectl delete -f nginx.yaml\r\n\r\n\r\n# DECLARATIVE APPROACH\r\n\r\nkubectl apply -f object-definition-file.yaml\n"})}),"\n",(0,s.jsx)(n.h1,{id:"6-scheduling",children:"6. Scheduling"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Scheduling"})," is a process of assigning pods (the smallest deployable units in Kubernetes) to nodes (the machines or virtual machines in the cluster) based on resource availability and other constraints."]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"61-manual-scheduling",children:"6.1. Manual Scheduling"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"apiVersion: v1\r\nkind: Pod\r\nmetadata:\r\n name: nginx\r\n labels:\r\n  name: nginx\r\nspec:\r\n containers:\r\n - name: nginx\r\n   image: nginx\r\n   ports:\r\n   - containerPort: 8080\r\n nodeName: node02                            # Specifies the name of Node, by default is not set\n"})}),"\n",(0,s.jsx)(n.h3,{id:"611-binding-object",children:"6.1.1. Binding Object"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"apiVersion: v1\r\nkind: Binding\r\nmetadata:\r\n  name: my-pod\r\n  namespace: default\r\ntarget:\r\n  apiVersion: v1\r\n  kind: Node\r\n  name: my-node\n"})}),"\n",(0,s.jsx)(n.h2,{id:"62-taints-and-tolerations",children:"6.2. Taints and Tolerations"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Taints"})," are applied to nodes to prevent certain pods from being scheduled on them"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Tolerations"})," are applied to pods to allow them to be scheduled on nodes with specific taints"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:'kubectl taint nodes <NODE-NAME> <KEY>=<VALUE>:<TAINT-EFFECT>\r\n\r\n# TAINT-EFFECT defines what happens to Pods that do not TOLERATE this taint.\r\n# TAINT-EFFECTs: NoSchedule, PreferNoSchedule, NoExecute\r\n\r\n\r\n\r\n# TAINTING NODE EXAMPLE\r\nkubectl taint nodes node1 app=blue:NoSchedule\r\n\r\n# TOLERATION DEFINITION OF POD EXAMPLE\r\napiVersion: v1\r\nkind: Pod\r\nmetadata:\r\n name: nginx\r\n labels:\r\n  name: nginx\r\nspec:\r\n containers:\r\n - name: nginx\r\n   image: nginx\r\n   ports:\r\n   - containerPort: 8080\r\n tolerations:\r\n - key: "app"\r\n   operator: "Equal" \r\n   value: "blue"\r\n   effect: "NoSchedule"\n'})}),"\n",(0,s.jsx)(n.h2,{id:"63-node-selectors",children:"6.3. Node Selectors"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Label a node:"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"kubectl label nodes node01 size=Large\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Assign a Pod to the Node"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"apiVersion: v1\r\nkind: Pod\r\nmetadata:\r\n  name: myapp-pod\r\nspec:\r\n  containers:\r\n  - name: nginx\r\n    image: nginx\r\n  nodeSelector:\r\n    size: Large\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Node Selector's Limitations:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Advanced expressions, e.g. Large OR Medium, NOT Small etc."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"64-node-affinity",children:"6.4. Node Affinity"}),"\n",(0,s.jsxs)(n.p,{children:["Node affinity is conceptually similar to ",(0,s.jsx)(n.code,{children:"nodeSelector"}),", allowing you to constrain which nodes your Pod can be scheduled on based on node labels."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"apiVersion: v1\r\nkind: Pod\r\nmetadata:\r\n  name: with-node-affinity\r\nspec:\r\n  containers:\r\n  - name: nginx\r\n    image: nginx\r\n  affinity:\r\n    nodeAffinity:\r\n      requiredDuringSchedulingIgnoredDuringExecution:\r\n        nodeSelectorTerms:\r\n        - matchExpressions:\r\n          - key: size\r\n            operator: In                                        # operators: In, NotIn, Exists, DoesNotExist\r\n            values:\r\n            - Large\r\n            - Medium\n"})}),"\n",(0,s.jsx)(n.h3,{id:"641-node-affinity-types",children:"6.4.1. Node Affinity Types"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Available:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"requiredDuringSchedulingIgnoredDuringExecution"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"preferredDuringSchedulingIgnoredDuringExecution"})}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["Planned:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"requiredDuringSchedulingRequiredDuringExecution"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Two states in the lifecycle of the Pod considering Node Affinity:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"DuringScheduling"})," is a state when Pod does not exists and is created for the first time. If ",(0,s.jsx)(n.em,{children:"reqired"})," then a node with specified lable must exist in order the Pod to be scheduled."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"DuringExecution"})," is a state where the Pod is running and the change made in environment which affects Node Affinity, e.g. change in the label of the Node. If ",(0,s.jsx)(n.em,{children:"ignored"}),", the Pod will continue running if node label is changed or removed."]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["Read ",(0,s.jsx)(n.a,{href:"https://kubernetes.io/docs/concepts/scheduling-eviction/assign-pod-node/#node-affinity",children:"more."})]}),"\n",(0,s.jsx)(n.h2,{id:"65-taints-and-tolerations-vs-node-affinity",children:"6.5. Taints and Tolerations vs Node Affinity"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Taints and Tolerations"}),": Taints are applied to nodes to repel certain pods unless those pods have matching tolerations. This mechanism is useful for reserving nodes for specific workloads.\r\n",(0,s.jsx)(n.strong,{children:"Node Affinity"}),": Node affinity allows you to specify rules based on node labels that determine which nodes a pod can be scheduled on. It helps ensure that pods are placed on nodes with specific characteristics."]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Taints and Tolerations do not guarantee that the pods will only prefer these nodes."}),"\n",(0,s.jsx)(n.li,{children:"As such, a combination of taints and tolerations and node affinity rules can be used together to completely dedicate nodes for specific parts."}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"66-resource-requirements-and-limits",children:"6.6. Resource Requirements and Limits"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Note"}),": Requests and Limits for resources are set per container in the pod."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"661-default-behaviour",children:"6.6.1. Default Behaviour"}),"\n",(0,s.jsx)(n.h3,{id:"662-resource-requests",children:"6.6.2. Resource Requests"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:'apiVersion: v1\r\nkind: Pod\r\nmetadata:\r\n name: nginx\r\n labels:\r\n  name: nginx\r\nspec:\r\n containers:\r\n - name: nginx\r\n   image: nginx\r\n   ports:\r\n   - containerPort: 8080\r\n   resources:\r\n     requests:\r\n       memory: "4Gi"  \r\n       cpu: 2                           # 1 CPU Count: 1 AWS vCPU, 1 GCP Core, 1 Azure Core, 1 Hyperthread\n'})}),"\n",(0,s.jsx)(n.h3,{id:"663-resource-limits",children:"6.6.3. Resource Limits"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Limit = Requests"})," if ",(0,s.jsx)(n.code,{children:"Request"})," is not defined"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:'apiVersion: v1\r\nkind: Pod\r\nmetadata:\r\n name: nginx\r\n labels:\r\n  name: nginx\r\nspec:\r\n containers:\r\n - name: nginx\r\n   image: nginx\r\n   ports:\r\n   - containerPort: 8080\r\n   resources:\r\n     requests:\r\n       memory: "4Gi"  \r\n       cpu: 1                           # 1 CPU Count: 1 AWS vCPU, 1 GCP Core, 1 Azure Core, 1 Hyperthread\r\n    limits:\r\n       memory: "8Gi"  \r\n       cpu: 2\n'})}),"\n",(0,s.jsx)(n.h3,{id:"664-limitrange",children:"6.6.4. LimitRange"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Applies in Namespace level (Namespace level object)"}),"\n",(0,s.jsx)(n.li,{}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:'# LimitRange CPU\r\napiVersion: v1\r\nkind: LimitRange\r\nmetadata:\r\n  name: cpu-resource-constraint\r\nspec:\r\n  limits:\r\n  - default: # this section defines default limits\r\n      cpu: 500m\r\n    defaultRequest: # this section defines default requests\r\n      cpu: 500m\r\n    max: # max and min define the limit range\r\n      cpu: "1"\r\n    min:\r\n      cpu: 100m\r\n    type: Container\r\n\r\n\r\n# LimitRange Memory\r\napiVersion: v1\r\nkind: LimitRange\r\nmetadata:\r\n  name: memory-resource-constraint\r\nspec:\r\n  limits:\r\n  - default:\r\n      memory: 1Gi\r\n    defaultRequest:\r\n      memory: 1Gi\r\n    max: \r\n      memory: 1Gi\r\n    min:\r\n      memory: 500Mi\r\n    type: Container\r\n\n'})}),"\n",(0,s.jsx)(n.h3,{id:"665-resourcequota",children:"6.6.5. ResourceQuota"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"apiVersion: v1\r\nkind: ResourceQuota\r\nmetadata:\r\n  name: my-resource-quota\r\nspec:\r\n  hard:\r\n    requests.cpu: 4\r\n    requests.memory: 4Gi\r\n    limit.cpu: 10\r\n    limit.memory: 10Gi\n"})}),"\n",(0,s.jsx)(n.h2,{id:"67-deamonsets",children:"6.7. DeamonSets"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"DeamonSet ensures that one copy of pod is present in all nodes of cluster"}),"\n",(0,s.jsxs)(n.li,{children:["Similar to ",(0,s.jsx)(n.code,{children:"ReplicaSet"})," but deployes a pod on each nodes"]}),"\n",(0,s.jsx)(n.li,{children:"A pod is deployed on new node and removed when node is removed"}),"\n",(0,s.jsxs)(n.li,{children:["Use cases","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Monitoring solution"}),"\n",(0,s.jsx)(n.li,{children:"Logs Viewer"}),"\n",(0,s.jsxs)(n.li,{children:["Examples:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"kube-proxy"}),"\n",(0,s.jsx)(n.li,{children:"weave-net (networking solution)"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"# deamon-set-definition.yaml\r\n\r\napiVersion: apps/v1\r\nkind: DeamonSet\r\nmetadata:\r\n  name: monitoring-deamon\r\nspec:\r\n  selector:\r\n    matchLabels:\r\n      app: monitoring-agent\r\n  template:\r\n    metadata:\r\n      labels:\r\n        app: monitoring-agent\r\n    spec:\r\n      containers:\r\n      - name: monitoring-agent\r\n        image: monitoring-agent\n"})}),"\n",(0,s.jsx)(n.h2,{id:"68-static-pods",children:"6.8. Static Pods"}),"\n",(0,s.jsx)(n.h3,{id:"681-what-is-static-pods",children:"6.8.1. What is Static Pods"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"Static Pods"})," are pods with ",(0,s.jsx)(n.code,{children:"kubelet"})," without ",(0,s.jsx)(n.code,{children:"kube-apiserver"})," or other k8s control plain components"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"kubelet"})," can manage pod independently from ",(0,s.jsx)(n.code,{children:"kube-apiserver"})]}),"\n",(0,s.jsxs)(n.li,{children:["Pod definition files must be provided to ",(0,s.jsx)(n.code,{children:"kubelet"})," manually by putting them into ",(0,s.jsx)(n.code,{children:"/etc/kubernetes/manifests"})," directory designated to store information about pods"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"kubelet"})," periodically checks ",(0,s.jsx)(n.code,{children:"/etc/kubernetes/manifests"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"kubelet"})," creates a pod and makes sure it stays alive and removes pods if definition file is removed from manifests directory"]}),"\n",(0,s.jsxs)(n.li,{children:["On ",(0,s.jsx)(n.code,{children:"Static Pods"})," ",(0,s.jsx)(n.code,{children:"kubelet"})," works in pod level and it is not possible to create ",(0,s.jsx)(n.code,{children:"ReplicaSets"}),", ",(0,s.jsx)(n.code,{children:"Deployments"})," or ",(0,s.jsx)(n.code,{children:"Services"})," by copying definition files into manifest directory as it requires other control plane components, such as ",(0,s.jsx)(n.code,{children:"replication"}),", ",(0,s.jsx)(n.code,{children:"deployment-controller"})," etc."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"--pod-manifest-path=/etc/kubernetes/manifests"})," flag or ",(0,s.jsx)(n.code,{children:"--config=kubeconfig.yaml with content: staticPodPath: /etc/kubernetes/manifests"})," is used to set a designated directory to be scanned by ",(0,s.jsx)(n.code,{children:"kubelet"})]}),"\n",(0,s.jsxs)(n.li,{children:["Check running containers with: (i: no ",(0,s.jsx)(n.code,{children:"kubectrl"})," util as ",(0,s.jsx)(n.code,{children:"kube-apiserver"})," not available)","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"docker ps"})," for ",(0,s.jsx)(n.code,{children:"Docker"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"crictl ps"})," for ",(0,s.jsx)(n.code,{children:"cri-o"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"nerdctl ps"})," for ",(0,s.jsx)(n.code,{children:"containerd"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"682-static-pods-in-cluster",children:"6.8.2. Static Pods in Cluster"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"kubelet"})," takes requests to create pod from different inputs:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"from definition file from static pod folder"}),"\n",(0,s.jsxs)(n.li,{children:["from http api endpoint (i.e. from ",(0,s.jsx)(n.code,{children:"kube-apiserver"}),")"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"kubectl get pods"})," will also list pods created statically but they can NOT be edited, deleted etc. from ",(0,s.jsx)(n.code,{children:"kube-apiserver"})]}),"\n",(0,s.jsx)(n.li,{children:"Static pods can be recognized by their name where node name is appended to it"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"683-static-pods-use-case",children:"6.8.3. Static Pods Use Case"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["To deploy Control Plane components as Static Pods. E.g. ",(0,s.jsx)(n.code,{children:"kubeadm"})," tool uses a mechanist of Static Pods to create a k8s cluster. E.g. by just putting ",(0,s.jsx)(n.code,{children:"controller-manager.yaml"}),", ",(0,s.jsx)(n.code,{children:"apiserver.yaml"}),", ",(0,s.jsx)(n.code,{children:"etcd.yaml"})," into static pod folder and the k8s control plane components will be started as pods"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"684-static-pods-vs-daemonsets",children:"6.8.4. Static Pods vs. DaemonSets"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Static Pods"}),(0,s.jsx)(n.th,{children:"DaemonSets"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Created by kubelet"}),(0,s.jsx)(n.td,{children:"Created kube-apiserver (DaemonSet Controller)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Deploy Control Plane components as Static Pods"}),(0,s.jsx)(n.td,{children:"Deploy Monitoring Agents, Logging Agents on nodes"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Ignored by kube-scheduler"}),(0,s.jsx)(n.td,{children:"Ignored by kube-scheduler"})]})]})]}),"\n",(0,s.jsx)(n.h2,{id:"69-multiple-schedulers",children:"6.9. Multiple Schedulers"}),"\n",(0,s.jsx)(n.h2,{id:"610-configuring-scheduler-profiles",children:"6.10. Configuring Scheduler Profiles"}),"\n",(0,s.jsx)(n.h2,{id:"611-admission-controllers",children:"6.11. Admission Controllers"}),"\n",(0,s.jsx)(n.h2,{id:"612-validating-and-mutating-admission-controllers",children:"6.12. Validating and Mutating Admission Controllers"}),"\n",(0,s.jsx)(n.h3,{id:"6121-validating-admission-controllers",children:"6.12.1. Validating Admission Controllers"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Validates the request and allow/deny it"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"6122-mutating-admission-controller",children:"6.12.2. Mutating Admission Controller"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Mutates/Changes object before it is created (e.g. ",(0,s.jsx)(n.code,{children:"DefaultStorageClass"}),")"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"6123-custom-validatingmutating-admission-controllers",children:"6.12.3. Custom Validating/Mutating Admission Controllers"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"MutatingAdmissionWebhook"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"ValidatingAdmissionWebhook"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Webhooks above will reference ",(0,s.jsx)(n.code,{children:"Admission Webhook Server"})," with custom logic"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h1,{id:"7-logging-and-monitoring",children:"7. Logging and Monitoring"}),"\n",(0,s.jsx)(n.h2,{id:"71-monitor-cluster-components",children:"7.1. Monitor Cluster Components"}),"\n",(0,s.jsx)(n.h3,{id:"711-tools",children:"7.1.1. Tools"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Prometheus"}),"\n",(0,s.jsx)(n.li,{children:"DataDog"}),"\n",(0,s.jsx)(n.li,{children:"Elastic Stack"}),"\n",(0,s.jsx)(n.li,{children:"Dynatrace"}),"\n",(0,s.jsxs)(n.li,{children:["Mentics Server: in-memory solution without storing data option.","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"kubelet"})," contains sub-component called ",(0,s.jsx)(n.code,{children:"cAdvisor"})," (i.e. container advisor) responsible for retrieving performance metrics and exposing them through ",(0,s.jsx)(n.code,{children:"kubelet"})," API for Metrics Server."]}),"\n",(0,s.jsxs)(n.li,{children:["Enable Metrics Service:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"git clone https://github.com/kubernetes-incubator/metrics-server.git & kubectl create -f deploy/1.8+"})}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["Cluster Performance view:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"kubectl top node"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"kubectl top pod"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"72-managing-application-logs",children:"7.2. Managing Application Logs"}),"\n",(0,s.jsx)(n.h1,{id:"8-application-lifecycle-management",children:"8. Application Lifecycle Management"}),"\n",(0,s.jsx)(n.h2,{id:"81-rolling-updates-and-rollbacks",children:"8.1. Rolling Updates and Rollbacks"}),"\n",(0,s.jsx)(n.h3,{id:"811-deployment-strategy",children:"8.1.1. Deployment Strategy"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Recreate: destroy all and create all"}),"\n",(0,s.jsx)(n.li,{children:"Rolling Update: destroy and create one-by-one (DEFAULT Deployment Strategy)"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"82-configure-applications",children:"8.2. Configure Applications"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Configuring Command and Arguments on applications"}),"\n",(0,s.jsx)(n.li,{children:"Configure Environment Variables"}),"\n",(0,s.jsx)(n.li,{children:"Configure Secrets"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"821-commands-and-arguments-in-docker-and-k8s",children:"8.2.1. Commands and Arguments in Docker and K8s"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Read ",(0,s.jsx)(n.a,{href:"https://docs.docker.com/reference/dockerfile/#cmd",children:"more"})]}),"\n",(0,s.jsx)(n.li,{children:"Containers (unlike VMs) are not meant to host OS, but run specific process."}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-Dockerfile",children:'FROM nginx\r\n\r\nENTRYPOINT ["sleep"]\r\nCMD ["5"]\n'})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'apiVersion: v1\r\nkind: Pod\r\nmetadata:\r\n name: nginx-sleeper-pod\r\nspec:\r\n containers:\r\n - name: nginx\r\n   image: nginx\r\n   command: ["sleep"]                    # Overrides executables ENTRYPOINT in Dockerfile\r\n   args: ["10"]                          # Overrides CMD defined after ENTRYPOINT as arguments in Dockerfile\n'})}),"\n",(0,s.jsx)(n.h3,{id:"822-configuring-environment-variables-in-applications",children:"8.2.2. Configuring Environment Variables in Applications"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'apiVersion: v1\r\nkind: Pod\r\nmetadata:\r\n  name: envar-demo\r\nspec:\r\n  containers:\r\n  - name: envar-demo-container\r\n    image: nginx\r\n    env:\r\n    - name: MY_VAR\r\n      value: "My Value"\n'})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'# ENV Value Types\r\n\r\n# 1. Plain Key Value\r\n...\r\n    env:\r\n    - name: MY_VAR\r\n      value: "My Value"\r\n...\r\n\r\n# 2. ConfigMap\r\n...\r\n    env:\r\n    - name: MY_VAR\r\n      valueFrom: \r\n        configMapKeyRef:\r\n...\r\n\r\n# 3. Secrets\r\n...\r\n    env:\r\n    - name: MY_VAR\r\n      valueFrom: \r\n        secretKeyRef:\r\n...\n'})}),"\n",(0,s.jsx)(n.h3,{id:"823-configuring-configmaps-in-applications",children:"8.2.3. Configuring ConfigMaps in Applications"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'apiVersion: v1\r\nkind: ConfigMap\r\nmetadata:\r\n  name: configmap-demo\r\ndata:\r\n  # property-like keys; each key maps to a simple value\r\n  player_initial_lives: "3"\r\n  ui_properties_file_name: "user-interface.properties"\r\n\r\n  # file-like keys\r\n  game.properties: |\r\n    enemy.types=aliens,monsters\r\n    player.maximum-lives=5    \r\n  user-interface.properties: |\r\n    color.good=purple\r\n    color.bad=yellow\r\n    allow.textmode=true  \n'})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'apiVersion: v1\r\nkind: Pod\r\nmetadata:\r\n  name: env-configmap\r\nspec:\r\n  containers:\r\n    - name: app\r\n      command: ["/bin/sh", "-c", "printenv"]\r\n      image: busybox:latest\r\n      envFrom:\r\n        - configMapRef:\r\n            name: configmap-demo\n'})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"# ConfigMaps in Pods\r\n\r\n# 1. ENV\r\nenvFrom:\r\n  - configMapRef:\r\n      name: app-config\r\n\r\n# 2. SINGLE ENV\r\nenv:\r\n  - name: APP_COLOR\r\n    valueFrom:\r\n      configMapKeyRef:\r\n        name: app-config\r\n        key: APP_COLOR\r\n\r\n# 3. VOLUME\r\nvolumes:\r\n- name: app-config-value\r\n  configMap:\r\n    name: app-config\n"})}),"\n",(0,s.jsx)(n.h3,{id:"824-configure-secrets-an-applications",children:"8.2.4. Configure Secrets an Applications"}),"\n",(0,s.jsx)(n.h4,{id:"8241-create-secrets",children:"8.2.4.1. Create Secrets"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Imperative approach - see ",(0,s.jsx)(n.a,{href:"#9-commands",children:"Commands"})]}),"\n",(0,s.jsx)(n.li,{children:"Declarative approach"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"# kubectl create -f secret-data.yaml\r\n\r\n# Secrets are only encoded, NOT Encryped\r\n# echo -n 'password' | base64\r\n# echo -n 'cGFzc3dvcmQ=' | base64 --decode\r\n\r\n# secret-data.yaml\r\n\r\napiVersion: v1\r\nkind: Secret\r\nmetadata:\r\n  name: app-secret\r\ndata:\r\n  DB_User: root\r\n  DB_Password: dmFsdWUtMg0KDQo=\r\n---\r\napiVersion: v1\r\nkind: Pod\r\nmetadata:\r\n  name: sapmple-secret-pod\r\nspec:\r\n  containers:\r\n    - name: test-container\r\n      image: registry.k8s.io/busybox\r\n      envFrom:\r\n        - secretRef:\r\n            name: app-secret                           # ref to secret name\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"# Secrets in Pods\r\n\r\n# 1. ENV\r\nenvFrom:\r\n  - secretRef:\r\n      name: app-config\r\n\r\n# 2. SINGLE ENV\r\nenv:\r\n  - name: DB_password\r\n    valueFrom:\r\n      secretKeyRef:\r\n        name: app-secret\r\n        key: DB_password\r\n\r\n# 3. VOLUME\r\nvolumes:\r\n- name: app-secret-volume\r\n  secret:\r\n    secretName: app-secret\n"})}),"\n",(0,s.jsx)(n.h4,{id:"8242-encrypting-secret-data-at-rest",children:"8.2.4.2. Encrypting Secret Data at Rest"}),"\n",(0,s.jsx)(n.p,{children:"Secrets are not encrypted, so it is not safer in that sense. However, some best practices around using secrets make it safer. As in best practices like:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Not checking-in secret object definition files to source code repositories."}),"\n",(0,s.jsxs)(n.li,{children:["Enabling Encryption at Rest for Secrets so they are stored encrypted in ETCD.","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Read more about ",(0,s.jsx)(n.a,{href:"https://kubernetes.io/docs/tasks/administer-cluster/encrypt-data/",children:"Encrypting Confidential Data at Rest"})]}),"\n",(0,s.jsxs)(n.li,{children:["Or ",(0,s.jsx)(n.a,{href:"https://www.youtube.com/watch?v=MTnQW9MxnRI",children:"here"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"8243-secret-store-providers",children:"8.2.4.3. Secret Store Providers"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Third-party secrets store providers: AWS Provider, Azure Provider, GCP Provider, Vault Provider (HashiCorp Vault)"}),"\n",(0,s.jsx)(n.li,{children:"Helm Secrets plugin"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"83-scale-applications",children:"8.3. Scale Applications"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["See ",(0,s.jsx)(n.a,{href:"#81-rolling-updates-and-rollbacks",children:"Deployments, Rolling updates and Rollback section"})]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"84-multi-container-pods",children:"8.4. Multi Container Pods"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"# pod-definition.yaml\r\n\r\napiVersion: v1\r\nkind: Pod\r\nmetadata:\r\n  name: nginx\r\nspec:\r\n  containers:\r\n  - name: nginx\r\n    image: nginx:1.14.2\r\n    ports:\r\n    - containerPort: 80\r\n  - name: nginx-2\r\n    image: nginx:1.14.2\r\n    ports:\r\n    - containerPort: 81\n"})}),"\n",(0,s.jsx)(n.h3,{id:"841-multi-container-pods-design-patterns",children:"8.4.1. Multi-container Pods Design Patterns"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Sidecar (e.g. service and logging containers)"}),"\n",(0,s.jsx)(n.li,{children:"Adapter"}),"\n",(0,s.jsx)(n.li,{children:"Ambassador"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"85-initcontainers",children:"8.5. InitContainers"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"# pod-definition.yaml\r\n# initContainer must run to a completion before the real container hosting the application starts. \r\n\r\napiVersion: v1\r\nkind: Pod\r\nmetadata:\r\n  name: myapp-pod\r\n  labels:\r\n    app: myapp\r\nspec:\r\n  containers:\r\n  - name: myapp-container\r\n    image: busybox:1.28\r\n    command: ['sh', '-c', 'echo The app is running! && sleep 3600']\r\n  initContainers:\r\n  - name: init-myservice\r\n    image: busybox\r\n    command: ['sh', '-c', 'git clone <some-repository-that-will-be-used-by-application> ; done;']\n"})}),"\n",(0,s.jsx)(n.h2,{id:"86-self-healing-applications",children:"8.6. Self Healing Applications"}),"\n",(0,s.jsx)(n.p,{children:"Kubernetes supports self-healing applications through ReplicaSets and Replication Controllers. The replication controller helps in ensuring that a POD is re-created automatically when the application within the POD crashes."}),"\n",(0,s.jsx)(n.h2,{id:"87-intro-to-autoscaling",children:"8.7. Intro to Autoscaling"}),"\n",(0,s.jsx)(n.h3,{id:"871-scaling-cluster-infra-vs-scaling-workloads",children:"8.7.1. Scaling Cluster Infra vs Scaling Workloads"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Scaling Cluster Infra"})," by increasing number of nodes horizontally or increasing size of resources (CPU, RAM) on existing node"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Scaling Workloads"})," by increasing the number of pods horizontally or increase resources allocated to existing pods"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"872-manual-vs-automated-scaling",children:"8.7.2. Manual vs Automated Scaling"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Manual Scaling"})," of","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Cluster Infra:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Horizontally: ",(0,s.jsx)(n.code,{children:"kubeadm join ..."})]}),"\n",(0,s.jsx)(n.li,{children:"Vertically: rare"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["Workloads:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Horizontally: ",(0,s.jsx)(n.code,{children:"kubectl scale ..."})]}),"\n",(0,s.jsxs)(n.li,{children:["Vertically: ",(0,s.jsx)(n.code,{children:"kubectl edit ..."})]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Automatied Scaling"})," of","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Cluster Infra:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Cluster Autoscaler"})}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["Workloads:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#88-horizontal-pod-autoscaler-hpa",children:"Horizontal Pod Autoscaler (HPA)"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#89-vertical-pod-autoscaling-vpa",children:"Vertical Pod Autoscaler (VPA)"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"873-horizontal-pod-autoscaler-hpa",children:"8.7.3. Horizontal Pod Autoscaler (HPA)"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Increate the running instances of application horizontally"}),"\n",(0,s.jsxs)(n.li,{children:["HPA relies on","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Metrics Server"})," or ",(0,s.jsx)(n.strong,{children:"Custom Metrics Adapter"})," for ",(0,s.jsx)(n.em,{children:"internal sources"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"External Adapter"})," for e.g. DataDog, Dynatrace etc."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"8731-scaling-a-workload-manually",children:"8.7.3.1. Scaling a workload manually"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"# Manually check the load and increase replicas\r\n\r\nkubectl top pod my-app-pod\r\nkubectl scale deployment my-app --replicas=3\n"})}),"\n",(0,s.jsx)(n.h4,{id:"8732-hpa",children:"8.7.3.2. HPA"}),"\n",(0,s.jsx)(n.p,{children:"HPA:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Observes metrics"}),"\n",(0,s.jsx)(n.li,{children:"Adds pods"}),"\n",(0,s.jsx)(n.li,{children:"Balances thresholds"}),"\n",(0,s.jsx)(n.li,{children:"Tracks multiple metrics"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"# IMPERATIVE: Create HPA for specific deployment\r\n\r\nkubectl autoscale deployment my-app \\\r\n          --cpu-percent=50 --min=1 --max=10                       # CPU thresholds of 50% and min 1 pod and max 10 pods\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"# DECLARATIVE: Create HPA for specific deployment\r\n\r\napiVersion: autoscaling/v2\r\nkind: HorizontalPodAutoscaler\r\nmetadata:\r\n  name: php-apache\r\nspec:\r\n  scaleTargetRef:\r\n    apiVersion: apps/v1\r\n    kind: Deployment\r\n    name: my-app\r\n  minReplicas: 1\r\n  maxReplicas: 10\r\n  metrics:\r\n  - type: Resource\r\n    resource:\r\n      name: cpu\r\n      target:\r\n        type: Utilization\r\n        averageUtilization: 50\n"})}),"\n",(0,s.jsx)(n.h3,{id:"874-vertical-pod-autoscaling-vpa",children:"8.7.4. Vertical Pod Autoscaling (VPA)"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Manual:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"kubectl edit deployment my-app"})," and manually change resources"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["VPA:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Observe metrics"}),"\n",(0,s.jsx)(n.li,{children:"Adjust pod resources: e.g. increase the size of resources vertically, such as CPU, RAM"}),"\n",(0,s.jsx)(n.li,{children:"Balances threshold"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'apiVersion: "autoscaling.k8s.io/v1"\r\nkind: VerticalPodAutoscaler\r\nmetadata:\r\n  name: stress-vpa\r\nspec:\r\n  targetRef:\r\n    apiVersion: "apps/v1"\r\n    kind: Deployment\r\n    name: high-cpu-utilization-deployment\r\n  updatePolicy:\r\n    updateMode: Auto                # Modes: Off, Initial, Recreate and Auto         \r\n  resourcePolicy:\r\n    containerPolicies:\r\n      - containerName: \'*\'\r\n        minAllowed:\r\n          cpu: 100m\r\n          memory: 50Mi\r\n        maxAllowed:\r\n          cpu: 200m                 # maximum vpa will be allocating this many cpus even if demand is higher.\r\n          memory: 500Mi\r\n        controlledResources: ["cpu", "memory"]\n'})}),"\n",(0,s.jsx)(n.h4,{id:"8741-deployment-of-vpa-components",children:"8.7.4.1. Deployment of VPA Components"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["VPA does NOT come built-in with K8s, but must be deployed","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"kubectl apply -f https://github.com/kubernetes/autoscaler/releases/latest/download/vertical-pod-autoscaler.yaml"})}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["VPA includes following pods:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"vpa recommender"})," - continuously monitoring resource usage from Metrics Server and provides recommendation for optimal cpu, ram values"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"vpa updater"})," - get an information from recommender and evicts pods needed to be updated with recommended resources"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"vpa admission controller"})," - controller then creates new pod with new resources values recommended"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"875-in-place-resize-pods",children:"8.7.5. In-place resize Pods"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"As of kubernetes version 1.32, if the resource definition parameter is changed, the default behaviour is delete running instance of pod and spin up a new pod with changes"}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"InPlacePodVerticalScaling:"})," Resize CPU and Memory Resources assigned to Containers without restart","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["FEATURE STATE: K8s v1.27 [alpha][enabled by default",":false","]"]}),"\n",(0,s.jsxs)(n.li,{children:["Enable feature: ",(0,s.jsx)(n.code,{children:"FEaTURE_GATES:InPlacePodVerticalScaling=true"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'apiVersion: v1\r\nkind: Pod\r\nmetadata:\r\n  name: resize-demo\r\nspec:\r\n  containers:\r\n  - name: pause\r\n    image: registry.k8s.io/pause:3.8\r\n    resizePolicy:\r\n    - resourceName: cpu\r\n      restartPolicy: NotRequired                   # Default, but explicit here\r\n    - resourceName: memory\r\n      restartPolicy: RestartContainer\r\n    resources:\r\n      limits:\r\n        memory: "200Mi"\r\n        cpu: "700m"\r\n      requests:\r\n        memory: "200Mi"\r\n        cpu: "700m"\n'})}),"\n",(0,s.jsx)(n.h4,{id:"8751-limitations",children:"8.7.5.1. Limitations"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Only CPU and Memory resources can be changed"}),"\n",(0,s.jsx)(n.li,{children:"Pod QoS Class cannot change"}),"\n",(0,s.jsx)(n.li,{children:"InitContainers and Ephemeral COntainers cannot be resized"}),"\n",(0,s.jsx)(n.li,{children:"Resource requests and limits cannot be removed once set"}),"\n",(0,s.jsx)(n.li,{children:"A container's memor limit may not be reduced below its usage. If a request pts a container in this state, the resize status will remain in InProgress until the resired memory limit becomes feasible."}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"876-vpa-vs-hpa",children:"8.7.6. VPA vs. HPA"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Feature"}),(0,s.jsx)(n.th,{children:"VPA (Vertical Scaling)"}),(0,s.jsx)(n.th,{children:"HPA (Horizontal Scaling)"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Scaling Method"}),(0,s.jsx)(n.td,{children:"Increase CPU & memory of existing Pods"}),(0,s.jsx)(n.td,{children:"Adds/Removes Pods based on load"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Pods Behavior"}),(0,s.jsx)(n.td,{children:"Restarts Pods to apply new resource values"}),(0,s.jsx)(n.td,{children:"Keeps existing Pods running"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Handles Traffic Spikes?"}),(0,s.jsx)(n.td,{children:"NO, because scaling requires a Pod restart"}),(0,s.jsx)(n.td,{children:"YES, instantly adds more Pods"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Optimizes Costs?"}),(0,s.jsx)(n.td,{children:"Prevents over-provisioning of CPU/RAM"}),(0,s.jsx)(n.td,{children:"Avoids unnecessary idle Pods"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Best for"}),(0,s.jsx)(n.td,{children:"Stateful workloads, CPU/RAM-heavy apps"}),(0,s.jsx)(n.td,{children:"Stateless services, web apps, microservices"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Use cases"}),(0,s.jsx)(n.td,{children:"DBs, JVM-baseds apps, AI/ML workloads"}),(0,s.jsx)(n.td,{children:"Web servers (Nginx, API services), message queues, microservices"})]})]})]}),"\n",(0,s.jsx)(n.h1,{id:"9-cluster-maintenance",children:"9. Cluster Maintenance"}),"\n",(0,s.jsx)(n.h2,{id:"91-os-upgrade",children:"9.1. OS Upgrade"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Drain and cordon nodes (see Command section)"}),"\n",(0,s.jsx)(n.li,{children:"Uncordon nodes (see Command section)"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"92-kubernetes-software-versions",children:"9.2. Kubernetes Software Versions"}),"\n",(0,s.jsx)(n.p,{children:"Kubernetes version 1.27"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"kube-apiserver: v1.27.0"}),"\n",(0,s.jsx)(n.li,{children:"kube-scheduler: v1.27.0"}),"\n",(0,s.jsx)(n.li,{children:"kube-controller-manager: v1.27.0"}),"\n",(0,s.jsx)(n.li,{children:"kubelet: v1.27.0"}),"\n",(0,s.jsx)(n.li,{children:"kube-proxy: v1.27.0"}),"\n",(0,s.jsx)(n.li,{children:"etcd: v3.5.7 (or similar, depending on the Kubernetes version)"}),"\n",(0,s.jsx)(n.li,{children:"coredns: v1.10.1 (or similar, depending on the Kubernetes version)"}),"\n",(0,s.jsx)(n.li,{children:"container runtime: Versions can vary (e.g., containerd v1.6.0 or Docker v20.10.0)"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"93-cluster-upgrade-process",children:"9.3. Cluster Upgrade Process"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Kubenrnetes Supports only 3 last versions"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"It is recommended to upgrade one MINOR version at a time."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Upgrade possibilies of different versions."}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"kube-apiserver: vX"}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"kube-controller-manager: vX-1"}),"\n",(0,s.jsx)(n.li,{children:"kube-scheduler: vX-1"}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"kubelet: vX-2"}),"\n",(0,s.jsx)(n.li,{children:"kube-proxy: vX-2"}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"kubectl: vX+1, vX, vX-1"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Upgrade using ",(0,s.jsx)(n.code,{children:"kubeadm"})]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"kubeadm upgrade plan"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"kubeadm upgrade apply"})}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Upgrade Sequence:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"First Master Node"}),"\n",(0,s.jsx)(n.li,{children:"Then Worker Nodes"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Upgrade Strategies of Worker Nodes"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Upgrade ALL of Worker Nodes at once"}),"\n",(0,s.jsx)(n.li,{children:"Upgrade ONE node as a time"}),"\n",(0,s.jsx)(n.li,{children:"Add NEW node with new k8s version. I.e. provision new nodes and decomission old one."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.h3,{id:"931-kubeadm-upgrade",children:["9.3.1. ",(0,s.jsx)(n.code,{children:"kubeadm upgrade"})]}),"\n",(0,s.jsx)(n.p,{children:"Upgrade Master Node:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"kubeadm upgrade plan"}),"     # ",(0,s.jsx)(n.code,{children:"kubeadm"})," does not upgrade ",(0,s.jsx)(n.code,{children:"kubelet"})]}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"apt-get upgrade -y kubeadm=1.12.0-00"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"kubeadm upgrade apply v1.12.0"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"apt-get upgrade -y kubelet=1.12.0-00"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"systemctl restart kubelet"})}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Upgrade Worker Nodes:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"kubectl drain node-1"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"apt-get upgrade -y kubeadm=1.12.0-00"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"apt-get upgrade -y kubelet=1.12.0-00"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"kubeadm upgrade node config --kubelet-version 1.12.0"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"systemctl restart kubelet"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"kubectl get nodes"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"kubectl uncordon node-1"})}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"932-cluster-upgrade---demo",children:"9.3.2. Cluster Upgrade - Demo"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Read ",(0,s.jsx)(n.a,{href:"https://kubernetes.io/docs/tasks/administer-cluster/kubeadm/kubeadm-upgrade/",children:"more"})]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"933-backup-and-restore-methods",children:"9.3.3. Backup and Restore Methods"}),"\n",(0,s.jsx)(n.h4,{id:"9331-backup-candidates",children:"9.3.3.1. Backup Candidates"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Resource Configurations (namespace, configmap, secrets etc.)","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"kubectl get all --all-namespaces -o yaml > all-resources.yaml"})}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["ETCD Cluster (Stores information about the state of k8s cluster)","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"ETCD Cluster is hosted on Master Nodes"}),"\n",(0,s.jsxs)(n.li,{children:["ETCD Cluster data dir to backup ",(0,s.jsx)(n.code,{children:"--data-dir=/var/lib/etcd"})]}),"\n",(0,s.jsxs)(n.li,{children:["Create a Snapshot of ETCD with",(0,s.jsx)(n.br,{}),"\n",(0,s.jsx)(n.code,{children:"ETCDCTL_API=3 etcdctl snapshot save etcd_snapshot.db"})]}),"\n",(0,s.jsxs)(n.li,{children:["Restore ETCD from Backup","\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"service kube-apiserver stop\r\nETCDCTL_API=3 etcdctl snapshot restore etcd_snapshot.db --data-dir /var/lib/etcd-from-backup\r\nsystemctl daemon-reload\r\nservice etcd restart\r\nservice kube-apiserver start\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["Read more about ",(0,s.jsx)(n.a,{href:"https://velero.io/docs/v1.15/",children:"backup tools"})]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:"Persistence Volumes"}),"\n"]}),"\n",(0,s.jsx)(n.h1,{id:"10-security",children:"10. Security"}),"\n",(0,s.jsx)(n.h2,{id:"101-kubernetes-security-primitives",children:"10.1. Kubernetes Security Primitives"}),"\n",(0,s.jsx)(n.h3,{id:"1011-cluster-hosts-security",children:"10.1.1. Cluster Hosts Security"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"All access to cluster host must be secured"}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"root"})," access disabled"]}),"\n",(0,s.jsx)(n.li,{children:"Password based authentication disabled"}),"\n",(0,s.jsx)(n.li,{children:"SSH Key based authentication enabled"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"1012-kubernetes-security",children:"10.1.2. Kubernetes Security"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Securing the access to ",(0,s.jsx)(n.code,{children:"kube-apiserver"})," is the first line of diffence","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Authentication"}),", i.e. who can access it?","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Files - Username and Passwords"}),"\n",(0,s.jsx)(n.li,{children:"Files - Username and Tokens"}),"\n",(0,s.jsx)(n.li,{children:"Certificates"}),"\n",(0,s.jsx)(n.li,{children:"External Authentication providers - LDAP"}),"\n",(0,s.jsx)(n.li,{children:"Service Accounts"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Authorization"}),", i.e. what can they do?","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"RBAC Authorization"}),"\n",(0,s.jsx)(n.li,{children:"ABAC Authorization"}),"\n",(0,s.jsx)(n.li,{children:"Node Authorization"}),"\n",(0,s.jsx)(n.li,{children:"Webhook Mode"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"1013-tls-certificates",children:"10.1.3. TLS Certificates"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["All communication between ",(0,s.jsx)(n.code,{children:"kube-apiserver"})," and"]}),"\n",(0,s.jsx)(n.li,{children:"ETCD Cluster"}),"\n",(0,s.jsx)(n.li,{children:"Kubelet"}),"\n",(0,s.jsx)(n.li,{children:"Kube Proxy"}),"\n",(0,s.jsx)(n.li,{children:"Kube Scheduler"}),"\n",(0,s.jsx)(n.li,{children:"Kube Controller Manager is secured TLS Encryption."}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"1014-application-communication-within-cluster",children:"10.1.4. Application Communication within Cluster"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"By default all Pods can access other Pods within the Cluster"}),"\n",(0,s.jsxs)(n.li,{children:["The Pods access by another Pods can be restricted by ",(0,s.jsx)(n.a,{href:"#",children:"Network Policies"})]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"102-authentication",children:"10.2. Authentication"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Users who may access K8s Cluster","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Users","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Admins"}),"\n",(0,s.jsx)(n.li,{children:"Developers"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["Service Accounts","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Bots (CI/CD etc.)"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:"Application End Users (Usually managed by Application Authentication Management)"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"1021-users",children:"10.2.1. Users"}),"\n",(0,s.jsxs)(n.p,{children:["All user access are managed by ",(0,s.jsx)(n.code,{children:"kube-apiserver"})," whether access with ",(0,s.jsx)(n.code,{children:"kubectl"})," or ",(0,s.jsx)(n.code,{children:"curl https://kube-server-ip:6443/"})," by"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["First ",(0,s.jsx)(n.strong,{children:"Authenticate Users"})]}),"\n",(0,s.jsxs)(n.li,{children:["Then ",(0,s.jsx)(n.strong,{children:"Process Requests"})]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"kube-apiserver"})," Authentication Mechanisms:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Static Password File (not recommended)"}),"\n",(0,s.jsx)(n.li,{children:"Static Token File (not recommended)"}),"\n",(0,s.jsx)(n.li,{children:"Certificates"}),"\n",(0,s.jsx)(n.li,{children:"Identity Services (e.g. third Party Auth protocol LDAP, Cerberus etc.)"}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"10211-basic-authentication-mechanism---static-password-file",children:"10.2.1.1. Basic Authentication Mechanism - Static Password File"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csv",children:"# basic-auth.csv\r\npassword123,user1,u001,group1\r\npassword123,user2,u002,group2\r\npassword123,user3,u003,group3\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"kube-apiserver --basic-auth-file=/path/to/basic-auth.csv\r\nsystemctl restart kube-apiserver\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Then ",(0,s.jsx)(n.code,{children:"kube-apiserver"})," can be access with"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:'curl -v -k https://master-node-ip:6443/api/v1/pods -u "user1:password123"\n'})}),"\n",(0,s.jsx)(n.h4,{id:"10212-basic-authentication-mechanism---static-token-file",children:"10.2.1.2. Basic Authentication Mechanism - Static Token File"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csv",children:"# basic-token-auth.csv\r\na3f5c8e1d2b4a6e7,user1,u001,group1\r\n9b1e2c3d4f5a6b7c,user2,u002,group2\r\n7e8f9a0b1c2d3e4f,user3,u003,group3\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"kube-apiserver --token-auth-file=/path/to/basic-token-auth.csv\r\nsystemctl restart kube-apiserver\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Then ",(0,s.jsx)(n.code,{children:"kube-apiserver"})," can be access with"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:'curl -v -k https://master-node-ip:6443/api/v1/pods --header "Authorization: Bearer a3f5c8e1d2b4a6e7"\n'})}),"\n",(0,s.jsx)(n.h3,{id:"1022-service-accounts",children:"10.2.2. Service Accounts"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"kubectl create serviceaccount sa1"})}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"103-tls-certificates-in-k8s",children:"10.3. TLS Certificates in K8s"}),"\n",(0,s.jsx)(n.h3,{id:"1031-tls-basics",children:"10.3.1. TLS Basics"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Transport Layer Security (TLS)"})," is primarily associated with securing communications over the internet and it is used in various applications and protocols, like: SSH, HTTPS, Email Protocols(SMTP, IMAP), FPN, FTPS, APIs(RESTful APIs), WebSocket Secure (WSS), DB Connections etc."]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"TLS"})," certificates are digital certificates that authenticate the identity of a website or server and enable encrypted communication between clients and servers over the internet, ensuring data privacy and integrity during transmission."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Key Pair Generation"}),": When you create a key pair, a cryptographic algorithm (like RSA or ECC) generates two keys: a private key and a public key. These keys are mathematically linked."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Private Key"}),": is used to ",(0,s.jsx)(n.em,{children:"decrypt information"})," or ",(0,s.jsx)(n.em,{children:"sign data"})," and is kept secret."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Public Key"}),": is used to ",(0,s.jsx)(n.em,{children:"encrypt information"})," or ",(0,s.jsx)(n.em,{children:"verify signatures"})," and can be shared with anyone."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Certificate Signing Request (CSR)"}),": includes the public key along with information about the entity requesting a certificate (e.g. organization\u2019s name, domain). When you generate a CSR, you create it using your public key."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Certificate (CRT or Digital Certificate)"}),": contains the public key along with information about the certificate holder (e.g. their identity, domain). It is issued by a Certificate Authority (CA) after verifying the information in the CSR. The CRT allows others to trust that the public key belongs to the entity it claims to represent. I.e. Certificate is so called Validated User ID and Key is Password."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Digital Signature"}),": When you sign data with your private key, others can use your public key to verify that the signature is valid. This ensures that the data hasn\u2019t been tampered with and confirms the identity of the sender."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Root Certificate"})," is a special type of digital certificate that belongs to a trusted organization called a Certificate Authority (CA)."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Certificate Authority (CA)"}),": An entity that issues digital certificates, verifying the identity of the certificate holder and ensuring the integrity of the public key."]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"10311-private-vs-public-key",children:"10.3.1.1. Private vs Public Key"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Key Pair"}),"\n",(0,s.jsx)(n.li,{children:"Data can be encrytped with ANY of them and ONLY decrypted with other"}),"\n",(0,s.jsx)(n.li,{children:"Data can NOT be encrypted with one and descrypted with the same key"}),"\n",(0,s.jsx)(n.li,{children:"If data is encrypted with Private Key, anyone who has Public Key can decrypt data!"}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Signing"})," is done with a private key and ",(0,s.jsx)(n.strong,{children:"Verification"})," is done with a public key"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Encryption"})," is done with a public key and ",(0,s.jsx)(n.strong,{children:"Decryption"})," is done with a private key"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"10312-symmetric-encryption",children:"10.3.1.2. Symmetric Encryption"}),"\n",(0,s.jsx)(n.p,{children:"Symmetric encryption is a cryptographic method where the same key is used for both encrypting and decrypting data, ensuring that only parties with the shared key can access the original information."}),"\n",(0,s.jsx)(n.h4,{id:"10313-asymmetric-encryption",children:"10.3.1.3. Asymmetric Encryption"}),"\n",(0,s.jsx)(n.p,{children:"Asymmetric encryption is a cryptographic method that uses a pair of keys\u2014a public key for encryption and a private key for decryption-allowing secure communication where the public key can be shared openly while the private key remains confidential."}),"\n",(0,s.jsx)(n.h4,{id:"10314-asymmetric-encryption---ssh",children:"10.3.1.4. Asymmetric Encryption - SSH"}),"\n",(0,s.jsx)(n.p,{children:"Asymmetric encryption in SSH (Secure Shell) uses a pair of keys\u2014a public key and a private key\u2014to secure communications between a client and a server. The public key is shared with the server, while the private key remains confidential on the client."}),"\n",(0,s.jsx)(n.h4,{id:"10315-asymmetric-encryption---https",children:"10.3.1.5. Asymmetric Encryption - HTTPS"}),"\n",(0,s.jsxs)(n.p,{children:["In ",(0,s.jsx)(n.strong,{children:"HTTPS"})," (Hypertext Transfer Protocol Secure), ",(0,s.jsx)(n.strong,{children:"both symmetric and asymmetric encryption are used"})," to secure communications between a web browser and a server:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Asymmetric Encryption"}),": Initially used during the SSL/TLS handshake process to establish a secure connection. The server presents its public key to the client, allowing the client to encrypt a shared secret (session key) that only the server can decrypt with its private key. This ensures that the client is communicating with the legitimate server."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Symmetric Encryption"}),": Once the secure connection is established and the session key is shared, symmetric encryption is used for the actual data transmission. This is because symmetric encryption is faster and more efficient for encrypting large amounts of data compared to asymmetric encryption."]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"10316-certificate-authority-ca",children:"10.3.1.6. Certificate Authority (CA)"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Public CAs have also Private and Public Keys","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Private CA Service can be hosted within ones infrastructure"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["CA uses Private Key to ",(0,s.jsx)(n.strong,{children:"sign"})," Certificates"]}),"\n",(0,s.jsx)(n.li,{children:"Public Keys of CAs are available in e.g. Browsers (Trusted Root Certification Authorities)"}),"\n",(0,s.jsxs)(n.li,{children:["Browser uses Public Key of CA to ",(0,s.jsx)(n.strong,{children:"verify"})," that a specific Certificate was signed with Private Key of Official CA"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Public CAs:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Symantec"}),"\n",(0,s.jsx)(n.li,{children:"Comodo"}),"\n",(0,s.jsx)(n.li,{children:"GlobalSign"}),"\n",(0,s.jsx)(n.li,{children:"Digicert"}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"10317-naming-convention-of-public-and-private-keys",children:"10.3.1.7. Naming Convention of Public and Private Keys"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Certificate (Public Key)","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["*.crt, *.pem:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"server.crt"}),"\n",(0,s.jsx)(n.li,{children:"server.pem"}),"\n",(0,s.jsx)(n.li,{children:"client.crt"}),"\n",(0,s.jsx)(n.li,{children:"client.pem"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["Private Key","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["*.key, *-key.pem:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"server.key"}),"\n",(0,s.jsx)(n.li,{children:"server-key.pem"}),"\n",(0,s.jsx)(n.li,{children:"client.key"}),"\n",(0,s.jsx)(n.li,{children:"client-key.pem"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"10318-tls-use-cases",children:"10.3.1.8. TLS Use Cases"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Admins generate Key Pairs to secure SSH"}),"\n",(0,s.jsx)(n.li,{children:"Web Server has Key Pairs to secure Website with HTTPS"}),"\n",(0,s.jsx)(n.li,{children:"CA Generates its own Key Pairs to sign/verify Certificates"}),"\n",(0,s.jsx)(n.li,{children:"End Users/Browser only generates single Symetric Key"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"1032-tls-in-kubernetes",children:"10.3.2. TLS in Kubernetes"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Root Certificates (on CA Servers)"}),"\n",(0,s.jsx)(n.li,{children:"Server Certificates signed by CA (on Servers)"}),"\n",(0,s.jsx)(n.li,{children:"Client Certificates signed by CA (on Clients)"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Certificate Authority"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["CA","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"ca.crt, ca.key"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Server Certificates for Servers"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["kube-apiserver (server)","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"kube-apiserver.crt, kube-apiserver.key"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["etcd (server)","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"etcd.crt, etcd.key"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["kubelet (server)","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"kubelet.crt, kubelet.key"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Client Certificates for Clients"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["kube-apiserver (client)","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["etcd (server)","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"kube-apiserver-etcd.crt, kube-apiserver-etcd.key"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["kubelet (server)","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"kube-apiserver-kubelet.crt, kube-apiserver-kubelet.key"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["kubelet (client)","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["kube-apiserver (server)","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"kubelet-kube-apiserver.crt, kubelet-kube-apiserver.key"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["admin (client)","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["kube-apiserver (server)","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"admin-kube-apiserver.crt, admin-kube-apiserver.key"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["kube-scheduler (client)","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["kube-apiserver (server)","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"kube-scheduler-kube-apiserver.crt, kube-scheduler-kube-apiserver.key"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["kube-controller-manager (client)","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["kube-apiserve (server)","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"kube-controller-manager-kube-apiserver.crt, kube-controller-manager-kube-apiserver.key"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["kube-proxy (client)","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["kube-apiserve (server)","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"kube-proxy-kube-apiserver.crt, kube-proxy-kube-apiserver.key"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"1033-tls-in-kubernetes---certificate-creation",children:"10.3.3. TLS in Kubernetes - Certificate Creation"}),"\n",(0,s.jsx)(n.p,{children:"Tools to create certificates"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"EASYRSA"}),"\n",(0,s.jsx)(n.li,{children:"OPENSSL"}),"\n",(0,s.jsx)(n.li,{children:"CFSSL"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:'# CA --------------------------------------------------------------------------\r\n\r\n# Generate Private Key ca.key for CA\r\nopenssl genrsa -out ca.key 2048\r\n\r\n# Generate Certificate Signing Request (CSR) ca.crs using ca.key for CA. CSR is a certificate with all your details but without signature\r\nopenssl req -new -key ca.key -subj "/CN=KUBERNETES-CA" -out ca.csr\r\n\r\n# Sign (ROOT) Certificate ca.crt using ca.csr and ca.key for CA (self-signed). CA ca.crt must be in ALL k8s hosts (servers/clients)\r\nopenssl x509 -req -in ca.csr -signkey ca.key -out ca.crt\r\n\r\n\r\n\r\n# CLIENT Certificates ---------------------------------------------------------\r\n\r\n# Generate Private Key admin.key for Admin\r\nopenssl genrsa -out admin.key 2048\r\n\r\n# Generate Certificate Signing Request (CSR) admin.crs using admin.key for Admin. CSR is a certificate with all your details but without signature. Certificate is so called Validated User ID and Key is Password\r\n# "/CN=kube-admin" is admin name which e.g. appears in audit logs\r\n# "/O=system:masters" is a Group Detail added to Certificate to differentiat admin user from simple user. \r\n# Groups named "system:masters", "system:kube-scheduler", "system:kube-controller-manager", "system:kube-proxy", "system:nodes" exists in k8s with admin/relevant priviledges\r\nopenssl req -new -key admin.key -subj "/CN=kube-admin/O=system:masters" -out admin.csr\r\n\r\n# Sign Admin admin.crt using ca.csr and ca.key. CA Key Pair is used to sign all server and client certificates\r\nopenssl x509 -req -in ca.csr -signkey ca.key -out admin.crt\r\n\r\n\r\n\r\n# SERVER Certificates ---------------------------------------------------------\r\n\r\n# Generate Private Key kube-apiserver.key for kube-apiserver\r\nopenssl genrsa -out kube-apiserver.key 2048\r\n\r\n# Generate Certificate Signing Request (CSR) kube-apiserver.crs using kube-apiserver.key for kube-apiserver. CSR is a certificate with all your details but without signature\r\nopenssl req -new -key kube-apiserver.key -subj "/CN=kube-apiserver" -out kube-apiserver.csr -config openssl.cnf\r\n\r\n# openssl.cnf\r\n[req]\r\nreq_extensions = v3_req\r\ndistinguished_name = req_distinguished_name\r\n[ v3_req ]\r\nbasicConstraints = CA:FALSE\r\nkeyUsage = nonRepudiation,\r\nsubjectAltName = @alt_names\r\n[alt_names]                        # Only clients refering to kube-apiserver by defined names can establish valid connection\r\nDNS.1 = kubernetes\r\nDNS.2 = kubernetes.default\r\nDNS.3 = kubernetes.default.svc\r\nDNS.4 = kubernetes.deafult.svc.cluster.local\r\nIP.1 = 10.96.0.1\r\nIP.2 = 172.17.0.87\r\n\r\n# Sign kube-apiserver kube-apiserver.crt using ca.csr and ca.key. CA Key Pair is used to sign all server and client certificates\r\nopenssl x509 -req -in kube-apiserver.csr -signkey ca.key -out kube-apiserver.crt\n'})}),"\n",(0,s.jsx)(n.h3,{id:"1034-view-certificate-details",children:"10.3.4. View Certificate Details"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"# View Certificate Details and Perform a healthcheck of Certificates ----------\r\n# Check Details:\r\n#   - Common Name (e.g. kube-apiserver)\r\n#   - Subject Alternative Name (kubernetes, kubernetes.default etc.)\r\n#   - Validity (e.g. expirity date)\r\n#   - Issuer (e.g. CA)\r\n#   - See https://kubernetes.io/docs/setup/best-practices/certificates/ or https://github.com/mmumshad/kubernetes-the-hard-way/tree/master/tools\r\n\r\nopenssl x509 -in /etc/kubernetes/pki/apiserver.crt -text -noout\r\n\r\n\r\n# Show certificate of server --------------------------------------------------\r\n\r\nopenssl s_client -connect <ip-of-host>\r\n\r\n\r\n# Inspect Service Logs --------------------------------------------------------\r\n\r\njournalctl -u etcd.service -l\r\n\r\nkubectl logs etcd-master\n"})}),"\n",(0,s.jsx)(n.h2,{id:"104-certificate-api",children:"10.4. Certificate API"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["In a Kubernetes cluster, a ",(0,s.jsx)(n.strong,{children:"Certificate Authority (CA) server"})," is responsible for managing and issuing digital certificates"]}),"\n",(0,s.jsx)(n.li,{children:"If a new developer needs to access k8s cluster, he/she must create Private Key and provide CSR which then will be signed with CA private key on CA server by k8s admins"}),"\n",(0,s.jsxs)(n.li,{children:["The built-in ",(0,s.jsx)(n.strong,{children:"Certificate API"})," in Kubernetes is a set of resources and functionalities that facilitate the management of TLS certificates within a Kubernetes cluster (e.g. sign and rotate certificates etc.)","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Admin creates ",(0,s.jsx)(n.code,{children:"CertificateSigningRequest"})," object (e.g. Instead of signing to CA server and signing certificate manually)"]}),"\n",(0,s.jsx)(n.li,{children:"Request then can be reviewed"}),"\n",(0,s.jsxs)(n.li,{children:["And approved using ",(0,s.jsx)(n.code,{children:"kubectl get csr && kubectl certificate approve <name-of-csr>"})," commands"]}),"\n",(0,s.jsxs)(n.li,{children:["Certificates then can be extracted and shared with users with ",(0,s.jsx)(n.code,{children:'kubectl get csr <name-of-csr> -o yaml && echo "certificate-encoded-in-base64" | base64 --decode'})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Kube Controller Manager"})," is responsible for operations with certificates (components: CSR-APPROVING, CSR-SIGNING)"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"1041-steps-to-generate-certificate-for-a-new-user",children:"10.4.1. Steps to generate certificate for a new User"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:'# USER creates Private Key and CSR\r\nopenssh genrsa -out jane.key 2048\r\nopenssl req -new -key jane.key -subj "/CN=jane" -out jane.csr\r\n\r\n\r\n# ADMIN encodes in with base64, creates CertificateSigningRequest object, approve and share certificate with user\r\ncat jane.csr | base64 -w 0\r\n\r\n\r\napiVersion: certificates.k8s.io/v1\r\nkind: CertificateSigningRequest\r\nmetadata:\r\n  name: jane\r\nspec:\r\n  request: <base64-encoded-csr>\r\n  expirationSeconds: 600\r\n  usages:\r\n    - digital signature\r\n    - key encipherment\r\n    - server auth\r\n\r\n\r\nkubect get csr\r\nkubect certificate approve jane\r\nkubectl get csr <name-of-csr> -o yaml \r\necho "certificate-encoded-in-base64" | base64 --decode\n'})}),"\n",(0,s.jsx)(n.h2,{id:"105-kubeconfig",children:"10.5. KubeConfig"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"# View KubeConfig\r\nkubectl config view --kubeconfig=/custom/path/to/config\r\nkubectl config use-context prod-user@production\r\nkubectl config -h\r\n\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:'# Authenticate using Certificates with curl,kubectl or define all values in $HOME/.kube/config\r\n\r\ncurl https://kube-apiserver:6443/api/v1/pods --key admin.key --cert admin.crt --cacert ca.crt\r\nkubect get pods --server kube-apiserver:6443 --client-key admin.key --client-certificate admin.crt --certificate-authority ca.crt\r\n\r\n\r\n# $HOME/.kube/config\r\napiVersion: v1\r\nkind: Config\r\ncurrent-context: kubernetes-admin@kubernetes-cluster\r\nclusters:                                     # Clusters (e.g. dev, prod, google)\r\n- name: kubernetes-cluster\r\n  cluster:\r\n    certificate-authority: ca.crt             # alternatively use "certificate-authority-data: <base64-encoded-certificate>"\r\n    server: https://kube-apiserver:6443\r\nkind: Config\r\nusers:                                        # Users (e.g. admin, devuser, produser)\r\n- name: kubernetes-admin\r\n  user:\r\n    client-certificate: admin.crt\r\n    client-key: admin.key\r\ncontexts:                                     # Contexts (<user>@<cluster> e.g. admin@dev, devuser@prod)\r\n- name: kubernetes-admin@kubernetes-cluster\r\n  context:\r\n    cluster: kubernetes-cluster\r\n    user: kubernetes-admin\r\n    namespace: kubernetes-namespace\n'})}),"\n",(0,s.jsx)(n.h2,{id:"106-persistent-keyvalue-store",children:"10.6. Persistent Key/Value Store"}),"\n",(0,s.jsx)(n.h2,{id:"107-api-group",children:"10.7. API Group"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"API groups"})," make it easier to extend the Kubernetes API. The API group is specified in a ",(0,s.jsx)(n.em,{children:"REST path"})," and in the ",(0,s.jsx)(n.em,{children:"apiVersion field"})," of a serialized object."]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"/metrics"}),"\n",(0,s.jsx)(n.li,{children:"/healthz"}),"\n",(0,s.jsx)(n.li,{children:"/version"}),"\n",(0,s.jsx)(n.li,{children:"/logs"}),"\n",(0,s.jsx)(n.li,{children:"/api (responsible for cluster functionality)"}),"\n",(0,s.jsx)(n.li,{children:"/apis (responsible for cluster functionality)"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"API groups in Kubernetes:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["The ",(0,s.jsx)(n.strong,{children:"core"})," (also called legacy) group is found at REST path ",(0,s.jsx)(n.code,{children:"/api/v1"}),". The core group is not specified as part of the apiVersion field, for example, apiVersion: v1."]}),"\n",(0,s.jsxs)(n.li,{children:["The ",(0,s.jsx)(n.strong,{children:"named groups"})," are at REST path ",(0,s.jsx)(n.code,{children:"/apis/$GROUP_NAME/$VERSION"}),", more organized and use apiVersion: $GROUP_NAME/$VERSION (for example, apiVersion: batch/v1)."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Core groups:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["/api","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["/v1","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"namespaces"}),"\n",(0,s.jsx)(n.li,{children:"pods"}),"\n",(0,s.jsx)(n.li,{children:"rc"}),"\n",(0,s.jsx)(n.li,{children:"events"}),"\n",(0,s.jsx)(n.li,{children:"endpoints"}),"\n",(0,s.jsx)(n.li,{children:"nodes"}),"\n",(0,s.jsx)(n.li,{children:"bindings"}),"\n",(0,s.jsx)(n.li,{children:"PV"}),"\n",(0,s.jsx)(n.li,{children:"PVC"}),"\n",(0,s.jsx)(n.li,{children:"configmaps"}),"\n",(0,s.jsx)(n.li,{children:"secrets"}),"\n",(0,s.jsx)(n.li,{children:"services"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Named groups:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["/apis","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["/apps (API Groups)","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["/v1 (aka apiVersion)","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["/deployments (aka RESOURCES)","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"list, get, create, delete, update, watch (aka VERBS)"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:"/replicasets"}),"\n",(0,s.jsx)(n.li,{children:"/statefulsets"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:"/extensions"}),"\n",(0,s.jsxs)(n.li,{children:["/networking.k8s.io","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["/v1","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"/networkpolicies"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:"/storage.k8s.io"}),"\n",(0,s.jsx)(n.li,{children:"/authentication.k8s.io"}),"\n",(0,s.jsxs)(n.li,{children:["/certificates.k8s.io","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["/v1","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"/certificatesigningrequests"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"# Start Kubectl Proxy (i.e. http proxy service) locally which uses credentials from KubeConfig and provides access to Kube ApiServer\r\nkubectl proxy\r\n# List available API Groups in K8s Cluster/Kube ApiServer\r\ncurl https://localhost:6443 -k\n"})}),"\n",(0,s.jsx)(n.h2,{id:"108-authorization",children:"10.8. Authorization"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Admins"}),"\n",(0,s.jsx)(n.li,{children:"Developers"}),"\n",(0,s.jsx)(n.li,{children:"Bots"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"1081-authorization-modes",children:"10.8.1. Authorization Modes"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Authorization modes"})," refer to the specific configurations or settings that determine which ",(0,s.jsx)(n.a,{href:"#1082-authorization-mechanisms",children:"authorization mechanisms"})," are active:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"AlwaysAllow"}),"\n",(0,s.jsx)(n.li,{children:"Node"}),"\n",(0,s.jsx)(n.li,{children:"ABAC"}),"\n",(0,s.jsx)(n.li,{children:"RBAC"}),"\n",(0,s.jsx)(n.li,{children:"Webhook"}),"\n",(0,s.jsx)(n.li,{children:"AlwaysDeny"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"1082-authorization-mechanisms",children:"10.8.2. Authorization Mechanisms"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Node based","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"used to access within the cluster, e.g. node access to apiserver"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["Attribute Based Authorization (ABAC)","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"difficult to manage as it is managed by policy file defined in Kube ApiServer"}),"\n",(0,s.jsx)(n.li,{children:"external access to apiserver"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:"Role Based Authorization (RBAC)"}),"\n",(0,s.jsx)(n.li,{children:"Webhook"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"# Flag used to set authorization mode on Kube ApiServer. Authorization check in defined ORDER of authorization mode\r\n---authorization-mode = Node,RBAC,Webhook \\\\\n"})}),"\n",(0,s.jsxs)(n.h4,{id:"10821-node-authorizer",children:["10.8.2.1. ",(0,s.jsx)(n.strong,{children:"Node Authorizer"})]}),"\n",(0,s.jsx)(n.p,{children:"e.g. is managed by certificates"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Kube ApiServer (server)","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:['Kubelet (client, certificate group part of "system:node',":node1",'")',"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Read:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Services, Endpoints, Nodes, Pods"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["Write","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Node status, Pod status, events"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.h4,{id:"10822-abac",children:["10.8.2.2. ",(0,s.jsx)(n.strong,{children:"ABAC"})]}),"\n",(0,s.jsx)(n.p,{children:"e.g. is managed by policy file defined in Kube ApiServer (see below)"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Kube ApiServer (server)","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["User (client, e.g. dev-user-1)","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Can View, Create, Delete Pods"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'// ABAC policy file\r\n{"kind": "Policy", "spec": {"user":"dev-user-1", "namespace": "*", "resource": "pods", "apiGroup": "*" }}\n'})}),"\n",(0,s.jsxs)(n.h4,{id:"10823-rbac",children:["10.8.2.3. ",(0,s.jsx)(n.strong,{children:"RBAC"})]}),"\n",(0,s.jsx)(n.p,{children:"e.g. is managed by policy file defined in Kube ApiServer"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Kube ApiServer (server)","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Developers","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["User (client, e.g. dev-user-1)","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Can View Pods"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["Admins","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["User (client, e.g. admin-user-1)","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Can View, Create, Delete Pods"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"10824-webhook",children:"10.8.2.4. Webhook"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Authorization managed by external tool","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Open Policy Agent"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"1083-rbac",children:"10.8.3. RBAC"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Roles"})," and ",(0,s.jsx)(n.strong,{children:"RoleBindings"})," are namespaces, i.e. created within namespace. They created in ",(0,s.jsx)(n.code,{children:"default"})," namespace if the namespace is not defined in description file."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"# Check RBAC\r\n\r\nkubectl roles\r\nkubectl rolebindings\r\nkubectl auth can-i --list \n"})}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Create a Role"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'# Role definition file developer-role.yaml\r\napiVersion: rbac.authorization.k8s.io/v1\r\nkind: Role\r\nmetadata:\r\n  name: developer-role\r\n  namespace: dev-namespace\r\nrules:\r\n  - apiGroups: [""]                       # "" indicates the core API group\r\n    resources: ["pods", "services"]\r\n    verbs: ["get", "list", "create", "update", "delete"]\r\n    resourceName: ["blue", "orange"]      # Specify Pod Names\r\n  - apiGroups: ["apps"]                   # For resources in the apps API group\r\n    resources: ["deployments"]\r\n    verbs: ["get", "list", "create", "update", "delete"]\n'})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Link a Role to User"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"# Bind a Role to User in developer-rolebinding.yaml\r\napiVersion: rbac.authorization.k8s.io/v1\r\nkind: RoleBinding\r\nmetadata:\r\n  name: developer-rolebinding\r\n  namespace: dev-namespace\r\nsubjects:\r\n  - kind: User\r\n    name: dev-user\r\n    apiGroup: rbac.authorization.k8s.io\r\nroleRef:\r\n  kind: Role\r\n  name: developer-role\r\n  apiGroup: rbac.authorization.k8s.io\n"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"1084-cluster-roles-and-role-bindings",children:"10.8.4. Cluster Roles and Role Bindings"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Resources"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"namespaced"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"pods, replicasets, jobs, deployments, services, secrets, roles, rolebindings, configmaps, PVC"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"cluster-scoped"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["nodes","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"nodes are cluster wide/scoped resources and can not be assosiated to any particular namespace"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:"clusterroles"}),"\n",(0,s.jsx)(n.li,{children:"clusterrolebindings"}),"\n",(0,s.jsx)(n.li,{children:"PV"}),"\n",(0,s.jsx)(n.li,{children:"certificatesigningrequests"}),"\n",(0,s.jsx)(n.li,{children:"namespaces"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"# List namespaced and non-namespaces api-resources\r\nkubectl api-resources --namespaced=true/false\n"})}),"\n",(0,s.jsx)(n.p,{children:"E.g. of cluster roles:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Cluster Admin","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Can view, create or delete Nodes"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["Storage Admin","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Can view, create or delete PVs/PVCs"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'apiVersion: rbac.authorization.k8s.io/v1\r\nkind: ClusterRole\r\nmetadata:\r\n  name: cluster-administrator\r\nrules:\r\n  - apiGroups: [""]                  # "" indicates the core API group\r\n    resources: ["nodes"]\r\n    verbs: ["list", "get", "create", "delete"]\n'})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"apiVersion: rbac.authorization.k8s.io/v1\r\nkind: ClusterRoleBinding\r\nmetadata:\r\n  name: cluster-admin-clusterrolebinding\r\nsubjects:\r\n  - kind: User\r\n    name: cluster-admin\r\n    apiGroup: rbac.authorization.k8s.io\r\nroleRef:\r\n  kind: ClusterRole\r\n  name: cluster-administrator\r\n  apiGroup: rbac.authorization.k8s.io\n"})}),"\n",(0,s.jsx)(n.h2,{id:"109-service-accounts",children:"10.9. Service Accounts"}),"\n",(0,s.jsx)(n.p,{children:"Types of user accounts:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["User account","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"used by humans"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["Service account","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"used by machines, bots, application (e.g. Premetheus, Jenkins)"}),"\n",(0,s.jsx)(n.li,{children:"has an automatically (must be manually created from version v1.24) created token, stored as secret"}),"\n",(0,s.jsx)(n.li,{children:"every namespace has default service account, which associated to pod on creation"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"kubectl get serviceaccount\r\nkubectl create serviceaccount <service-account-name>\n"})}),"\n",(0,s.jsx)(n.h2,{id:"1010-image-security",children:"10.10. Image Security"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"# Create a secret of type docker-registry\r\nkubectl create secret docker-registry <secret-name> \\\r\n--docker-server=string \\\r\n--docker-username=user \\\r\n--docker-password=password \\\r\n--docker-email=email \\\r\n[--from-file=[key=]source] [--dry-run=server|client|none]\r\n\r\n\r\napiVersion: v1\r\nkind: Pod\r\nmetadata:\r\n  name: nginx-pod\r\nspec:\r\n  containers:\r\n  - name: nginx-container\r\n    image: nginx:latest\r\n  imagePullSecrets:\r\n  - name: <docker-registry-secret-name>\n"})}),"\n",(0,s.jsx)(n.h2,{id:"1011-docker-security",children:"10.11. Docker Security"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"# Capability of root user list under\r\ncat /usr/include/linux/capability.h\r\n# E.g.: CHOWN, DAC, KILL, SETFCAP, SETPCAP, SETGID, SETUID, NET_BIND, NET_RAW, MAC_ADMIN, BROADCAST, NET_ADMIN, SYS_ADMIN, SYS_CHROOT, AUDIT_WRITE, MANY MORE\r\n\r\n\r\n# Root user in linux and docker container does not have the same capabilities\r\n\r\n# Add or Drop additional capabilities to docker container with\r\ndocker run --cap-add MAC_ADMIN ubuntu\r\ndocker run --cap-drop KILL ubuntu\r\n\r\n# Run docker container with all capabilities\r\ndocker run --privilided ubuntu \n"})}),"\n",(0,s.jsx)(n.h2,{id:"1012-security-context",children:"10.12. Security Context"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:'apiVersion: v1\r\nkind: Pod\r\nmetadata:\r\n  name: ubuntu-sleep-pod\r\n  labels:\r\n    app: ubuntu-sleep\r\nspec:\r\n  securityContext:    # Pod Level Security Context\r\n    runAsUser: 1000   # Run the container as user ID 1000\r\n    runAsGroup: 3000  # Run the container as group ID 3000\r\n    fsGroup: 2000     # Set the group ID for mounted volumes\r\n  containers:\r\n    - name: ubuntu-container\r\n      image: ubuntu:latest\r\n      command: ["sleep"]\r\n      args: ["3600"]\r\n      securityContext:    # Container Level Security Context\r\n        runAsUser: 1000   # Run the container as user ID 1000\r\n        runAsGroup: 3000  # Run the container as group ID 3000\r\n        capabilities:     # Capabilities are supported only in container level\r\n          add: ["MAC_ADMIN"]\n'})}),"\n",(0,s.jsx)(n.h2,{id:"1013-network-policies",children:"10.13. Network Policies"}),"\n",(0,s.jsxs)(n.p,{children:["A ",(0,s.jsx)(n.strong,{children:"NetworkPolicy"})," in Kubernetes is a resource that defines rules for controlling the ",(0,s.jsx)(n.strong,{children:"ingress"})," and ",(0,s.jsx)(n.strong,{children:"egress"})," traffic to and from Pods, allowing administrators to specify which Pods can communicate with each other and with external endpoints."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:'# Egress poicity type is not defined, hence egress response traffic not isolated. But egress originiating from db still requires egress policy definition\r\n# Below db only accepts traffic from api-pod on port 3306\r\n\r\napiVersion: networking.k8s.io/v1\r\nkind: NetworkPolicy\r\nmetadata:\r\n  name: db-policy\r\nspec:\r\n  podSelector:\r\n    matchLabels:\r\n      role: db\r\n  policyTypes:\r\n    - Ingress\r\n  ingress:\r\n    - from:\r\n        - podSelector:              # all Pods will be allowed to reach db within defined namespace if podSelector not defined (AND operation)\r\n            matchLabels:\r\n              name: api-pod\r\n          namespaceSelector:        # to restrict Network Policy to specific namespace traffic flow (if - in front of it, then separate rule)\r\n            matchLabels:\r\n              name: prod\r\n        - ipBlock:\r\n            cidr: 192.168.5.10/32   # Allow traffic from specific ip (OR operation with 1st rule "podSelector")\r\n      ports:\r\n      - protocol: TCP\r\n        port: 3306\r\n\r\n\r\n\r\n# Below db only accepts traffic from api-pod on port 3306 AND can push backups to external server with defined ip\r\n\r\napiVersion: networking.k8s.io/v1\r\nkind: NetworkPolicy\r\nmetadata:\r\n  name: db-policy\r\nspec:\r\n  podSelector:\r\n    matchLabels:\r\n      role: db\r\n  policyTypes:\r\n    - Ingress\r\n    - Egress\r\n  ingress:\r\n    - from:\r\n        - podSelector:              # all Pods will be allowed to reach db within defined namespace if podSelector not defined (AND operation)\r\n            matchLabels:\r\n              name: api-pod\r\n      ports:\r\n      - protocol: TCP\r\n        port: 3306\r\n  egress:\r\n    - to:\r\n        - ipBlock:\r\n            cidr: 192.168.5.10/32 \r\n      ports:\r\n      - protocol: TCP\r\n        port: 80\n'})}),"\n",(0,s.jsx)(n.h2,{id:"1014-kubectx-and-kubens",children:"10.14. Kubectx and Kubens"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"kubectx"})," is a tool to switch between contexts (clusters)\r\n",(0,s.jsx)(n.strong,{children:"kubens"})," is a tool to switch between Kubernetes namespaces"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"# kubens and kubectx installation\r\nsudo git clone https://github.com/ahmetb/kubectx /opt/kubectx\r\nsudo ln -s /opt/kubectx/kubectx /usr/local/bin/kubectx\r\nsudo ln -s /opt/kubectx/kubens /usr/local/bin/kubens\n"})}),"\n",(0,s.jsx)(n.h2,{id:"1015-custorm-resource-definition-crd",children:"10.15. Custorm Resource Definition (CRD)"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Resource - objects that represent the state of the cluster","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"ReplicaSet"}),"\n",(0,s.jsx)(n.li,{children:"Deployments"}),"\n",(0,s.jsx)(n.li,{children:"Job"}),"\n",(0,s.jsx)(n.li,{children:"CronJob"}),"\n",(0,s.jsx)(n.li,{children:"Statefulset"}),"\n",(0,s.jsx)(n.li,{children:"Namespace"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["Controller -  control loops that manage the lifecycle of resources to maintain the desired state","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"ReplicaSet"}),"\n",(0,s.jsx)(n.li,{children:"Deployments"}),"\n",(0,s.jsx)(n.li,{children:"Job"}),"\n",(0,s.jsx)(n.li,{children:"CronJob"}),"\n",(0,s.jsx)(n.li,{children:"Statefulset"}),"\n",(0,s.jsx)(n.li,{children:"Namespace"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Custom resource"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"# flight-ticket.yaml\r\napiVersion: flights.com/v1\r\nkind: FlightTicket\r\nmetadata:\r\n  name: my-flight-ticket\r\nspec:\r\n  from: Berlin\r\n  to: London\r\n  number: 2\n"})}),"\n",(0,s.jsx)(n.p,{children:"Custom Resource Definition (CRD)"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'apiVersion: apiextensions.k8s.io/v1\r\nkind: CustomResourceDefinition\r\nmetadata:\r\n  name: flighttickets.flights.com\r\nspec:\r\n  group: flights.com         # value of "apiVersion" of definition file\r\n  scope: Namespaced\r\n  names:\r\n    kind: FlightTicket       # value of "kind" of definition file\r\n    singular: flightticket\r\n    plural: flighttickets\r\n    shortnames:\r\n      - ft\r\n  versions:\r\n  - name: v1\r\n    served: true\r\n    storage: true\r\n    schema:\r\n      openAPIV3Schema:\r\n        type: object\r\n        properties:\r\n          spec:\r\n            type: object\r\n            properties:\r\n              from:\r\n                type: string\r\n              to:\r\n                type: string\r\n              number:\r\n                type: integer\r\n                minumum: 1\r\n                maximum: 10\n'})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"kubectl create -f flight-ticket.yaml\r\nkubectl get flightticket\r\nkubectl delete flightticket\n"})}),"\n",(0,s.jsx)(n.h2,{id:"1016-custom-controllers",children:"10.16. Custom Controllers"}),"\n",(0,s.jsx)(n.p,{children:"To create Custom Controller"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Install Go"}),"\n",(0,s.jsxs)(n.li,{children:["Clone ",(0,s.jsx)(n.a,{href:"https://github.com/kubernetes/sample-controller",children:"sample of custom controller"})]}),"\n",(0,s.jsx)(n.li,{children:"Customize controller.go"}),"\n",(0,s.jsxs)(n.li,{children:["Build it with ",(0,s.jsx)(n.code,{children:"go build -o sample-controller ."})]}),"\n",(0,s.jsxs)(n.li,{children:["Run it with ",(0,s.jsx)(n.code,{children:"./sample-controller -kubeconfig=$HOME/.kube/config"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Custom Controller can be containerized and run as k8s pod"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-go",children:'// flightticket_controller.go\r\npackage flightticket\r\n\r\nvar controllerKind = \r\napps.SchemeGroupVersion.WithKind("Flightticket")\r\n\r\n// Run begins watching and syncing\r\nfunc (dc *FligjtTicketController) Run (worker int, stopCh <-chan struct{})\r\n\r\n// Cal BookFlightAPIReplicaSet\r\nfunc (dc *FlightTicketController) callBookFlightAPI(obj interface{})\n'})}),"\n",(0,s.jsx)(n.h2,{id:"1017-operator-framework",children:"10.17. Operator Framework"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Operator Framework can be used to package Custom Resource Definition and Custom Controller together as simple entity"}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"etcd operator"})," is famous example to deploy and manage an etcd cluster within kubernetes","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["CRS","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"EtcdCluster"}),"\n",(0,s.jsx)(n.li,{children:"EtcdBackup"}),"\n",(0,s.jsx)(n.li,{children:"EtcdRestore"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["CC","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"ETCD Controller"}),"\n",(0,s.jsx)(n.li,{children:"Backup Operator"}),"\n",(0,s.jsx)(n.li,{children:"Restore Operator"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["Check ",(0,s.jsx)(n.a,{href:"https://operatorhub.io/",children:"OperatorHub.io"})," for available operators"]}),"\n"]}),"\n",(0,s.jsx)(n.h1,{id:"11-storage",children:"11. Storage"}),"\n",(0,s.jsx)(n.h2,{id:"111-docker-storage",children:"11.1. Docker Storage"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Storage Drivers"}),"\n",(0,s.jsx)(n.li,{children:"Volume Drivers"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"1111-docker-storage-drivers-and-file-systems",children:"11.1.1. Docker Storage Drivers and File Systems"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Storage Drivers"})," in Docker enables Layered Architecture and helps to manage storage on images and containers. Common Storage Drivers:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"AUFS (default SD on Ubuntu)"}),"\n",(0,s.jsx)(n.li,{children:"ZFS"}),"\n",(0,s.jsx)(n.li,{children:"BTRFS"}),"\n",(0,s.jsx)(n.li,{children:"Device Mapper"}),"\n",(0,s.jsx)(n.li,{children:"Overlay"}),"\n",(0,s.jsx)(n.li,{children:"Overlay2"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"By default Docker stores data in"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["/var/lib/docker","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"/aufs"}),"\n",(0,s.jsxs)(n.li,{children:["/containers      (layered architecture, transient, ",(0,s.jsx)(n.strong,{children:"container layers are read/write"}),")"]}),"\n",(0,s.jsxs)(n.li,{children:["/image           (layered architecture, ",(0,s.jsx)(n.strong,{children:"image layers are read-only"}),")"]}),"\n",(0,s.jsxs)(n.li,{children:["/volumes","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["/data_volume","\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"# Volume created with\r\ndocker volume create data_volume \r\n# and use either with VOLUME MOUNT: \r\ndocker run -v data_volume:/var/lib/mysql mysql \r\n# BIND MOUNT: \r\ndocker run -v /data/mysql:/var/lib/mysql mysql\r\ndocker run --mount type=bind, source=/data/mysql, target=/var/lib/mysql mysql\n"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"1112-volume-driver-plugins-in-docker",children:"11.1.2. Volume Driver Plugins in Docker"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Volumes"})," in Docker are handled by ",(0,s.jsx)(n.strong,{children:"Volume Driver Plugins"})," and not by Storage Drivers."]}),"\n",(0,s.jsx)(n.p,{children:"Volume Driver Plugins:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Local (default)"}),"\n",(0,s.jsx)(n.li,{children:"Azure File Storage"}),"\n",(0,s.jsx)(n.li,{children:"Convoy"}),"\n",(0,s.jsx)(n.li,{children:"DigitalOcean Block Storage"}),"\n",(0,s.jsx)(n.li,{children:"Flocker"}),"\n",(0,s.jsx)(n.li,{children:"gce-docker"}),"\n",(0,s.jsx)(n.li,{children:"GlusterFS"}),"\n",(0,s.jsx)(n.li,{children:"NetApp"}),"\n",(0,s.jsx)(n.li,{children:"RexRay"}),"\n",(0,s.jsx)(n.li,{children:"Portworx"}),"\n",(0,s.jsx)(n.li,{children:"VMware vSphere Storage"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"# AWS Cloud Storage, Amazon EBS\r\ndocker run -it --name mysql --volume-driver rexray/ebs --mount src=ebs-vol, target=/var/lib/mysql mysql\n"})}),"\n",(0,s.jsx)(n.h2,{id:"112-container-interfaces",children:"11.2. Container Interfaces"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Kubernetes"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Container Runtime Interface (CRI)"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"rkt"}),"\n",(0,s.jsx)(n.li,{children:"docker"}),"\n",(0,s.jsx)(n.li,{children:"cri-o"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Container Network Interface (CNI)"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"waveworks"}),"\n",(0,s.jsx)(n.li,{children:"flannel"}),"\n",(0,s.jsx)(n.li,{children:"cilium"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Container Storage Interface (CSI)"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"portworx"}),"\n",(0,s.jsx)(n.li,{children:"Amazon EBS"}),"\n",(0,s.jsx)(n.li,{children:"DELL EMC"}),"\n",(0,s.jsx)(n.li,{children:"GlusterFS"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"1121-container-storage-interface-csi",children:"11.2.1. Container Storage Interface (CSI)"}),"\n",(0,s.jsx)(n.p,{children:"Container Storage Interface (CSI) is not kubernetes specific but universal standard which enables any orchestration tool to work with any storage vendor. Currently Kubernetes, Cloud Foundry and Mesos are with CSI. CSI definces RPCs as:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"CreateVolume"}),"\n",(0,s.jsx)(n.li,{children:"DeleteVolume"}),"\n",(0,s.jsx)(n.li,{children:"ControllerPublishVolume"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"113-volumes",children:"11.3. Volumes"}),"\n",(0,s.jsx)(n.h3,{id:"1131-volumes-and-mounts",children:"11.3.1. Volumes and Mounts"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'apiVersion: v1\r\nkind: Pod\r\nmetadata:\r\n  name: random-number-generator\r\nspec:\r\n  containers:\r\n  - image: alpine\r\n    name: alpine\r\n    command: ["/bin/sh","-c"]\r\n    args: ["shuf -i 0-100 -n 1 >> /opt/number.out;"]\r\n    volumeMounts:\r\n    - mountPath: /opt\r\n      name: data-volume\r\n  \r\n  volumes:\r\n  - name: data-volume\r\n    hostPath:                             # hostPath (bounded to node)\r\n      path: /data\r\n      type: Directory\n'})}),"\n",(0,s.jsx)(n.h3,{id:"1132-volume-types",children:"11.3.2. Volume Types"}),"\n",(0,s.jsx)(n.p,{children:"Volume Types:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"NFS"}),"\n",(0,s.jsx)(n.li,{children:"GlusterFS"}),"\n",(0,s.jsx)(n.li,{children:"Flocker"}),"\n",(0,s.jsx)(n.li,{children:"Ceph"}),"\n",(0,s.jsx)(n.li,{children:"Scaleio"}),"\n",(0,s.jsx)(n.li,{children:"AWS"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"volumes:\r\n- name: data-volume\r\n  hostPath:                             # hostPath (bounded to node)\r\n    path: /data\r\n    type: Directory\r\n\r\n\r\nvolumes:\r\n- name: data-volume\r\n  awsElasticBlockStore:                 # awsElasticBlockStore (not bounded to node)\r\n    volumeID: <volume-id>\r\n    fsType: ext4\n"})}),"\n",(0,s.jsx)(n.h2,{id:"114-persistent-volumes-pv",children:"11.4. Persistent Volumes (PV)"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Persistent Volumes (PV)"})," is a cluster-wide pool of storage volumes configured by administrator. Resources can select storage from PV pool using ",(0,s.jsx)(n.strong,{children:"Persistent Volume Claims (PVC)"}),"."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"apiVersion: v1\r\nkind: PersistentVolume\r\nmetadata:\r\n  name: pv-vol1\r\nspec:\r\n  accessModes:                                    # accessMode - how a volume should be mounted on the host\r\n    - ReadWriteOnce                               # ReadOnlyMany, ReadWriteOnce, ReadWriteMany\r\n  persistentVolumeReclaimPolicy: Retain           # Defines what happens to the volume when it is released. Recycle, Delete, Retain (will not be deleted)\r\n  capacity:\r\n    storage: 1Gi\r\n  # 1. Option\r\n  hostPath:                                       # Not for PROD\r\n    path: /tmp/data\r\n  # 2. Option\r\n  awsElasticBlockStore:\r\n    volumeID: <volume-id>\r\n    fsType: ext4\n"})}),"\n",(0,s.jsx)(n.h2,{id:"115-persistent-volume-claims-pvc",children:"11.5. Persistent Volume Claims (PVC)"}),"\n",(0,s.jsx)(n.p,{children:"Resources will be boind to a single Persistent Volume (PV) by Persistent Volume Claims (PVC). During the bind following criterias are considered:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Sufficient Capacity"}),"\n",(0,s.jsx)(n.li,{children:"Access Modes"}),"\n",(0,s.jsx)(n.li,{children:"Volume Modes"}),"\n",(0,s.jsx)(n.li,{children:"Storage Class"}),"\n",(0,s.jsx)(n.li,{children:"Selector (is used to bind PVC to specific PV)"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'apiVersion: v1\r\nkind: PersistentVolumeClaim\r\nmetadata:\r\n  name: my-persistent-volume-claim\r\nspec:\r\n  accessModes:\r\n    - ReadWriteOnce\r\n  resources:\r\n    requests:\r\n      storage: 500Mi\r\n---\r\napiVersion: v1\r\nkind: Pod\r\nmetadata:\r\n  name: mypod\r\nspec:\r\n  containers:\r\n    - name: myfrontend\r\n      image: nginx\r\n      volumeMounts:\r\n      - mountPath: "/var/www/html"\r\n        name: mypd\r\n  volumes:\r\n    - name: mypd\r\n      persistentVolumeClaim:\r\n        claimName: my-persistent-volume-claim\n'})}),"\n",(0,s.jsx)(n.h2,{id:"116-storage-class",children:"11.6. Storage Class"}),"\n",(0,s.jsx)(n.h3,{id:"1161-static-provisioning-of-volume",children:"11.6.1. Static Provisioning of Volume"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Before PV is created a disk on e.g. google-cloud must be created manually"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"gcloud beta compute disks create --size 1GB --region us-east1 pd-disk\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"apiVersion: v1\r\nkind: PersistentVolumeClaim\r\nmetadata:\r\n  name: my-persistent-volume-claim\r\nspec:\r\n  accessModes:\r\n    - ReadWriteOnce\r\n  resources:\r\n    requests:\r\n      storage: 500Mi\n"})}),"\n",(0,s.jsx)(n.h3,{id:"1162-dynamic-provisioning-of-volume",children:"11.6.2. Dynamic Provisioning of Volume"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"PV Definition is not needed for DPV but created automatically by StorageClass"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"apiVersion: storage.k8s.io/v1\r\nkind: StorageClass\r\nmetadata:\r\n  name: google-storage\r\nprovisioner: kubernetes.io/gce-pd\r\nparameters:\r\n  type: pd-standard\r\n  replication-type: none\r\n---\r\napiVersion: v1\r\nkind: PersistentVolumeClaim\r\nmetadata:\r\n  name: my-persistent-volume-claim\r\nspec:\r\n  accessModes:\r\n    - ReadWriteOnce\r\n  storageClassName: google-storage               # Definition of storageClassName to dynamically define PV and create disk\r\n  resources:\r\n    requests:\r\n      storage: 500Mi\n"})}),"\n",(0,s.jsx)(n.h1,{id:"12-networking",children:"12. Networking"}),"\n",(0,s.jsx)(n.h2,{id:"121-coredns",children:"12.1. CoreDNS"}),"\n",(0,s.jsx)(n.p,{children:"Read more about CoreDNS here:"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.a,{href:"https://github.com/kubernetes/dns/blob/master/docs/specification.md",children:"https://github.com/kubernetes/dns/blob/master/docs/specification.md"}),"\r\n",(0,s.jsx)(n.a,{href:"https://coredns.io/plugins/kubernetes/",children:"https://coredns.io/plugins/kubernetes/"})]}),"\n",(0,s.jsx)(n.h1,{id:"13-design-and-install-a-kubernetes-cluster",children:"13. Design and Install a Kubernetes Cluster"}),"\n",(0,s.jsx)(n.h1,{id:"14-install-k8s-the-kubeadm-way",children:'14. Install "K8s the kubeadm way"'}),"\n",(0,s.jsx)(n.h1,{id:"15-helm-basics",children:"15. Helm Basics"}),"\n",(0,s.jsx)(n.h2,{id:"151-what-is-helm",children:"15.1. What is Helm"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Helm"})," is a package manager for Kubernetes."]}),"\n",(0,s.jsx)(n.h2,{id:"152-helm-components",children:"15.2. Helm Components"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"helm charts"}),"\n",(0,s.jsx)(n.li,{children:"helm cli"}),"\n",(0,s.jsx)(n.li,{children:"helm releases"}),"\n",(0,s.jsxs)(n.li,{children:["helm chart repository","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["ArtifactHun.io","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Appscode"}),"\n",(0,s.jsx)(n.li,{children:"TrueCharts"}),"\n",(0,s.jsx)(n.li,{children:"Bitnami"}),"\n",(0,s.jsx)(n.li,{children:"Community Operators"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h1,{id:"16-kustomize-basics",children:"16. Kustomize Basics"}),"\n",(0,s.jsx)(n.h1,{id:"17-end-to-end-tests-on-a-k8s-cluster",children:"17. End to End tests on a K8s Cluster"}),"\n",(0,s.jsx)(n.h1,{id:"18-troubleshooting",children:"18. Troubleshooting"}),"\n",(0,s.jsx)(n.h1,{id:"19-other-topics",children:"19. Other Topics"}),"\n",(0,s.jsx)(n.h1,{id:"20-ligtning-labs",children:"20. Ligtning Labs"}),"\n",(0,s.jsx)(n.h1,{id:"21-mock-exams",children:"21. Mock Exams"}),"\n",(0,s.jsx)(n.h1,{id:"22-course-conclusion",children:"22. Course Conclusion"}),"\n",(0,s.jsx)(n.h1,{id:"23-commands",children:"23. Commands"}),"\n",(0,s.jsx)(n.h2,{id:"231-kubernetes",children:"23.1. Kubernetes"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"# GET\r\n\r\nkubectl get all\r\n\r\nkubectl get pods --watch\r\nkubectl get pods -n kube-system\r\nkubectl get pods -o wide\r\n\r\nkubectl get pods -l environment=production,tier=frontend\r\nkubectl get pods -l 'environment in (production),tier in (frontend)'\r\nkubectl get pods -l 'environment,environment notin (frontend)'\r\n\r\nkubectl get pods --selector app=App1\r\nkubectl get pods --selector app=App1 --no-headers | wc -l\r\n\r\nkubectl get pod <pod-name> --all-namespaces\r\n\r\nkubectl get replicationcontroller\r\nkubectl get replicaset\r\nkubectl get replicaset myapp-rs -o yaml\r\n\r\nkubectl get deployments\r\n\r\nkubectl get services\r\n\r\nkubectl get configmaps\r\n\r\nkubectl get secrets\r\nkubectl get secret app-secret -o yaml\r\n\r\nkubectl get hpa\r\n\r\nkubectl get all --all-namespaces -o yaml > all-resources.yaml                 # Backup all resource configurations\r\n\r\nkubectl get serviceaccount\r\n\r\nkubectl get roles\r\n\r\nkubectl get rolebindings\r\n\r\n\r\n\r\n\r\n\r\n# DESCRIBE\r\n\r\nkubectl describe pod myapp-pod\r\nkubectl describe node kubemaster\r\n\r\n\r\n\r\n\r\n\r\n\r\n# APPLY\r\n\r\nkubectl apply -f object-definition-file.yaml                                   # Create or Update (DEFAULT Rolling Update) k8s object \r\nkubectl apply -f /path/to/object-definition-files\r\n\r\n\r\n\r\n\r\n\r\n# CREATE\r\n\r\nkubectl create deployment --image=nginx nginx --namespace=dev\r\nkubectl create deployment my-deployment --image=nginx nginx --replicas=3 --dry-run=client -o yaml\r\n\r\nkubectl create service nodeport myapp-service --tcp=8080:8080 --dry-run=client -o yaml\r\n\r\nkubectl create namespace dev\r\n\r\nkubectl create configmap <config-name> --from-literal=APP_COLOR=blue\r\nkubectl create configmap <config-name> --from-file=app_config.properties\r\n\r\nkubectl create secret generic <secret-name> --from-literal=<key>=<value>\r\nkubectl create secret generic <secret-name> --from-file=<path-to-file>\r\n\r\nkubectl create serviceaccount <service-account-name>\r\nkubectl create token <service-account-name>\r\n\r\nkubectl create secret docker-registry <secret-name> \\\r\n--docker-server=string \\\r\n--docker-username=user \\\r\n--docker-password=password \\\r\n--docker-email=email [--from-file=[key=]source] [--dry-run=server|client|none]\r\n\r\n\r\n\r\n# EXEC\r\n\r\nkubectl exec etcd-master -n kube-system etcdctl get / --prefix -keys-only\r\n\r\n\r\n\r\n\r\n\r\n# RUN\r\n\r\nkubectl run nginx --image=nginx --namespace=default --dry-run=client -o yaml\r\nkubectl run nginx --image=nginx -- <arg1> <arg2> ... <argN>\r\nkubectl run nginx --image=nginx --command -- <cmd> <arg1> <arg2> ... <argN>\r\n\r\n\r\n\r\n\r\n\r\n\r\n# EDIT\r\n\r\nkubectl edit replicaset\r\n\r\n\r\n\r\n\r\n\r\n\r\n# LABEL\r\n\r\nkubectl label nodes <node-name> <label-key>=<label-value>\r\n\r\n\r\n\r\n\r\n\r\n# REPLACE\r\n\r\nkubectl replace --force -f replicaset-definition.yaml\r\n\r\n\r\n\r\n\r\n\r\n# SCALE\r\n\r\nkubectl scale --replicas=6 -f replicaset-definition.yaml\r\nkubectl scale --replicas=6 -f replicaset myapp-rs\r\n\r\n\r\n\r\n\r\n\r\n# AUTOSCALE \r\n\r\nkubectl autoscale deployment foo --cpu-percent=50 --min=1 --max=10                # Create HPA for a deployment \"foo\" with CPU thresholds of 50% and min 1 pod and max 10 pods\r\n\r\n\r\n\r\n\r\n# DELETE\r\n\r\nkubectl delete replicaset myapp-replicaset               # deletes all underlying Pods \r\n\r\n\r\n\r\n\r\n\r\n# CONFIG\r\n\r\nkubectl config -h\r\nkubectl config view --kubeconfig=/custom/path/to/config\r\nkubectl config use-context <user-name>@<cluster-name>\r\nkubectl config set-context $(kubectl config current-context) --namespace=dev\r\n\r\n\r\n\r\n\r\n\r\n# TAINT\r\n\r\nkubectl taint nodes <NODE-NAME> <KEY>=<VALUE>:<TAINT-EFFECT>                    # TAINT-EFFECTs: NoSchedule, PreferNoSchedule, NoExecute\r\nkubectl taint nodes <NODE-NAME> <KEY>=<VALUE>:<TAINT-EFFECT>-                   # UNTAINT\r\n\r\n\r\n\r\n\r\n# LOGS\r\n\r\nkubectl logs -f <pod-name>\r\nkubectl logs -f <pod-name> [container-name]\r\n\r\n\r\n\r\n\r\n# AUTH\r\n\r\nkubectl auth can-i --list                                                      # check current user permissions\r\nkubectl auth can-i <verb> <resource> -n <namespace> --as <user-name>           # check if the current user can perform a specific action on a resource\r\nkubectl auth can-i create pods -n <namespace> --as dev-user                                  \r\n\r\n\r\n\r\n\r\n# ROLLOUT\r\n\r\nkubectl rollout status deployment/<depoyment-name>                                 # Check the status of a rollout\r\nkubectl rollout history deployment/<depoyment-name>                                # Show the history of rollouts\r\nkubectl rollout undo deployment/<depoyment-name> --to-revision=<revision_number>   # Undo a rollout to the specific revision\r\n\r\n\r\n\r\n\r\n# DRAIN\r\n\r\nkubectl drain <node-name>                                   # drain the node (will be marked as unschedulable) for maintenance purpose to gracefully terminate pods running on it and to reschedule them. \r\n\r\n\r\n\r\n\r\n# CORDON\r\n\r\nkubectl cordon <node-name>                                  # cordon node (mark as unschedulable) so that no new pods are scheduled on it\r\n\r\n\r\n\r\n\r\n\r\n# UNCORDON\r\n\r\nkubectl uncordon <node-name>                                # uncordon the node so that pods can be scheduled on it after drain\r\n\r\n\r\n\r\n\r\n\r\n# KUBE-CONTROLLER-MANAGER\r\n\r\nkube-controller-manager --pod-eviction-timeout=5m0s                          # set time to wait pods to be evicted. I.e. control plane waits 5 minutes before considering the pod as dead and redeploy it\r\n\r\n\r\n\r\n\r\n\r\n# ETCDCTL\r\n\r\nETCDCTL_API=3 etcdctl member list\r\nETCDCTL_API=3 etcdctl snapshot save etcd_snapshot.db \\\r\n                      --endpoints=https://127.0.0.1:2379 \\\r\n                      --cacert=/etc/etcd/ca.crt \\\r\n                      --cert=/etc/etcd/etcd-server.crt \\\r\n                      --key=/etc/etcd/etcd-server.key\r\nETCDCTL_API=3 etcdctl snapshot status etcd_snapshot.db\r\nETCDCTL_API=3 etcdctl snapshot restore etcd_snapshot.db --data-dir /var/lib/etcd-from-backup\r\n\n"})}),"\n",(0,s.jsx)(n.h2,{id:"232-helm",children:"23.2. Helm"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:'# INSTALL\r\n\r\nhelm install <release-name> <package-name> --version <version>\r\nhelm install --set <varName1>="newValue1" --set <varName2>="newValue2" <release-name> <package-name>\r\nhelm install --values <custom-value-file-name.yaml> <release-name> <package-name>\r\n\r\n\r\n\r\n\r\n# UNINSTALL\r\n\r\nhelm uninstall <package-name>\r\n\r\n\r\n\r\n\r\n# PULL\r\n\r\nhelm pull --untar <package-name>\r\n\r\n\r\n\r\n\r\n\r\n# UPGRARE\r\n\r\nhelm upgrade <release-name> <package-name>\r\n\r\n\r\n\r\n\r\n# ROLLBACK\r\n\r\nhelm rollback <release-name> <revision-number>\r\n\r\n\r\n\r\n\r\n# HISTORY\r\n\r\nhelm history <release-name>\n'})}),"\n",(0,s.jsx)(n.h1,{id:"24-references",children:"24. References"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://www.udemy.com/course/certified-kubernetes-administrator-with-practice-tests",children:"Certified Kubernetes Administrator (CKA) with Practice Tests by Mumshad Mannambeth"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://kubernetes.io/docs/reference/generated/kubectl/kubectl-commands",children:"Kubernetes Commands"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>t,x:()=>c});var i=r(6540);const s={},l=i.createContext(s);function t(e){const n=i.useContext(l);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:t(e.components),i.createElement(l.Provider,{value:n},e.children)}}}]);