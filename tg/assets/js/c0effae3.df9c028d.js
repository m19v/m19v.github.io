"use strict";(self.webpackChunkm_19_v=self.webpackChunkm_19_v||[]).push([[6940],{2769:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>r,contentTitle:()=>o,default:()=>h,frontMatter:()=>i,metadata:()=>a,toc:()=>c});const a=JSON.parse('{"id":"references/cheat-sheet/automation/ansible","title":"Ansible","description":"ansible.cfg","source":"@site/docs/references/cheat-sheet/automation/ansible.md","sourceDirName":"references/cheat-sheet/automation","slug":"/references/cheat-sheet/automation/ansible","permalink":"/tg/docs/references/cheat-sheet/automation/ansible","draft":false,"unlisted":false,"editUrl":"https://github.com/m19v/m19v.github.io/blob/main/docs/references/cheat-sheet/automation/ansible.md","tags":[],"version":"current","lastUpdatedBy":"m19v","lastUpdatedAt":1761828399000,"frontMatter":{"title":"Ansible"},"sidebar":"tutorialSidebar","previous":{"title":"Automation","permalink":"/tg/docs/category/automation"},"next":{"title":"CICD","permalink":"/tg/docs/category/cicd"}}');var t=s(4848),l=s(8453);const i={title:"Ansible"},o="Installation",r={},c=[{value:"ansible.cfg",id:"ansiblecfg",level:2},{value:"Adding SSH Key to SSH Agent",id:"adding-ssh-key-to-ssh-agent",level:3},{value:"References",id:"references",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",pre:"pre",ul:"ul",...(0,l.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"installation",children:"Installation"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"apt update\napt upgrade -y\n\napt install ansible -y\n"})}),"\n",(0,t.jsx)(n.h1,{id:"ansible-configuration",children:"Ansible configuration"}),"\n",(0,t.jsx)(n.h2,{id:"ansiblecfg",children:"ansible.cfg"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"[default]\ninventory = nameOfInventoryFile\nprivate_key_file = ~/.ssh/nameOfSSHKey\n"})}),"\n",(0,t.jsx)(n.h1,{id:"ansible-commands",children:"Ansible commands"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:'ansible all --key-file ~/.ssh/nameOfSSHKey -i inventory -m ping\n\nansible all --list-hosts\n\nansible all -m gather_facts\nansible all -m gather_facts --limit ip.address.of.single.host\n\n# sudo apt update to update package index\nansible all -i hosts -m apt -a update_cache=true --become --ask-become-pass\n\n# install tmux\nansible all -i hosts -m apt -a name=tmux --become --ask-become-pass\nansible all -i hosts -m apt -a "name=tmux state=latest" --become --ask-become-pass\n\n# sudo apt dist-upgrade\nansible all -i hosts -m apt -a upgrade=dist --become --ask-become-pass\n\nansible-playbook --ask-become-pass playbookFileName.yml\n\n# List tags of a playbook\nansible-playbook -i nameOfInventory --list-tags playbookFileName.yml\nansible-playbook -i nameOfInventory --tags "tag1,tag2,tag3" --ask-become-pass playbookFileName.yml\n\n# Syntax check\nansible-playbook --syntax-check <YAML>\n\n# Ansoble Vaults\nansible-vault create secret.yml\nansible-vault edit secret.yml\n\n# Ansoble Galaxy\nansible-galaxy install -r requirements.yml\n'})}),"\n",(0,t.jsx)(n.h1,{id:"ssh-key-based-authentication",children:"SSH Key-Based Authentication"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Install OpenSSH on server"}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Ubuntu\nsudo apt install openssh-server\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Create an SSH key pair (with a passphrase) for your normal user account and copy it to target server"}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'\n# -t ed25519        type of algorith\n# -C                comment to ssh key\nssh-keygen -t ed25519 -C "ansible tutorial key"\n\n# following command will copy the public key to the host under the folder \n# .ssh/authorized_keys\nssh-copy-id -i ~/.ssh/id_ed25519.pub 1p.address.of.host\n'})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Create a specific SSH key for Ansible Control Node (without passphrase as ansible can not enter passphrase everytime connecting target servers) and copy it to target server"}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'# with different name e.g. /home/username/.ssh/ansible\nssh-keygen -t ed25519 -C "ansible control node"\n'})}),"\n",(0,t.jsx)(n.h3,{id:"adding-ssh-key-to-ssh-agent",children:"Adding SSH Key to SSH Agent"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'# Check if ssh-agent is running\neval "$(ssh-agent -s)"        \n# Add ssh key to ssh-agent\nssh-add ~/.ssh/nameOfSSHKey\n# Verify Key is added to ssh-agent\nssh-add -l\n'})}),"\n",(0,t.jsx)(n.h2,{id:"references",children:"References"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://docs.ansible.com/ansible/latest/",children:"Ansible Documentation"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://docs.ansible.com/ansible/2.9/user_guide/playbooks_best_practices.html",children:"Ansible Best Practices"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://docs.ansible.com/ansible/latest/collections/ansible/builtin/",children:"Ansible Builtin Modules, Plugins etc."})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>i,x:()=>o});var a=s(6540);const t={},l=a.createContext(t);function i(e){const n=a.useContext(l);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:i(e.components),a.createElement(l.Provider,{value:n},e.children)}}}]);